var $jscomp={scope:{},findInternal:function(k,a,c){k instanceof String&&(k=String(k));for(var f=k.length,h=0;h<f;h++){var n=k[h];if(a.call(c,n,h,k))return{i:h,v:n}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(k,a,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");k!=Array.prototype&&k!=Object.prototype&&(k[a]=c.value)};
$jscomp.getGlobal=function(k){return"undefined"!=typeof window&&window===k?k:"undefined"!=typeof global&&null!=global?global:k};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(k,a,c,f){if(a){c=$jscomp.global;k=k.split(".");for(f=0;f<k.length-1;f++){var h=k[f];h in c||(c[h]={});c=c[h]}k=k[k.length-1];f=c[k];a=a(f);a!=f&&null!=a&&$jscomp.defineProperty(c,k,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("Array.prototype.find",function(k){return k?k:function(a,k){return $jscomp.findInternal(this,a,k).v}},"es6-impl","es3");$jscomp.polyfill("Object.getOwnPropertySymbols",function(k){return k?k:function(){return[]}},"es6-impl","es5");$jscomp.owns=function(k,a){return Object.prototype.hasOwnProperty.call(k,a)};
$jscomp.polyfill("Object.assign",function(k){return k?k:function(a,k){for(var c=1;c<arguments.length;c++){var h=arguments[c];if(h)for(var n in h)$jscomp.owns(h,n)&&(a[n]=h[n])}return a}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(k){return $jscomp.SYMBOL_PREFIX+(k||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var k=$jscomp.global.Symbol.iterator;k||(k=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[k]&&$jscomp.defineProperty(Array.prototype,k,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(k){var a=0;return $jscomp.iteratorPrototype(function(){return a<k.length?{done:!1,value:k[a++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(k){$jscomp.initSymbolIterator();k={next:k};k[$jscomp.global.Symbol.iterator]=function(){return this};return k};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(k,a){$jscomp.initSymbolIterator();k instanceof String&&(k+="");var c=0,f={next:function(){if(c<k.length){var h=c++;return{value:a(h,k[h]),done:!1}}f.next=function(){return{done:!0,value:void 0}};return f.next()}};f[Symbol.iterator]=function(){return f};return f};
$jscomp.polyfill("Array.prototype.keys",function(k){return k?k:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");$jscomp.polyfill("Object.setPrototypeOf",function(k){return k?k:"object"!=typeof"".__proto__?null:function(a,k){a.__proto__=k;if(a.__proto__!==k)throw new TypeError(a+" is not extensible");return a}},"es6","es5");
$jscomp.polyfill("Array.prototype.fill",function(k){return k?k:function(a,k,f){var c=this.length||0;0>k&&(k=Math.max(0,c+k));if(null==f||f>c)f=c;f=Number(f);0>f&&(f=Math.max(0,c+f));for(k=Number(k||0);k<f;k++)this[k]=a;return this}},"es6-impl","es3");$jscomp.polyfill("Math.sign",function(k){return k?k:function(a){a=Number(a);return 0===a||isNaN(a)?a:0<a?1:-1}},"es6-impl","es3");
$jscomp.checkStringArgs=function(k,a,c){if(null==k)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return k+""};
$jscomp.polyfill("String.prototype.startsWith",function(k){return k?k:function(a,k){var c=$jscomp.checkStringArgs(this,a,"startsWith");a+="";for(var h=c.length,n=a.length,m=Math.max(0,Math.min(k|0,c.length)),g=0;g<n&&m<h;)if(c[m++]!=a[g++])return!1;return g>=n}},"es6-impl","es3");$jscomp.makeIterator=function(k){$jscomp.initSymbolIterator();var a=k[Symbol.iterator];return a?a.call(k):$jscomp.arrayIterator(k)};
$jscomp.polyfill("WeakMap",function(k){function a(a){$jscomp.owns(a,f)||$jscomp.defineProperty(a,f,{value:{}})}function c(m){var g=Object[m];g&&(Object[m]=function(d){a(d);return g(d)})}if(function(){if(!k||!Object.seal)return!1;try{var a=Object.seal({}),g=Object.seal({}),d=new k([[a,2],[g,3]]);if(2!=d.get(a)||3!=d.get(g))return!1;d["delete"](a);d.set(g,4);return!d.has(a)&&4==d.get(g)}catch(e){return!1}}())return k;var f="$jscomp_hidden_"+Math.random().toString().substring(2);c("freeze");c("preventExtensions");
c("seal");var h=0,n=function(a){this.id_=(h+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var g;!(g=a.next()).done;)g=g.value,this.set(g[0],g[1])}};n.prototype.set=function(m,g){a(m);if(!$jscomp.owns(m,f))throw Error("WeakMap key fail: "+m);m[f][this.id_]=g;return this};n.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};n.prototype.has=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};n.prototype["delete"]=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return n},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_MAP=!1;
$jscomp.polyfill("Map",function(k){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!k||!k.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),d=new k($jscomp.makeIterator([[a,"s"]]));if("s"!=d.get(a)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var e=d.entries(),b=e.next();if(b.done||b.value[0]!=a||"s"!=b.value[1])return!1;b=e.next();return b.done||4!=b.value[0].x||"t"!=b.value[1]||!e.next().done?!1:!0}catch(p){return!1}}())return k;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var a=new WeakMap,c=function(a){this.data_={};this.head_=n();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var d;!(d=a.next()).done;)d=d.value,this.set(d[0],d[1])}};c.prototype.set=function(a,d){var e=f(this,a);e.list||(e.list=this.data_[e.id]=[]);e.entry?e.entry.value=d:(e.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:d},e.list.push(e.entry),this.head_.previous.next=e.entry,this.head_.previous=e.entry,this.size++);return this};c.prototype["delete"]=
function(a){a=f(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};c.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=n();this.size=0};c.prototype.has=function(a){return!!f(this,a).entry};c.prototype.get=function(a){return(a=f(this,a).entry)&&a.value};c.prototype.entries=function(){return h(this,function(a){return[a.key,
a.value]})};c.prototype.keys=function(){return h(this,function(a){return a.key})};c.prototype.values=function(){return h(this,function(a){return a.value})};c.prototype.forEach=function(a,d){for(var e=this.entries(),b;!(b=e.next()).done;)b=b.value,a.call(d,b[1],b[0],this)};c.prototype[Symbol.iterator]=c.prototype.entries;var f=function(g,d){var e;e=d&&typeof d;"object"==e||"function"==e?a.has(d)?e=a.get(d):(e=""+ ++m,a.set(d,e)):e="p_"+d;var b=g.data_[e];if(b&&$jscomp.owns(g.data_,e))for(var p=0;p<
b.length;p++){var k=b[p];if(d!==d&&k.key!==k.key||d===k.key)return{id:e,list:b,index:p,entry:k}}return{id:e,list:b,index:-1,entry:void 0}},h=function(a,d){var e=a.head_;return $jscomp.iteratorPrototype(function(){if(e){for(;e.head!=a.head_;)e=e.previous;for(;e.next!=e.head;)return e=e.next,{done:!1,value:d(e)};e=null}return{done:!0,value:void 0}})},n=function(){var a={};return a.previous=a.next=a.head=a},m=0;return c},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.polyfill("Set",function(k){if(!$jscomp.ASSUME_NO_NATIVE_SET&&function(){if(!k||!k.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),f=new k($jscomp.makeIterator([a]));if(!f.has(a)||1!=f.size||f.add(a)!=f||1!=f.size||f.add({x:4})!=f||2!=f.size)return!1;var h=f.entries(),n=h.next();if(n.done||n.value[0]!=a||n.value[1]!=a)return!1;n=h.next();return n.done||n.value[0]==a||4!=n.value[0].x||n.value[1]!=n.value[0]?!1:h.next().done}catch(m){return!1}}())return k;
$jscomp.initSymbol();$jscomp.initSymbolIterator();var a=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var k;!(k=a.next()).done;)this.add(k.value)}this.size=this.map_.size};a.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};a.prototype["delete"]=function(a){a=this.map_["delete"](a);this.size=this.map_.size;return a};a.prototype.clear=function(){this.map_.clear();this.size=0};a.prototype.has=function(a){return this.map_.has(a)};a.prototype.entries=
function(){return this.map_.entries()};a.prototype.values=function(){return this.map_.values()};a.prototype[Symbol.iterator]=a.prototype.values;a.prototype.forEach=function(a,k){var c=this;this.map_.forEach(function(n){return a.call(k,n,n,c)})};return a},"es6-impl","es3");
(function(k){var a=function(a,k){this.init("simplecolorpicker",a,k)};a.prototype={constructor:a,init:function(a,f,h){var c=this;c.type=a;c.$select=k(f);c.$select.hide();c.options=k.extend({},k.fn.simplecolorpicker.defaults,h);c.$colorList=null;!0===c.options.picker?(a=c.$select.find("> option:selected").text(),c.$icon=k('<span class="simplecolorpicker icon" title="'+a+'" style="background-color: '+c.$select.val()+';" role="button" tabindex="0"></span>').insertAfter(c.$select),c.$icon.on("click."+
c.type,k.proxy(c.showPicker,c)),c.$picker=k('<span class="simplecolorpicker picker '+c.options.theme+'"></span>').appendTo(document.body),c.$colorList=c.$picker,k(document).on("mousedown."+c.type,k.proxy(c.hidePicker,c)),c.$picker.on("mousedown."+c.type,k.proxy(c.mousedown,c))):(c.$inline=k('<span class="simplecolorpicker inline '+c.options.theme+'"></span>').insertAfter(c.$select),c.$colorList=c.$inline);c.$select.find("> option").each(function(){var a=k(this),g=a.val(),d=a.is(":selected"),e=a.is(":disabled"),
b="";!0===d&&(b=" data-selected");d="";!0===e&&(d=" data-disabled");var p="";!1===e&&(p=' title="'+a.text()+'"');var r="";!1===e&&(r=' role="button" tabindex="0"');g=k('<span class="color"'+p+' style="background-color: '+g+';" data-color="'+g+'"'+b+d+r+"></span>");c.$colorList.append(g);g.on("click."+c.type,k.proxy(c.colorSpanClicked,c));!0===a.next().is("optgroup")&&c.$colorList.append('<span class="vr"></span>')})},selectColor:function(a){var c=this.$colorList.find("> span.color").filter(function(){return k(this).data("color").toLowerCase()===
a.toLowerCase()});0<c.length?this.selectColorSpan(c):console.error("The given color '"+a+"' could not be found")},showPicker:function(){var a=this.$icon.offset();this.$picker.css({left:a.left-6,top:a.top+this.$icon.outerHeight()});this.$picker.show(this.options.pickerDelay)},hidePicker:function(){this.$picker.hide(this.options.pickerDelay)},selectColorSpan:function(a){var k=a.data("color"),c=a.prop("title");a.siblings().removeAttr("data-selected");a.attr("data-selected","");!0===this.options.picker&&
(this.$icon.css("background-color",k),this.$icon.prop("title",c),this.hidePicker());this.$select.val(k)},colorSpanClicked:function(a){!1===k(a.target).is("[data-disabled]")&&(this.selectColorSpan(k(a.target)),this.$select.trigger("change"))},mousedown:function(a){a.stopPropagation();a.preventDefault()},destroy:function(){!0===this.options.picker&&(this.$icon.off("."+this.type),this.$icon.remove(),k(document).off("."+this.type));this.$colorList.off("."+this.type);this.$colorList.remove();this.$select.removeData(this.type);
this.$select.show()}};k.fn.simplecolorpicker=function(c){var f=k.makeArray(arguments);f.shift();return this.each(function(){var h=k(this),n=h.data("simplecolorpicker"),m="object"===typeof c&&c;void 0===n&&h.data("simplecolorpicker",n=new a(this,m));"string"===typeof c&&n[c].apply(n,f)})};k.fn.simplecolorpicker.defaults={theme:"",picker:!1,pickerDelay:0}})(jQuery);/*
: http://creativecommons.org/publicdomain/zero/1.0/
 pixi.js - v4.3.4
 Compiled Thu, 19 Jan 2017 21:39:58 UTC

 pixi.js is licensed under the MIT License.
 http://www.opensource.org/licenses/mit-license
 https://mths.be/punycode v1.4.1 by @mathias */
(function(k){"object"===typeof exports&&"undefined"!==typeof module?module.exports=k():"function"===typeof define&&define.amd?define([],k):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).PIXI=k()})(function(){return function a(c,f,h){function n(d,e){if(!f[d]){if(!c[d]){var b="function"==typeof require&&require;if(!e&&b)return b(d,!0);if(m)return m(d,!0);b=Error("Cannot find module '"+d+"'");throw b.code="MODULE_NOT_FOUND",b;}b=f[d]={exports:{}};
c[d][0].call(b.exports,function(a){var b=c[d][1][a];return n(b?b:a)},b,b.exports,a,c,f,h)}return f[d].exports}for(var m="function"==typeof require&&require,g=0;g<h.length;g++)n(h[g]);return n}({1:[function(a,c,f){function h(a){var m=32;(a&=-a)&&m--;a&65535&&(m-=16);a&16711935&&(m-=8);a&252645135&&(m-=4);a&858993459&&(m-=2);a&1431655765&&--m;return m}"use restrict";f.INT_BITS=32;f.INT_MAX=2147483647;f.INT_MIN=-2147483648;f.sign=function(a){return(0<a)-(0>a)};f.abs=function(a){var m=a>>31;return(a^
m)-m};f.min=function(a,g){return g^(a^g)&-(a<g)};f.max=function(a,g){return a^(a^g)&-(a<g)};f.isPow2=function(a){return!(a&a-1)&&!!a};f.log2=function(a){var m,d;m=(65535<a)<<4;a>>>=m;d=(255<a)<<3;a>>>=d;m|=d;d=(15<a)<<2;a>>>=d;m|=d;d=(3<a)<<1;return m|d|a>>>d>>1};f.log10=function(a){return 1E9<=a?9:1E8<=a?8:1E7<=a?7:1E6<=a?6:1E5<=a?5:1E4<=a?4:1E3<=a?3:100<=a?2:10<=a?1:0};f.popCount=function(a){a-=a>>>1&1431655765;a=(a&858993459)+(a>>>2&858993459);return 16843009*(a+(a>>>4)&252645135)>>>24};f.countTrailingZeros=
h;f.nextPow2=function(a){a+=0===a;--a;a|=a>>>1;a|=a>>>2;a|=a>>>4;a|=a>>>8;return(a|a>>>16)+1};f.prevPow2=function(a){a|=a>>>1;a|=a>>>2;a|=a>>>4;a|=a>>>8;a|=a>>>16;return a-(a>>>1)};f.parity=function(a){a^=a>>>16;a^=a>>>8;return 27030>>>((a^a>>>4)&15)&1};var n=Array(256);(function(a){for(var g=0;256>g;++g){for(var d=g,e=g,b=7,d=d>>>1;d;d>>>=1)e<<=1,e|=d&1,--b;a[g]=e<<b&255}})(n);f.reverse=function(a){return n[a&255]<<24|n[a>>>8&255]<<16|n[a>>>16&255]<<8|n[a>>>24&255]};f.interleave2=function(a,g){a&=
65535;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;g&=65535;g=(g|g<<8)&16711935;g=(g|g<<4)&252645135;g=(g|g<<2)&858993459;return(a|a<<1)&1431655765|((g|g<<1)&1431655765)<<1};f.deinterleave2=function(a,g){a=a>>>g&1431655765;a=(a|a>>>1)&858993459;a=(a|a>>>2)&252645135;a=(a|a>>>4)&16711935;return((a|a>>>16)&65535)<<16>>16};f.interleave3=function(a,g,d){a&=1023;a=(a|a<<16)&4278190335;a=(a|a<<8)&251719695;a=(a|a<<4)&3272356035;g&=1023;g=(g|g<<16)&4278190335;g=(g|g<<8)&251719695;g=(g|g<<
4)&3272356035;d&=1023;d=(d|d<<16)&4278190335;d=(d|d<<8)&251719695;d=(d|d<<4)&3272356035;return(a|a<<2)&1227133513|((g|g<<2)&1227133513)<<1|((d|d<<2)&1227133513)<<2};f.deinterleave3=function(a,g){a=a>>>g&1227133513;a=(a|a>>>2)&3272356035;a=(a|a>>>4)&251719695;a=(a|a>>>8)&4278190335;return((a|a>>>16)&1023)<<22>>22};f.nextCombination=function(a){var g=a|a-1;return g+1|(~g&-~g)-1>>>h(a)+1}},{}],2:[function(a,c,f){function h(a,b,q){q=q||2;var r=b&&b.length,c=r?b[0]*q:a.length,f=n(a,0,c,q,!0),y=[];if(!f)return y;
var h,x,v,t;if(r){var w=q,r=[],z,B,C;t=0;for(z=b.length;t<z;t++)B=b[t]*w,C=t<z-1?b[t+1]*w:a.length,B=n(a,B,C,w,!1),B===B.next&&(B.steiner=!0),r.push(p(B));r.sort(d);for(t=0;t<r.length;t++){b=r[t];w=f;if(w=e(b,w))b=u(w,b),m(b,b.next);f=m(f,f.next)}}if(a.length>80*q){h=v=a[0];x=r=a[1];for(w=q;w<c;w+=q)t=a[w],b=a[w+1],t<h&&(h=t),b<x&&(x=b),t>v&&(v=t),b>r&&(r=b);v=Math.max(v-h,r-x)}g(f,y,q,h,x,v);return y}function n(a,b,d,e,g){var p;if(g===0<A(a,b,d,e))for(g=b;g<d;g+=e)p=t(g,a[g],a[g+1],p);else for(g=
d-e;g>=b;g-=e)p=t(g,a[g],a[g+1],p);p&&y(p,p.next)&&(z(p),p=p.next);return p}function m(a,b){if(!a)return a;b||(b=a);var d=a,e;do if(e=!1,d.steiner||!y(d,d.next)&&0!==q(d.prev,d,d.next))d=d.next;else{z(d);d=b=d.prev;if(d===d.next)return null;e=!0}while(e||d!==b);return b}function g(a,d,e,p,c,f,n){if(a){if(!n&&f){var h=a,t=h;do null===t.z&&(t.z=b(t.x,t.y,p,c,f)),t.prevZ=t.prev,t=t.nextZ=t.next;while(t!==h);t.prevZ.nextZ=null;t.prevZ=null;var h=t,w,B,C,F,D,A,E=1;do{t=h;C=h=null;for(F=0;t;){F++;B=t;for(w=
D=0;w<E&&(D++,B=B.nextZ,B);w++);for(A=E;0<D||0<A&&B;)0===D?(w=B,B=B.nextZ,A--):0!==A&&B?t.z<=B.z?(w=t,t=t.nextZ,D--):(w=B,B=B.nextZ,A--):(w=t,t=t.nextZ,D--),C?C.nextZ=w:h=w,w.prevZ=C,C=w;t=B}C.nextZ=null;E*=2}while(1<F)}for(h=a;a.prev!==a.next;){t=a.prev;B=a.next;if(f)a:{C=a;A=p;var G=c,I=f;F=C.prev;D=C;E=C.next;if(0<=q(F,D,E))C=!1;else{var L=F.x>D.x?F.x>E.x?F.x:E.x:D.x>E.x?D.x:E.x,U=F.y>D.y?F.y>E.y?F.y:E.y:D.y>E.y?D.y:E.y;w=b(F.x<D.x?F.x<E.x?F.x:E.x:D.x<E.x?D.x:E.x,F.y<D.y?F.y<E.y?F.y:E.y:D.y<E.y?
D.y:E.y,A,G,I);A=b(L,U,A,G,I);for(G=C.nextZ;G&&G.z<=A;){if(G!==C.prev&&G!==C.next&&r(F.x,F.y,D.x,D.y,E.x,E.y,G.x,G.y)&&0<=q(G.prev,G,G.next)){C=!1;break a}G=G.nextZ}for(G=C.prevZ;G&&G.z>=w;){if(G!==C.prev&&G!==C.next&&r(F.x,F.y,D.x,D.y,E.x,E.y,G.x,G.y)&&0<=q(G.prev,G,G.next)){C=!1;break a}G=G.prevZ}C=!0}}else a:if(C=a,F=C.prev,D=C,E=C.next,0<=q(F,D,E))C=!1;else{for(w=C.next.next;w!==C.prev;){if(r(F.x,F.y,D.x,D.y,E.x,E.y,w.x,w.y)&&0<=q(w.prev,w,w.next)){C=!1;break a}w=w.next}C=!0}if(C)d.push(t.i/e),
d.push(a.i/e),d.push(B.i/e),z(a),h=a=B.next;else if(a=B,a===h){if(!n)g(m(a),d,e,p,c,f,1);else if(1===n){n=d;h=e;t=a;do B=t.prev,C=t.next.next,!y(B,C)&&x(B,t,t.next,C)&&v(B,C)&&v(C,B)&&(n.push(B.i/h),n.push(t.i/h),n.push(C.i/h),z(t),z(t.next),t=a=C),t=t.next;while(t!==a);a=t;g(a,d,e,p,c,f,2)}else if(2===n)a:{n=a;do{for(h=n.next.next;h!==n.prev;){if(t=n.i!==h.i){t=n;B=h;if(C=t.next.i!==B.i&&t.prev.i!==B.i){b:{C=t;do{if(C.i!==t.i&&C.next.i!==t.i&&C.i!==B.i&&C.next.i!==B.i&&x(C,C.next,t,B)){C=!0;break b}C=
C.next}while(C!==t);C=!1}C=!C}if(C=C&&v(t,B)&&v(B,t)){C=t;F=!1;D=(t.x+B.x)/2;B=(t.y+B.y)/2;do C.y>B!==C.next.y>B&&D<(C.next.x-C.x)*(B-C.y)/(C.next.y-C.y)+C.x&&(F=!F),C=C.next;while(C!==t);C=F}t=C}if(t){a=u(n,h);n=m(n,n.next);a=m(a,a.next);g(n,d,e,p,c,f);g(a,d,e,p,c,f);break a}h=h.next}n=n.next}while(n!==a)}break}}}}function d(a,b){return a.x-b.x}function e(a,b){var d=b,e=a.x,g=a.y,p=-Infinity,m;do{if(g<=d.y&&g>=d.next.y){var q=d.x+(g-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(q<=e&&q>p){p=q;if(q===e){if(g===
d.y)return d;if(g===d.next.y)return d.next}m=d.x<d.next.x?d:d.next}}d=d.next}while(d!==b);if(!m)return null;if(e===p)return m.prev;for(var q=m,c=m.x,n=m.y,f=Infinity,h,d=m.next;d!==q;)e>=d.x&&d.x>=c&&r(g<n?e:p,g,c,n,g<n?p:e,g,d.x,d.y)&&(h=Math.abs(g-d.y)/(e-d.x),(h<f||h===f&&d.x>m.x)&&v(d,a)&&(m=d,f=h)),d=d.next;return m}function b(a,b,d,e,g){a=32767*(a-d)/g;b=32767*(b-e)/g;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;
return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function p(a){var b=a,d=a;do b.x<d.x&&(d=b),b=b.next;while(b!==a);return d}function r(a,b,d,e,g,p,m,q){return 0<=(g-m)*(b-q)-(a-m)*(p-q)&&0<=(a-m)*(e-q)-(d-m)*(b-q)&&0<=(d-m)*(p-q)-(g-m)*(e-q)}function q(a,b,d){return(b.y-a.y)*(d.x-b.x)-(b.x-a.x)*(d.y-b.y)}function y(a,b){return a.x===b.x&&a.y===b.y}function x(a,b,d,e){return y(a,b)&&y(d,e)||y(a,e)&&y(d,b)?!0:0<q(a,b,d)!==0<q(a,b,e)&&0<q(d,e,a)!==0<q(d,e,b)}function v(a,b){return 0>q(a.prev,a,a.next)?
0<=q(a,b,a.next)&&0<=q(a,a.prev,b):0>q(a,b,a.prev)||0>q(a,a.next,b)}function u(a,b){var d=new w(a.i,a.x,a.y),e=new w(b.i,b.x,b.y),g=a.next,p=b.prev;a.next=b;b.prev=a;d.next=g;g.prev=d;e.next=d;d.prev=e;p.next=e;e.prev=p;return e}function t(a,b,d,e){a=new w(a,b,d);e?(a.next=e.next,a.prev=e,e.next.prev=a,e.next=a):(a.prev=a,a.next=a);return a}function z(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function w(a,b,d){this.i=a;this.x=b;this.y=
d;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function A(a,b,d,e){for(var g=0,p=d-e;b<d;b+=e)g+=(a[p]-a[b])*(a[b+1]+a[p+1]),p=b;return g}c.exports=h;h.deviation=function(a,b,d,e){var g=b&&b.length,p=Math.abs(A(a,0,g?b[0]*d:a.length,d));if(g)for(var g=0,m=b.length;g<m;g++)p-=Math.abs(A(a,b[g]*d,g<m-1?b[g+1]*d:a.length,d));for(g=b=0;g<e.length;g+=3){var m=e[g]*d,q=e[g+1]*d,r=e[g+2]*d;b+=Math.abs((a[m]-a[r])*(a[q+1]-a[m+1])-(a[m]-a[q])*(a[r+1]-a[m+1]))}return 0===p&&0===b?0:
Math.abs((b-p)/p)};h.flatten=function(a){for(var b=a[0][0].length,d={vertices:[],holes:[],dimensions:b},e=0,g=0;g<a.length;g++){for(var p=0;p<a[g].length;p++)for(var m=0;m<b;m++)d.vertices.push(a[g][p][m]);0<g&&(e+=a[g-1].length,d.holes.push(e))}return d}},{}],3:[function(a,c,f){function h(){}function n(a,b,d){this.fn=a;this.context=b;this.once=d||!1}function m(){this._events=new h;this._eventsCount=0}var g=Object.prototype.hasOwnProperty,d="~";Object.create&&(h.prototype=Object.create(null),(new h).__proto__||
(d=!1));m.prototype.eventNames=function(){var a=[],b,p;if(0===this._eventsCount)return a;for(p in b=this._events)g.call(b,p)&&a.push(d?p.slice(1):p);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(b)):a};m.prototype.listeners=function(a,b){var e=this._events[d?d+a:a];if(b)return!!e;if(!e)return[];if(e.fn)return[e.fn];for(var g=0,m=e.length,c=Array(m);g<m;g++)c[g]=e[g].fn;return c};m.prototype.emit=function(a,b,g,m,q,c){var e=d?d+a:a;if(!this._events[e])return!1;var e=this._events[e],
p=arguments.length,r,n;if(e.fn){e.once&&this.removeListener(a,e.fn,void 0,!0);switch(p){case 1:return e.fn.call(e.context),!0;case 2:return e.fn.call(e.context,b),!0;case 3:return e.fn.call(e.context,b,g),!0;case 4:return e.fn.call(e.context,b,g,m),!0;case 5:return e.fn.call(e.context,b,g,m,q),!0;case 6:return e.fn.call(e.context,b,g,m,q,c),!0}n=1;for(r=Array(p-1);n<p;n++)r[n-1]=arguments[n];e.fn.apply(e.context,r)}else{var f=e.length,h;for(n=0;n<f;n++)switch(e[n].once&&this.removeListener(a,e[n].fn,
void 0,!0),p){case 1:e[n].fn.call(e[n].context);break;case 2:e[n].fn.call(e[n].context,b);break;case 3:e[n].fn.call(e[n].context,b,g);break;case 4:e[n].fn.call(e[n].context,b,g,m);break;default:if(!r)for(h=1,r=Array(p-1);h<p;h++)r[h-1]=arguments[h];e[n].fn.apply(e[n].context,r)}}return!0};m.prototype.on=function(a,b,g){b=new n(b,g||this);a=d?d+a:a;this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],b]:this._events[a].push(b):(this._events[a]=b,this._eventsCount++);return this};m.prototype.once=
function(a,b,g){b=new n(b,g||this,!0);a=d?d+a:a;this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],b]:this._events[a].push(b):(this._events[a]=b,this._eventsCount++);return this};m.prototype.removeListener=function(a,b,g,m){a=d?d+a:a;if(!this._events[a])return this;if(!b)return 0===--this._eventsCount?this._events=new h:delete this._events[a],this;var e=this._events[a];if(e.fn)e.fn!==b||m&&!e.once||g&&e.context!==g||(0===--this._eventsCount?this._events=new h:delete this._events[a]);
else{for(var p=0,r=[],c=e.length;p<c;p++)(e[p].fn!==b||m&&!e[p].once||g&&e[p].context!==g)&&r.push(e[p]);r.length?this._events[a]=1===r.length?r[0]:r:0===--this._eventsCount?this._events=new h:delete this._events[a]}return this};m.prototype.removeAllListeners=function(a){a?(a=d?d+a:a,this._events[a]&&(0===--this._eventsCount?this._events=new h:delete this._events[a])):(this._events=new h,this._eventsCount=0);return this};m.prototype.off=m.prototype.removeListener;m.prototype.addListener=m.prototype.on;
m.prototype.setMaxListeners=function(){return this};m.prefixed=d;m.EventEmitter=m;"undefined"!==typeof c&&(c.exports=m)},{}],4:[function(a,c,f){(function(a){var n=/iPhone/i,m=/iPod/i,g=/iPad/i,d=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,e=/Android/i,b=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,p=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,r=/IEMobile/i,q=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,f=/BlackBerry/i,h=/BB10/i,v=/Opera Mini/i,u=
/(CriOS|Chrome)(?=.*\bMobile\b)/i,t=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,z=/(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)/i,w=function(a){a=a||navigator.userAgent;var c=a.split("[FBAN");"undefined"!==typeof c[1]&&(a=c[0]);c=a.split("Twitter");"undefined"!==typeof c[1]&&(a=c[0]);this.apple={phone:n.test(a),ipod:m.test(a),tablet:!n.test(a)&&g.test(a),device:n.test(a)||m.test(a)||g.test(a)};this.amazon={phone:b.test(a),tablet:!b.test(a)&&p.test(a),device:b.test(a)||p.test(a)};this.android={phone:b.test(a)||
d.test(a),tablet:!b.test(a)&&!d.test(a)&&(p.test(a)||e.test(a)),device:b.test(a)||p.test(a)||d.test(a)||e.test(a)};this.windows={phone:r.test(a),tablet:q.test(a),device:r.test(a)||q.test(a)};this.other={blackberry:f.test(a),blackberry10:h.test(a),opera:v.test(a),firefox:t.test(a),chrome:u.test(a),device:f.test(a)||h.test(a)||v.test(a)||t.test(a)||u.test(a)};this.seven_inch=z.test(a);this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch;this.phone=
this.apple.phone||this.android.phone||this.windows.phone;this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet;if("undefined"===typeof window)return this},A=function(){var a=new w;a.Class=w;return a};"undefined"!==typeof c&&c.exports&&"undefined"===typeof window?c.exports=w:"undefined"!==typeof c&&c.exports&&"undefined"!==typeof window?c.exports=A():a.isMobile=A()})(this)},{}],5:[function(a,c,f){var h=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable;
c.exports=function(){try{if(!Object.assign)return!1;var a=new String("abc");a[5]="de";if("5"===Object.getOwnPropertyNames(a)[0])return!1;for(var d={},a=0;10>a;a++)d["_"+String.fromCharCode(a)]=a;if("0123456789"!==Object.getOwnPropertyNames(d).map(function(a){return d[a]}).join(""))return!1;var e={};"abcdefghijklmnopqrst".split("").forEach(function(a){e[a]=a});return"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},e)).join("")?!1:!0}catch(b){return!1}}()?Object.assign:function(a,d){var e,b;if(null===
a||void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");b=Object(a);for(var g,r=1;r<arguments.length;r++){e=Object(arguments[r]);for(var q in e)n.call(e,q)&&(b[q]=e[q]);if(h){g=h(e);for(var c=0;c<g.length;c++)m.call(e,g[c])&&(b[g[c]]=e[g[c]])}}return b}},{}],6:[function(a,c,f){var h=new ArrayBuffer(0),n=function(a,g,d,e){this.gl=a;this.buffer=a.createBuffer();this.type=g||a.ARRAY_BUFFER;this.drawType=e||a.STATIC_DRAW;this.data=h;d&&this.upload(d)};n.prototype.upload=
function(a,g,d){d||this.bind();d=this.gl;a=a||this.data;this.data.byteLength>=a.byteLength?d.bufferSubData(this.type,g||0,a):d.bufferData(this.type,a,this.drawType);this.data=a};n.prototype.bind=function(){this.gl.bindBuffer(this.type,this.buffer)};n.createVertexBuffer=function(a,g,d){return new n(a,a.ARRAY_BUFFER,g,d)};n.createIndexBuffer=function(a,g,d){return new n(a,a.ELEMENT_ARRAY_BUFFER,g,d)};n.create=function(a,g,d,e){return new n(a,g,d,e)};n.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};
c.exports=n},{}],7:[function(a,c,f){var h=a("./GLTexture"),n=function(a,g,d){this.gl=a;this.framebuffer=a.createFramebuffer();this.texture=this.stencil=null;this.width=g||100;this.height=d||100};n.prototype.enableTexture=function(a){var g=this.gl;this.texture=a||new h(g);this.texture.bind();this.bind();g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,this.texture.texture,0)};n.prototype.enableStencil=function(){if(!this.stencil){var a=this.gl;this.stencil=a.createRenderbuffer();
a.bindRenderbuffer(a.RENDERBUFFER,this.stencil);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,this.stencil);a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,this.width,this.height)}};n.prototype.clear=function(a,g,d,e){this.bind();var b=this.gl;b.clearColor(a,g,d,e);b.clear(b.COLOR_BUFFER_BIT)};n.prototype.bind=function(){var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer)};n.prototype.unbind=function(){var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,
null)};n.prototype.resize=function(a,g){var d=this.gl;this.width=a;this.height=g;this.texture&&this.texture.uploadData(null,a,g);this.stencil&&(d.bindRenderbuffer(d.RENDERBUFFER,this.stencil),d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_STENCIL,a,g))};n.prototype.destroy=function(){var a=this.gl;this.texture&&this.texture.destroy();a.deleteFramebuffer(this.framebuffer);this.texture=this.stencil=this.gl=null};n.createRGBA=function(a,g,d,e){e=h.fromData(a,null,g,d);e.enableNearestScaling();e.enableWrapClamp();
a=new n(a,g,d);a.enableTexture(e);a.unbind();return a};n.createFloat32=function(a,g,d,e){e=new h.fromData(a,e,g,d);e.enableNearestScaling();e.enableWrapClamp();a=new n(a,g,d);a.enableTexture(e);a.unbind();return a};c.exports=n},{"./GLTexture":9}],8:[function(a,c,f){var h=a("./shader/compileProgram"),n=a("./shader/extractAttributes"),m=a("./shader/extractUniforms"),g=a("./shader/generateUniformAccessObject");a=function(a,e,b){this.gl=a;this.program=h(a,e,b);this.attributes=n(a,this.program);e=m(a,
this.program);this.uniforms=g(a,e)};a.prototype.bind=function(){this.gl.useProgram(this.program)};a.prototype.destroy=function(){};c.exports=a},{"./shader/compileProgram":14,"./shader/extractAttributes":16,"./shader/extractUniforms":17,"./shader/generateUniformAccessObject":18}],9:[function(a,c,f){var h=function(a,g,d,e,b){this.gl=a;this.texture=a.createTexture();this.premultiplyAlpha=this.mipmap=!1;this.width=g||-1;this.height=d||-1;this.format=e||a.RGBA;this.type=b||a.UNSIGNED_BYTE};h.prototype.upload=
function(a){this.bind();var g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);var d=a.videoWidth||a.width,e=a.videoHeight||a.height;e!==this.height||d!==this.width?g.texImage2D(g.TEXTURE_2D,0,this.format,this.format,this.type,a):g.texSubImage2D(g.TEXTURE_2D,0,0,0,this.format,this.type,a);this.width=d;this.height=e};var n=!1;h.prototype.uploadData=function(a,g,d){this.bind();var e=this.gl;if(a instanceof Float32Array){if(!n)if(e.getExtension("OES_texture_float"))n=!0;
else throw Error("floating point textures not available");this.type=e.FLOAT}else this.type=e.UNSIGNED_BYTE;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);g!==this.width||d!==this.height?e.texImage2D(e.TEXTURE_2D,0,this.format,g,d,0,this.format,this.type,a||null):e.texSubImage2D(e.TEXTURE_2D,0,0,0,g,d,this.format,this.type,a||null);this.width=g;this.height=d};h.prototype.bind=function(a){var g=this.gl;void 0!==a&&g.activeTexture(g.TEXTURE0+a);g.bindTexture(g.TEXTURE_2D,this.texture)};
h.prototype.unbind=function(){var a=this.gl;a.bindTexture(a.TEXTURE_2D,null)};h.prototype.minFilter=function(a){var g=this.gl;this.bind();this.mipmap?g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,a?g.LINEAR_MIPMAP_LINEAR:g.NEAREST_MIPMAP_NEAREST):g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,a?g.LINEAR:g.NEAREST)};h.prototype.magFilter=function(a){var g=this.gl;this.bind();g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,a?g.LINEAR:g.NEAREST)};h.prototype.enableMipmap=function(){var a=this.gl;
this.bind();this.mipmap=!0;a.generateMipmap(a.TEXTURE_2D)};h.prototype.enableLinearScaling=function(){this.minFilter(!0);this.magFilter(!0)};h.prototype.enableNearestScaling=function(){this.minFilter(!1);this.magFilter(!1)};h.prototype.enableWrapClamp=function(){var a=this.gl;this.bind();a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE)};h.prototype.enableWrapRepeat=function(){var a=this.gl;this.bind();a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_WRAP_S,a.REPEAT);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT)};h.prototype.enableWrapMirrorRepeat=function(){var a=this.gl;this.bind();a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.MIRRORED_REPEAT);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.MIRRORED_REPEAT)};h.prototype.destroy=function(){this.gl.deleteTexture(this.texture)};h.fromSource=function(a,g,d){a=new h(a);a.premultiplyAlpha=d||!1;a.upload(g);return a};h.fromData=function(a,g,d,e){a=new h(a);a.uploadData(g,d,e);
return a};c.exports=h},{}],10:[function(a,c,f){function h(a,g){this.nativeVaoExtension=null;h.FORCE_NATIVE||(this.nativeVaoExtension=a.getExtension("OES_vertex_array_object")||a.getExtension("MOZ_OES_vertex_array_object")||a.getExtension("WEBKIT_OES_vertex_array_object"));this.nativeState=g;if(this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var d=a.getParameter(a.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:Array(d),attribState:Array(d)}}this.gl=a;this.attributes=
[];this.indexBuffer=null;this.dirty=!1}var n=a("./setVertexAttribArrays");h.prototype.constructor=h;c.exports=h;h.FORCE_NATIVE=!1;h.prototype.bind=function(){this.nativeVao?(this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.dirty&&(this.dirty=!1,this.activate())):this.activate();return this};h.prototype.unbind=function(){this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(null);return this};h.prototype.activate=function(){for(var a=this.gl,g=null,d=0;d<this.attributes.length;d++){var e=
this.attributes[d];g!==e.buffer&&(e.buffer.bind(),g=e.buffer);a.vertexAttribPointer(e.attribute.location,e.attribute.size,e.type||a.FLOAT,e.normalized||!1,e.stride||0,e.start||0)}n(a,this.attributes,this.nativeState);this.indexBuffer.bind();return this};h.prototype.addAttribute=function(a,g,d,e,b,p){this.attributes.push({buffer:a,attribute:g,location:g.location,type:d||this.gl.FLOAT,normalized:e||!1,stride:b||0,start:p||0});this.dirty=!0;return this};h.prototype.addIndex=function(a){this.indexBuffer=
a;this.dirty=!0;return this};h.prototype.clear=function(){this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao);this.attributes.length=0;this.indexBuffer=null;return this};h.prototype.draw=function(a,g,d){var e=this.gl;e.drawElements(a,g,e.UNSIGNED_SHORT,d||0);return this};h.prototype.destroy=function(){this.nativeState=this.attributes=this.indexBuffer=this.gl=null;this.nativeVao&&this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao);this.nativeVao=this.nativeVaoExtension=
null}},{"./setVertexAttribArrays":13}],11:[function(a,c,f){c.exports=function(a,c){var m=a.getContext("webgl",c)||a.getContext("experimental-webgl",c);if(!m)throw Error("This browser does not support webGL. Try using the canvas renderer");return m}},{}],12:[function(a,c,f){a={createContext:a("./createContext"),setVertexAttribArrays:a("./setVertexAttribArrays"),GLBuffer:a("./GLBuffer"),GLFramebuffer:a("./GLFramebuffer"),GLShader:a("./GLShader"),GLTexture:a("./GLTexture"),VertexArrayObject:a("./VertexArrayObject"),
shader:a("./shader")};"undefined"!==typeof c&&c.exports&&(c.exports=a);"undefined"!==typeof window&&(window.PIXI=window.PIXI||{},window.PIXI.glCore=a)},{"./GLBuffer":6,"./GLFramebuffer":7,"./GLShader":8,"./GLTexture":9,"./VertexArrayObject":10,"./createContext":11,"./setVertexAttribArrays":13,"./shader":19}],13:[function(a,c,f){c.exports=function(a,c,m){var g;if(m){var d=m.tempAttribState,e=m.attribState;for(g=0;g<d.length;g++)d[g]=!1;for(g=0;g<c.length;g++)d[c[g].attribute.location]=!0;for(g=0;g<
e.length;g++)e[g]!==d[g]&&(e[g]=d[g],m.attribState[g]?a.enableVertexAttribArray(g):a.disableVertexAttribArray(g))}else for(g=0;g<c.length;g++)a.enableVertexAttribArray(c[g].attribute.location)}},{}],14:[function(a,c,f){var h=function(a,m,g){m=a.createShader(m);a.shaderSource(m,g);a.compileShader(m);return a.getShaderParameter(m,a.COMPILE_STATUS)?m:(console.log(a.getShaderInfoLog(m)),null)};c.exports=function(a,m,g){m=h(a,a.VERTEX_SHADER,m);g=h(a,a.FRAGMENT_SHADER,g);var d=a.createProgram();a.attachShader(d,
m);a.attachShader(d,g);a.linkProgram(d);a.getProgramParameter(d,a.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",a.getProgramParameter(d,a.VALIDATE_STATUS)),console.error("gl.getError()",a.getError()),""!==a.getProgramInfoLog(d)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",a.getProgramInfoLog(d)),a.deleteProgram(d),d=null);a.deleteShader(m);a.deleteShader(g);return d}},{}],15:[function(a,c,f){var h=function(a){a=Array(a);for(var m=
0;m<a.length;m++)a[m]=!1;return a};c.exports=function(a,m){switch(a){case "float":return 0;case "vec2":return new Float32Array(2*m);case "vec3":return new Float32Array(3*m);case "vec4":return new Float32Array(4*m);case "int":case "sampler2D":return 0;case "ivec2":return new Int32Array(2*m);case "ivec3":return new Int32Array(3*m);case "ivec4":return new Int32Array(4*m);case "bool":return!1;case "bvec2":return h(2*m);case "bvec3":return h(3*m);case "bvec4":return h(4*m);case "mat2":return new Float32Array([1,
0,0,1]);case "mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case "mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}}},{}],16:[function(a,c,f){var h=a("./mapType"),n=a("./mapSize"),m=function(a,d,e,b){gl.vertexAttribPointer(this.location,this.size,a||gl.FLOAT,d||!1,e||0,b||0)};c.exports=function(a,d){for(var e={},b=a.getProgramParameter(d,a.ACTIVE_ATTRIBUTES),g=0;g<b;g++){var r=a.getActiveAttrib(d,g),q=h(a,r.type);e[r.name]={type:q,size:n(q),location:a.getAttribLocation(d,r.name),
pointer:m}}return e}},{"./mapSize":20,"./mapType":21}],17:[function(a,c,f){var h=a("./mapType"),n=a("./defaultValue");c.exports=function(a,g){for(var d={},e=a.getProgramParameter(g,a.ACTIVE_UNIFORMS),b=0;b<e;b++){var p=a.getActiveUniform(g,b),m=p.name.replace(/\[.*?\]/,""),q=h(a,p.type);d[m]={type:q,size:p.size,location:a.getUniformLocation(g,m),value:n(q,p.size)}}return d}},{"./defaultValue":15,"./mapType":21}],18:[function(a,c,f){var h=function(a){a=m.replace("%%",a);return new Function(a)},n=function(a,
p){var b=g.replace(/%%/g,a),m;(m=1===p.size?d[p.type]:e[p.type])&&(b+="\nthis.gl."+m+";");return new Function("value",b)},m="return this.data.%%.value;",g="this.data.%%.value = value;\nvar location = this.data.%%.location;",d={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",
ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},
e={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"};c.exports=function(a,d){var b=
{data:{}};b.gl=a;for(var e=Object.keys(d),g=0;g<e.length;g++){for(var p=e[g],m=p.split("."),c=m[m.length-1],f=b,z=0;z<m.length-1;z++)var w=f[m[z]]||{data:{}},f=f[m[z]]=w;m=f;p=d[p];m.data[c]=p;m.gl=a;Object.defineProperty(m,c,{get:h(c),set:n(c,p)})}return b}},{}],19:[function(a,c,f){c.exports={compileProgram:a("./compileProgram"),defaultValue:a("./defaultValue"),extractAttributes:a("./extractAttributes"),extractUniforms:a("./extractUniforms"),generateUniformAccessObject:a("./generateUniformAccessObject"),
mapSize:a("./mapSize"),mapType:a("./mapType")}},{"./compileProgram":14,"./defaultValue":15,"./extractAttributes":16,"./extractUniforms":17,"./generateUniformAccessObject":18,"./mapSize":20,"./mapType":21}],20:[function(a,c,f){var h={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};c.exports=function(a){return h[a]}},{}],21:[function(a,c,f){var h=null,n={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",
INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"};c.exports=function(a,g){if(!h){var d=Object.keys(n);h={};for(var e=0;e<d.length;++e){var b=d[e];h[a[b]]=n[b]}}return h[g]}},{}],22:[function(a,c,f){(function(a){function c(a,b){for(var d=0,e=a.length-1;0<=e;e--){var g=a[e];"."===g?a.splice(e,1):".."===g?(a.splice(e,1),d++):d&&(a.splice(e,1),d--)}if(b)for(;d--;d)a.unshift("..");
return a}function m(a,b){if(a.filter)return a.filter(b);for(var d=[],e=0;e<a.length;e++)b(a[e],e,a)&&d.push(a[e]);return d}var g=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;f.resolve=function(){for(var d="",b=!1,g=arguments.length-1;-1<=g&&!b;g--){var r=0<=g?arguments[g]:a.cwd();if("string"!==typeof r)throw new TypeError("Arguments to path.resolve must be strings");r&&(d=r+"/"+d,b="/"===r.charAt(0))}d=c(m(d.split("/"),function(a){return!!a}),!b).join("/");return(b?"/":"")+d||"."};
f.normalize=function(a){var b=f.isAbsolute(a),e="/"===d(a,-1);(a=c(m(a.split("/"),function(a){return!!a}),!b).join("/"))||b||(a=".");a&&e&&(a+="/");return(b?"/":"")+a};f.isAbsolute=function(a){return"/"===a.charAt(0)};f.join=function(){var a=Array.prototype.slice.call(arguments,0);return f.normalize(m(a,function(a,d){if("string"!==typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))};f.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);
for(var d=a.length-1;0<=d&&""===a[d];d--);return b>d?[]:a.slice(b,d-b+1)}a=f.resolve(a).substr(1);b=f.resolve(b).substr(1);for(var e=d(a.split("/")),g=d(b.split("/")),m=Math.min(e.length,g.length),c=m,n=0;n<m;n++)if(e[n]!==g[n]){c=n;break}m=[];for(n=c;n<e.length;n++)m.push("..");m=m.concat(g.slice(c));return m.join("/")};f.sep="/";f.delimiter=":";f.dirname=function(a){var b=g.exec(a).slice(1);a=b[0];b=b[1];if(!a&&!b)return".";b&&(b=b.substr(0,b.length-1));return a+b};f.basename=function(a,b){var d=
g.exec(a).slice(1)[2];b&&d.substr(-1*b.length)===b&&(d=d.substr(0,d.length-b.length));return d};f.extname=function(a){return g.exec(a).slice(1)[3]};var d="b"==="ab".substr(-1)?function(a,b,d){return a.substr(b,d)}:function(a,b,d){0>b&&(b=a.length+b);return a.substr(b,d)}}).call(this,a("_process"))},{_process:23}],23:[function(a,c,f){function h(){throw Error("setTimeout has not been defined");}function n(){throw Error("clearTimeout has not been defined");}function m(a){if(r===setTimeout)return setTimeout(a,
0);if((r===h||!r)&&setTimeout)return r=setTimeout,setTimeout(a,0);try{return r(a,0)}catch(z){try{return r.call(null,a,0)}catch(w){return r.call(this,a,0)}}}function g(a){if(q===clearTimeout)return clearTimeout(a);if((q===n||!q)&&clearTimeout)return q=clearTimeout,clearTimeout(a);try{return q(a)}catch(z){try{return q.call(null,a)}catch(w){return q.call(this,a)}}}function d(){x&&v&&(x=!1,v.length?y=v.concat(y):u=-1,y.length&&e())}function e(){if(!x){var a=m(d);x=!0;for(var b=y.length;b;){v=y;for(y=
[];++u<b;)v&&v[u].run();u=-1;b=y.length}v=null;x=!1;g(a)}}function b(a,b){this.fun=a;this.array=b}function p(){}a=c.exports={};var r,q;try{r="function"===typeof setTimeout?setTimeout:h}catch(t){r=h}try{q="function"===typeof clearTimeout?clearTimeout:n}catch(t){q=n}var y=[],x=!1,v,u=-1;a.nextTick=function(a){var d=Array(arguments.length-1);if(1<arguments.length)for(var g=1;g<arguments.length;g++)d[g-1]=arguments[g];y.push(new b(a,d));1!==y.length||x||m(e)};b.prototype.run=function(){this.fun.apply(null,
this.array)};a.title="browser";a.browser=!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=p;a.addListener=p;a.once=p;a.off=p;a.removeListener=p;a.removeAllListeners=p;a.emit=p;a.binding=function(a){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(a){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},{}],24:[function(a,c,f){(function(a){(function(n){function m(a){throw new RangeError(A[a]);}function g(a,b){for(var d=a.length,
e=[];d--;)e[d]=b(a[d]);return e}function d(a,b){var d=a.split("@"),e="";1<d.length&&(e=d[0]+"@",a=d[1]);a=a.replace(w,".");d=a.split(".");d=g(d,b).join(".");return e+d}function e(a){for(var b=[],d=0,e=a.length,g,p;d<e;)g=a.charCodeAt(d++),55296<=g&&56319>=g&&d<e?(p=a.charCodeAt(d++),56320==(p&64512)?b.push(((g&1023)<<10)+(p&1023)+65536):(b.push(g),d--)):b.push(g);return b}function b(a){return g(a,function(a){var b="";65535<a&&(a-=65536,b+=F(a>>>10&1023|55296),a=56320|a&1023);return b+=F(a)}).join("")}
function p(a,b){return a+22+75*(26>a)-((0!=b)<<5)}function r(a,b,d){var e=0;a=d?B(a/700):a>>1;for(a+=B(a/b);455<a;e+=36)a=B(a/35);return B(e+36*a/(a+38))}function q(a){var d=[],e=a.length,g,p=0,q=128,c=72,f,n,h,y,x;f=a.lastIndexOf("-");0>f&&(f=0);for(n=0;n<f;++n)128<=a.charCodeAt(n)&&m("not-basic"),d.push(a.charCodeAt(n));for(f=0<f?f+1:0;f<e;){n=p;g=1;for(h=36;;h+=36){f>=e&&m("invalid-input");y=a.charCodeAt(f++);y=10>y-48?y-22:26>y-65?y-65:26>y-97?y-97:36;(36<=y||y>B((2147483647-p)/g))&&m("overflow");
p+=y*g;x=h<=c?1:h>=c+26?26:h-c;if(y<x)break;y=36-x;g>B(2147483647/y)&&m("overflow");g*=y}g=d.length+1;c=r(p-n,g,0==n);B(p/g)>2147483647-q&&m("overflow");q+=B(p/g);p%=g;d.splice(p++,0,q)}return b(d)}function h(a){var b,d,g,q,c,f,n,h,y,x=[],v,u,w;a=e(a);v=a.length;b=128;d=0;c=72;for(f=0;f<v;++f)y=a[f],128>y&&x.push(F(y));for((g=q=x.length)&&x.push("-");g<v;){n=2147483647;for(f=0;f<v;++f)y=a[f],y>=b&&y<n&&(n=y);u=g+1;n-b>B((2147483647-d)/u)&&m("overflow");d+=(n-b)*u;b=n;for(f=0;f<v;++f)if(y=a[f],y<b&&
2147483647<++d&&m("overflow"),y==b){h=d;for(n=36;;n+=36){y=n<=c?1:n>=c+26?26:n-c;if(h<y)break;w=h-y;h=36-y;x.push(F(p(y+w%h,0)));h=B(w/h)}x.push(F(p(h,0)));c=r(d,u,g==q);d=0;++g}++d;++b}return x.join("")}var x="object"==typeof f&&f&&!f.nodeType&&f,v="object"==typeof c&&c&&!c.nodeType&&c,u="object"==typeof a&&a;if(u.global===u||u.window===u||u.self===u)n=u;var t=/^xn--/,z=/[^\x20-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,A={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)",
"invalid-input":"Invalid input"},B=Math.floor,F=String.fromCharCode,C,u={version:"1.4.1",ucs2:{decode:e,encode:b},decode:q,encode:h,toASCII:function(a){return d(a,function(a){return z.test(a)?"xn--"+h(a):a})},toUnicode:function(a){return d(a,function(a){return t.test(a)?q(a.slice(4).toLowerCase()):a})}};if(x&&v)if(c.exports==x)v.exports=u;else for(C in u)u.hasOwnProperty(C)&&(x[C]=u[C]);else n.punycode=u})(this)}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==
typeof window?window:{})},{}],25:[function(a,c,f){c.exports=function(a,m,g,d){g=g||"=";var e={};if("string"!==typeof a||0===a.length)return e;var b=/\+/g;a=a.split(m||"&");m=1E3;d&&"number"===typeof d.maxKeys&&(m=d.maxKeys);d=a.length;0<m&&d>m&&(d=m);for(m=0;m<d;++m){var p=a[m].replace(b,"%20"),c=p.indexOf(g),q;0<=c?(q=p.substr(0,c),p=p.substr(c+1)):(q=p,p="");q=decodeURIComponent(q);p=decodeURIComponent(p);Object.prototype.hasOwnProperty.call(e,q)?h(e[q])?e[q].push(p):e[q]=[e[q],p]:e[q]=p}return e};
var h=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],26:[function(a,c,f){function h(a,e){if(a.map)return a.map(e);for(var b=[],d=0;d<a.length;d++)b.push(e(a[d],d));return b}var n=function(a){switch(typeof a){case "string":return a;case "boolean":return a?"true":"false";case "number":return isFinite(a)?a:"";default:return""}};c.exports=function(a,e,b,p){e=e||"&";b=b||"=";null===a&&(a=void 0);return"object"===typeof a?h(g(a),function(d){var g=encodeURIComponent(n(d))+
b;return m(a[d])?h(a[d],function(a){return g+encodeURIComponent(n(a))}).join(e):g+encodeURIComponent(n(a[d]))}).join(e):p?encodeURIComponent(n(p))+b+encodeURIComponent(n(a)):""};var m=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},g=Object.keys||function(a){var d=[],b;for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&d.push(b);return d}},{}],27:[function(a,c,f){f.decode=f.parse=a("./decode");f.encode=f.stringify=a("./encode")},{"./decode":25,"./encode":26}],
28:[function(a,c,f){function h(){this.href=this.path=this.pathname=this.query=this.search=this.hash=this.hostname=this.port=this.host=this.auth=this.slashes=this.protocol=null}function n(a,b,d){if(a&&g.isObject(a)&&a instanceof h)return a;var e=new h;e.parse(a,b,d);return e}var m=a("punycode"),g=a("./util");f.parse=n;f.resolve=function(a,b){return n(a,!1,!0).resolve(b)};f.resolveObject=function(a,b){return a?n(a,!1,!0).resolveObject(b):b};f.format=function(a){g.isString(a)&&(a=n(a));return a instanceof
h?a.format():h.prototype.format.call(a)};f.Url=h;var d=/^([a-z0-9.+-]+:)/i,e=/:[0-9]*$/,b=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/;c="{}|\\^`".split("").concat('<>"` \r\n\t'.split(""));var p=["'"].concat(c),r=["%","/","?",";","#"].concat(p),q=["/","?","#"],y=/^[+a-z0-9A-Z_-]{0,63}$/,x=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},u={javascript:!0,"javascript:":!0},t={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},z=a("querystring");
h.prototype.parse=function(a,e,c){if(!g.isString(a))throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var f=a.indexOf("?"),f=-1!==f&&f<a.indexOf("#")?"?":"#";a=a.split(f);a[0]=a[0].replace(/\\/g,"/");a=a.join(f);f=a.trim();if(!c&&1===a.split("#").length&&(a=b.exec(f)))return this.href=this.path=f,this.pathname=a[1],a[2]?(this.search=a[2],this.query=e?z.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this;if(a=d.exec(f)){a=a[0];var n=a.toLowerCase();
this.protocol=n;f=f.substr(a.length)}if(c||a||f.match(/^\/\/[^@\/]+@[^@\/]+/)){var h="//"===f.substr(0,2);!h||a&&u[a]||(f=f.substr(2),this.slashes=!0)}if(!u[a]&&(h||a&&!t[a])){h=-1;for(c=0;c<q.length;c++)a=f.indexOf(q[c]),-1!==a&&(-1===h||a<h)&&(h=a);h=-1===h?f.lastIndexOf("@"):f.lastIndexOf("@",h);-1!==h&&(c=f.slice(0,h),f=f.slice(h+1),this.auth=decodeURIComponent(c));h=-1;for(c=0;c<r.length;c++)a=f.indexOf(r[c]),-1!==a&&(-1===h||a<h)&&(h=a);-1===h&&(h=f.length);this.host=f.slice(0,h);f=f.slice(h);
this.parseHost();this.hostname=this.hostname||"";h="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!h){var w=this.hostname.split(/\./);c=0;for(a=w.length;c<a;c++){var A=w[c];if(A&&!A.match(y)){for(var B="",H=0,N=A.length;H<N;H++)B=127<A.charCodeAt(H)?B+"x":B+A[H];if(!B.match(y)){a=w.slice(0,c);c=w.slice(c+1);if(A=A.match(x))a.push(A[1]),c.unshift(A[2]);c.length&&(f="/"+c.join(".")+f);this.hostname=a.join(".");break}}}}this.hostname=255<this.hostname.length?"":this.hostname.toLowerCase();
h||(this.hostname=m.toASCII(this.hostname));c=this.port?":"+this.port:"";this.host=(this.hostname||"")+c;this.href+=this.host;h&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==f[0]&&(f="/"+f))}if(!v[n])for(c=0,a=p.length;c<a;c++)h=p[c],-1!==f.indexOf(h)&&(A=encodeURIComponent(h),A===h&&(A=escape(h)),f=f.split(h).join(A));c=f.indexOf("#");-1!==c&&(this.hash=f.substr(c),f=f.slice(0,c));c=f.indexOf("?");-1!==c?(this.search=f.substr(c),this.query=f.substr(c+1),e&&(this.query=z.parse(this.query)),
f=f.slice(0,c)):e&&(this.search="",this.query={});f&&(this.pathname=f);t[n]&&this.hostname&&!this.pathname&&(this.pathname="/");if(this.pathname||this.search)c=this.pathname||"",this.path=c+(this.search||"");this.href=this.format();return this};h.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var b=this.protocol||"",d=this.pathname||"",e=this.hash||"",p=!1,m="";this.host?p=a+this.host:this.hostname&&(p=a+(-1===this.hostname.indexOf(":")?
this.hostname:"["+this.hostname+"]"),this.port&&(p+=":"+this.port));this.query&&g.isObject(this.query)&&Object.keys(this.query).length&&(m=z.stringify(this.query));a=this.search||m&&"?"+m||"";b&&":"!==b.substr(-1)&&(b+=":");this.slashes||(!b||t[b])&&!1!==p?(p="//"+(p||""),d&&"/"!==d.charAt(0)&&(d="/"+d)):p||(p="");e&&"#"!==e.charAt(0)&&(e="#"+e);a&&"?"!==a.charAt(0)&&(a="?"+a);d=d.replace(/[?#]/g,function(a){return encodeURIComponent(a)});a=a.replace("#","%23");return b+p+d+a+e};h.prototype.resolve=
function(a){return this.resolveObject(n(a,!1,!0)).format()};h.prototype.resolveObject=function(a){if(g.isString(a)){var b=new h;b.parse(a,!1,!0);a=b}for(var b=new h,d=Object.keys(this),e=0;e<d.length;e++){var p=d[e];b[p]=this[p]}b.hash=a.hash;if(""===a.href)return b.href=b.format(),b;if(a.slashes&&!a.protocol){d=Object.keys(a);for(e=0;e<d.length;e++)p=d[e],"protocol"!==p&&(b[p]=a[p]);t[b.protocol]&&b.hostname&&!b.pathname&&(b.path=b.pathname="/");b.href=b.format();return b}if(a.protocol&&a.protocol!==
b.protocol){if(!t[a.protocol]){d=Object.keys(a);for(e=0;e<d.length;e++)p=d[e],b[p]=a[p];b.href=b.format();return b}b.protocol=a.protocol;if(a.host||u[a.protocol])b.pathname=a.pathname;else{for(var m=(a.pathname||"").split("/");m.length&&!(a.host=m.shift()););a.host||(a.host="");a.hostname||(a.hostname="");""!==m[0]&&m.unshift("");2>m.length&&m.unshift("");b.pathname=m.join("/")}b.search=a.search;b.query=a.query;b.host=a.host||"";b.auth=a.auth;b.hostname=a.hostname||a.host;b.port=a.port;if(b.pathname||
b.search)b.path=(b.pathname||"")+(b.search||"");b.slashes=b.slashes||a.slashes;b.href=b.format();return b}var d=b.pathname&&"/"===b.pathname.charAt(0),q=a.host||a.pathname&&"/"===a.pathname.charAt(0),c=d=q||d||b.host&&a.pathname,e=b.pathname&&b.pathname.split("/")||[],m=a.pathname&&a.pathname.split("/")||[];if(p=b.protocol&&!t[b.protocol])b.hostname="",b.port=null,b.host&&(""===e[0]?e[0]=b.host:e.unshift(b.host)),b.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===m[0]?m[0]=a.host:m.unshift(a.host)),
a.host=null),d=d&&(""===m[0]||""===e[0]);if(q)b.host=a.host||""===a.host?a.host:b.host,b.hostname=a.hostname||""===a.hostname?a.hostname:b.hostname,b.search=a.search,b.query=a.query,e=m;else if(m.length)e||(e=[]),e.pop(),e=e.concat(m),b.search=a.search,b.query=a.query;else if(!g.isNullOrUndefined(a.search))return p&&(b.hostname=b.host=e.shift(),p=b.host&&0<b.host.indexOf("@")?b.host.split("@"):!1)&&(b.auth=p.shift(),b.host=b.hostname=p.shift()),b.search=a.search,b.query=a.query,g.isNull(b.pathname)&&
g.isNull(b.search)||(b.path=(b.pathname?b.pathname:"")+(b.search?b.search:"")),b.href=b.format(),b;if(!e.length)return b.pathname=null,b.path=b.search?"/"+b.search:null,b.href=b.format(),b;for(var q=e.slice(-1)[0],m=(b.host||a.host||1<e.length)&&("."===q||".."===q)||""===q,r=0,f=e.length;0<=f;f--)q=e[f],"."===q?e.splice(f,1):".."===q?(e.splice(f,1),r++):r&&(e.splice(f,1),r--);if(!d&&!c)for(;r--;r)e.unshift("..");!d||""===e[0]||e[0]&&"/"===e[0].charAt(0)||e.unshift("");m&&"/"!==e.join("/").substr(-1)&&
e.push("");c=""===e[0]||e[0]&&"/"===e[0].charAt(0);p&&(b.hostname=b.host=c?"":e.length?e.shift():"",p=b.host&&0<b.host.indexOf("@")?b.host.split("@"):!1)&&(b.auth=p.shift(),b.host=b.hostname=p.shift());(d=d||b.host&&e.length)&&!c&&e.unshift("");e.length?b.pathname=e.join("/"):(b.pathname=null,b.path=null);g.isNull(b.pathname)&&g.isNull(b.search)||(b.path=(b.pathname?b.pathname:"")+(b.search?b.search:""));b.auth=a.auth||b.auth;b.slashes=b.slashes||a.slashes;b.href=b.format();return b};h.prototype.parseHost=
function(){var a=this.host,b=e.exec(a);b&&(b=b[0],":"!==b&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length));a&&(this.hostname=a)}},{"./util":29,punycode:24,querystring:27}],29:[function(a,c,f){c.exports={isString:function(a){return"string"===typeof a},isObject:function(a){return"object"===typeof a&&null!==a},isNull:function(a){return null===a},isNullOrUndefined:function(a){return null==a}}},{}],30:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}f.__esModule=!0;var n=
"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};c=a("mini-signals");var m=h(c);c=a("parse-uri");var g=h(c),d=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("./async"));a=a("./Resource");var e=h(a),b=/(#[\w-]+)?$/;a=function(){function a(){var b=
this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",g=1<arguments.length&&void 0!==arguments[1]?arguments[1]:10;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.baseUrl=e;this.progress=0;this.loading=!1;this.defaultQueryString="";this._beforeMiddleware=[];this._afterMiddleware=[];this._resourcesParsing=[];this._boundLoadResource=function(a,d){return b._loadResource(a,d)};this._queue=d.queue(this._boundLoadResource,g);this._queue.pause();this.resources=
{};this.onProgress=new m["default"];this.onError=new m["default"];this.onLoad=new m["default"];this.onStart=new m["default"];this.onComplete=new m["default"]}a.prototype.add=function(a,b,d,g){if(Array.isArray(a)){for(b=0;b<a.length;++b)this.add(a[b]);return this}"object"===("undefined"===typeof a?"undefined":n(a))&&(g=b||a.callback||a.onComplete,d=a,b=a.url,a=a.name||a.key||a.url);"string"!==typeof b&&(g=d,d=b,b=a);if("string"!==typeof b)throw Error("No url passed to add resource to loader.");"function"===
typeof d&&(g=d,d=null);if(this.loading&&(!d||!d.parentResource))throw Error("Cannot add resources while the loader is running.");if(this.resources[a])throw Error('Resource named "'+a+'" already exists.');b=this._prepareUrl(b);this.resources[a]=new e["default"](a,b,d);if("function"===typeof g)this.resources[a].onAfterMiddleware.once(g);if(this.loading){d=d.parentResource;b=[];for(g=0;g<d.children.length;++g)d.children[g].isComplete||b.push(d.children[g]);g=d.progressChunk*(b.length+1)/(b.length+2);
d.children.push(this.resources[a]);d.progressChunk=g;for(d=0;d<b.length;++d)b[d].progressChunk=g}this._queue.push(this.resources[a]);return this};a.prototype.pre=function(a){this._beforeMiddleware.push(a);return this};a.prototype.use=function(a){this._afterMiddleware.push(a);return this};a.prototype.reset=function(){this.progress=0;this.loading=!1;this._queue.kill();this._queue.pause();for(var a in this.resources){var b=this.resources[a];b._onLoadBinding&&b._onLoadBinding.detach();b.isLoading&&b.abort()}this.resources=
{};return this};a.prototype.load=function(a){if("function"===typeof a)this.onComplete.once(a);if(this.loading)return this;a=100/this._queue._tasks.length;for(var b=0;b<this._queue._tasks.length;++b)this._queue._tasks[b].data.progressChunk=a;this.loading=!0;this.onStart.dispatch(this);this._queue.resume();return this};a.prototype._prepareUrl=function(a){var d=(0,g["default"])(a,{strictMode:!0});a=d.protocol||!d.path||0===a.indexOf("//")?a:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-
1&&"/"!==a.charAt(0)?this.baseUrl+"/"+a:this.baseUrl+a;this.defaultQueryString&&(d=b.exec(a)[0],a=a.substr(0,a.length-d.length),a=-1!==a.indexOf("?")?a+("&"+this.defaultQueryString):a+("?"+this.defaultQueryString),a+=d);return a};a.prototype._loadResource=function(a,b){var e=this;a._dequeue=b;d.eachSeries(this._beforeMiddleware,function(b,d){b.call(e,a,function(){d(a.isComplete?{}:null)})},function(){a.isComplete?e._onLoad(a):(a._onLoadBinding=a.onComplete.once(e._onLoad,e),a.load())})};a.prototype._onComplete=
function(){this.loading=!1;this.onComplete.dispatch(this,this.resources)};a.prototype._onLoad=function(a){var b=this;a._onLoadBinding=null;a._dequeue();this._resourcesParsing.push(a);d.eachSeries(this._afterMiddleware,function(d,e){d.call(b,a,e)},function(){a.onAfterMiddleware.dispatch(a);b.progress+=a.progressChunk;b.onProgress.dispatch(b,a);a.error?b.onError.dispatch(a.error,b,a):b.onLoad.dispatch(b,a);b._resourcesParsing.splice(b._resourcesParsing.indexOf(a),1);b._queue.idle()&&0===b._resourcesParsing.length&&
(b.progress=100,b._onComplete())})};return a}();f["default"]=a},{"./Resource":31,"./async":32,"mini-signals":36,"parse-uri":37}],31:[function(a,c,f){function h(){}function n(a,b,d){b&&0===b.indexOf(".")&&(b=b.substring(1));b&&(a[b]=d)}function m(a){return a.toString().replace("object ","")}f.__esModule=!0;var g=function(){function a(a,b){for(var d=0;d<b.length;d++){var e=b[d];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,
d,e){d&&a(b.prototype,d);e&&a(b,e);return b}}(),d=(c=a("parse-uri"))&&c.__esModule?c:{"default":c},e=(a=a("mini-signals"))&&a.__esModule?a:{"default":a},b=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),p=null;a=function(){function a(b,d,g){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");if("string"!==typeof b||"string"!==typeof d)throw Error("Both name and url are required for constructing a resource.");g=g||{};this._flags=0;this._setFlag(a.STATUS_FLAGS.DATA_URL,
0===d.indexOf("data:"));this.name=b;this.url=d;this.data=null;this.crossOrigin=!0===g.crossOrigin?"anonymous":g.crossOrigin;this.loadType=g.loadType||this._determineLoadType();this.xhrType=g.xhrType;this.metadata=g.metadata||{};this.xhr=this.error=null;this.children=[];this.type=a.TYPE.UNKNOWN;this.progressChunk=0;this._dequeue=h;this._onLoadBinding=null;this._boundComplete=this.complete.bind(this);this._boundOnError=this._onError.bind(this);this._boundOnProgress=this._onProgress.bind(this);this._boundXhrOnError=
this._xhrOnError.bind(this);this._boundXhrOnAbort=this._xhrOnAbort.bind(this);this._boundXhrOnLoad=this._xhrOnLoad.bind(this);this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this);this.onStart=new e["default"];this.onProgress=new e["default"];this.onComplete=new e["default"];this.onAfterMiddleware=new e["default"]}a.setExtensionLoadType=function(b,d){n(a._loadTypeMap,b,d)};a.setExtensionXhrType=function(b,d){n(a._xhrTypeMap,b,d)};a.prototype.complete=function(){this.data&&this.data.removeEventListener&&
(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1));this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",
this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null));if(this.isComplete)throw Error("Complete called again for an already completed resource.");this._setFlag(a.STATUS_FLAGS.COMPLETE,!0);this._setFlag(a.STATUS_FLAGS.LOADING,!1);this.onComplete.dispatch(this)};a.prototype.abort=function(b){if(!this.error){this.error=Error(b);if(this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=
a.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this.complete()}};a.prototype.load=function(d){var e=this;if(!this.isLoading)if(this.isComplete)d&&setTimeout(function(){return d(e)},1);else{if(d)this.onComplete.once(d);this._setFlag(a.STATUS_FLAGS.LOADING,!0);this.onStart.dispatch(this);if(!1===this.crossOrigin||"string"!==typeof this.crossOrigin)this.crossOrigin=this._determineCrossOrigin(this.url);switch(this.loadType){case a.LOAD_TYPE.IMAGE:this.type=a.TYPE.IMAGE;
this._loadElement("image");break;case a.LOAD_TYPE.AUDIO:this.type=a.TYPE.AUDIO;this._loadSourceElement("audio");break;case a.LOAD_TYPE.VIDEO:this.type=a.TYPE.VIDEO;this._loadSourceElement("video");break;default:b&&this.crossOrigin?this._loadXdr():this._loadXhr()}}};a.prototype._hasFlag=function(a){return!!(this._flags&a)};a.prototype._setFlag=function(a,b){this._flags=b?this._flags|a:this._flags&~a};a.prototype._loadElement=function(a){this.data=this.metadata.loadElement?this.metadata.loadElement:
"image"===a&&"undefined"!==typeof window.Image?new Image:document.createElement(a);this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin);this.metadata.skipSource||(this.data.src=this.url);this.data.addEventListener("error",this._boundOnError,!1);this.data.addEventListener("load",this._boundComplete,!1);this.data.addEventListener("progress",this._boundOnProgress,!1)};a.prototype._loadSourceElement=function(a){this.data=this.metadata.loadElement?this.metadata.loadElement:"audio"===a&&"undefined"!==
typeof window.Audio?new Audio:document.createElement(a);if(null===this.data)this.abort("Unsupported element: "+a);else{if(!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var b=0;b<this.url.length;++b)this.data.appendChild(this._createSource(a,this.url[b]));else this.data.appendChild(this._createSource(a,this.url));this.data.addEventListener("error",this._boundOnError,!1);this.data.addEventListener("load",
this._boundComplete,!1);this.data.addEventListener("progress",this._boundOnProgress,!1);this.data.addEventListener("canplaythrough",this._boundComplete,!1);this.data.load()}};a.prototype._loadXhr=function(){"string"!==typeof this.xhrType&&(this.xhrType=this._determineXhrType());var b=this.xhr=new XMLHttpRequest;b.open("GET",this.url,!0);b.responseType=this.xhrType===a.XHR_RESPONSE_TYPE.JSON||this.xhrType===a.XHR_RESPONSE_TYPE.DOCUMENT?a.XHR_RESPONSE_TYPE.TEXT:this.xhrType;b.addEventListener("error",
this._boundXhrOnError,!1);b.addEventListener("abort",this._boundXhrOnAbort,!1);b.addEventListener("progress",this._boundOnProgress,!1);b.addEventListener("load",this._boundXhrOnLoad,!1);b.send()};a.prototype._loadXdr=function(){"string"!==typeof this.xhrType&&(this.xhrType=this._determineXhrType());var a=this.xhr=new XDomainRequest;a.timeout=5E3;a.onerror=this._boundXhrOnError;a.ontimeout=this._boundXdrOnTimeout;a.onprogress=this._boundOnProgress;a.onload=this._boundXhrOnLoad;a.open("GET",this.url,
!0);setTimeout(function(){return a.send()},1)};a.prototype._createSource=function(a,b,d){d||(d=a+"/"+b.substr(b.lastIndexOf(".")+1));a=document.createElement("source");a.src=b;a.type=d;return a};a.prototype._onError=function(a){this.abort("Failed to load element using: "+a.target.nodeName)};a.prototype._onProgress=function(a){a&&a.lengthComputable&&this.onProgress.dispatch(this,a.loaded/a.total)};a.prototype._xhrOnError=function(){var a=this.xhr;this.abort(m(a)+" Request failed. Status: "+a.status+
', text: "'+a.statusText+'"')};a.prototype._xhrOnAbort=function(){this.abort(m(this.xhr)+" Request was aborted by the user.")};a.prototype._xdrOnTimeout=function(){this.abort(m(this.xhr)+" Request timed out.")};a.prototype._xhrOnLoad=function(){var b=this.xhr,d="undefined"===typeof b.status?b.status:200;if(200===d||204===d||0===d&&0<b.responseText.length){if(this.xhrType===a.XHR_RESPONSE_TYPE.TEXT)this.data=b.responseText,this.type=a.TYPE.TEXT;else if(this.xhrType===a.XHR_RESPONSE_TYPE.JSON)try{this.data=
JSON.parse(b.responseText),this.type=a.TYPE.JSON}catch(v){this.abort("Error trying to parse loaded json: "+v);return}else if(this.xhrType===a.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser)this.data=(new DOMParser).parseFromString(b.responseText,"text/xml");else{var e=document.createElement("div");e.innerHTML=b.responseText;this.data=e}this.type=a.TYPE.XML}catch(v){this.abort("Error trying to parse loaded xml: "+v);return}else this.data=b.response||b.responseText;this.complete()}else this.abort("["+
b.status+"] "+b.statusText+": "+b.responseURL)};a.prototype._determineCrossOrigin=function(a,b){if(0===a.indexOf("data:"))return"";b=b||window.location;p||(p=document.createElement("a"));p.href=a;a=(0,d["default"])(p.href,{strictMode:!0});var e=!a.port&&""===b.port||a.port===b.port,g=a.protocol?a.protocol+":":"";return a.host===b.hostname&&e&&g===b.protocol?"":"anonymous"};a.prototype._determineXhrType=function(){return a._xhrTypeMap[this._getExtension()]||a.XHR_RESPONSE_TYPE.TEXT};a.prototype._determineLoadType=
function(){return a._loadTypeMap[this._getExtension()]||a.LOAD_TYPE.XHR};a.prototype._getExtension=function(){var a=this.url;if(this.isDataUrl)var b=a.indexOf("/"),a=a.substring(b+1,a.indexOf(";",b));else b=a.indexOf("?"),-1!==b&&(a=a.substring(0,b)),a=a.substring(a.lastIndexOf(".")+1);return a.toLowerCase()};a.prototype._getMimeFromXhrType=function(b){switch(b){case a.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case a.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case a.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";
case a.XHR_RESPONSE_TYPE.JSON:return"application/json";default:return"text/plain"}};g(a,[{key:"isDataUrl",get:function(){return this._hasFlag(a.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(a.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(a.STATUS_FLAGS.LOADING)}}]);return a}();f["default"]=a;a.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4};a.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6};a.LOAD_TYPE={XHR:1,IMAGE:2,
AUDIO:3,VIDEO:4};a.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"};a._loadTypeMap={gif:a.LOAD_TYPE.IMAGE,png:a.LOAD_TYPE.IMAGE,bmp:a.LOAD_TYPE.IMAGE,jpg:a.LOAD_TYPE.IMAGE,jpeg:a.LOAD_TYPE.IMAGE,tif:a.LOAD_TYPE.IMAGE,tiff:a.LOAD_TYPE.IMAGE,webp:a.LOAD_TYPE.IMAGE,tga:a.LOAD_TYPE.IMAGE,svg:a.LOAD_TYPE.IMAGE,"svg+xml":a.LOAD_TYPE.IMAGE,mp3:a.LOAD_TYPE.AUDIO,ogg:a.LOAD_TYPE.AUDIO,wav:a.LOAD_TYPE.AUDIO,mp4:a.LOAD_TYPE.VIDEO,webm:a.LOAD_TYPE.VIDEO};
a._xhrTypeMap={xhtml:a.XHR_RESPONSE_TYPE.DOCUMENT,html:a.XHR_RESPONSE_TYPE.DOCUMENT,htm:a.XHR_RESPONSE_TYPE.DOCUMENT,xml:a.XHR_RESPONSE_TYPE.DOCUMENT,tmx:a.XHR_RESPONSE_TYPE.DOCUMENT,svg:a.XHR_RESPONSE_TYPE.DOCUMENT,tsx:a.XHR_RESPONSE_TYPE.DOCUMENT,gif:a.XHR_RESPONSE_TYPE.BLOB,png:a.XHR_RESPONSE_TYPE.BLOB,bmp:a.XHR_RESPONSE_TYPE.BLOB,jpg:a.XHR_RESPONSE_TYPE.BLOB,jpeg:a.XHR_RESPONSE_TYPE.BLOB,tif:a.XHR_RESPONSE_TYPE.BLOB,tiff:a.XHR_RESPONSE_TYPE.BLOB,webp:a.XHR_RESPONSE_TYPE.BLOB,tga:a.XHR_RESPONSE_TYPE.BLOB,
json:a.XHR_RESPONSE_TYPE.JSON,text:a.XHR_RESPONSE_TYPE.TEXT,txt:a.XHR_RESPONSE_TYPE.TEXT,ttf:a.XHR_RESPONSE_TYPE.BUFFER,otf:a.XHR_RESPONSE_TYPE.BUFFER};a.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="},{"mini-signals":36,"parse-uri":37}],32:[function(a,c,f){function h(){}function n(a){return function(){if(null===a)throw Error("Callback was already called.");var g=a;a=null;g.apply(this,arguments)}}f.__esModule=!0;f.eachSeries=function(a,g,d){var e=0,
b=a.length;(function r(m){m||e===b?d&&d(m):g(a[e++],r)})()};f.queue=function(a,g){function d(a,b,d){if(null!=d&&"function"!==typeof d)throw Error("task callback must be a function");p.started=!0;null==a&&p.idle()?setTimeout(function(){return p.drain()},1):(a={data:a,callback:"function"===typeof d?d:h},b?p._tasks.unshift(a):p._tasks.push(a),setTimeout(function(){return p.process()},1))}function e(a){return function(){--b;a.callback.apply(a,arguments);null!=arguments[0]&&p.error(arguments[0],a.data);
b<=p.concurrency-p.buffer&&p.unsaturated();p.idle()&&p.drain();p.process()}}if(null==g)g=1;else if(0===g)throw Error("Concurrency must not be zero");var b=0,p={_tasks:[],concurrency:g,saturated:h,unsaturated:h,buffer:g/4,empty:h,drain:h,error:h,started:!1,paused:!1,push:function(a,b){d(a,!1,b)},kill:function(){b=0;p.drain=h;p.started=!1;p._tasks=[]},unshift:function(a,b){d(a,!0,b)},process:function(){for(;!p.paused&&b<p.concurrency&&p._tasks.length;){var d=p._tasks.shift();0===p._tasks.length&&p.empty();
b+=1;b===p.concurrency&&p.saturated();a(d.data,n(e(d)))}},length:function(){return p._tasks.length},running:function(){return b},idle:function(){return 0===p._tasks.length+b},pause:function(){!0!==p.paused&&(p.paused=!0)},resume:function(){if(!1!==p.paused){p.paused=!1;for(var a=1;a<=p.concurrency;a++)p.process()}}};return p}},{}],33:[function(a,c,f){f.__esModule=!0;f.encodeBinary=function(a){for(var m="",g=0;g<a.length;){for(var d=[0,0,0],e=[0,0,0,0],b=0;b<d.length;++b)d[b]=g<a.length?a.charCodeAt(g++)&
255:0;e[0]=d[0]>>2;e[1]=(d[0]&3)<<4|d[1]>>4;e[2]=(d[1]&15)<<2|d[2]>>6;e[3]=d[2]&63;switch(g-(a.length-1)){case 2:e[3]=64;e[2]=64;break;case 1:e[3]=64}for(d=0;d<e.length;++d)m+=h.charAt(e[d])}return m};var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},{}],34:[function(a,c,f){function h(a){if(a&&a.__esModule)return a;var d={};if(null!=a)for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(d[b]=a[b]);d["default"]=a;return d}f.__esModule=!0;var n=a("./Loader"),n=n&&n.__esModule?
n:{"default":n},m=a("./Resource"),m=m&&m.__esModule?m:{"default":m},g=a("./async"),g=h(g);a=a("./b64");a=h(a);n["default"].Resource=m["default"];n["default"].async=g;n["default"].base64=a;c.exports=n["default"];f["default"]=n["default"]},{"./Loader":30,"./Resource":31,"./async":32,"./b64":33}],35:[function(a,c,f){f.__esModule=!0;var h="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&
a!==Symbol.prototype?"symbol":typeof a};f.blobMiddlewareFactory=function(){return function(a,e){if(a.data&&a.xhr&&a.xhrType===n["default"].XHR_RESPONSE_TYPE.BLOB)if(!window.Blob||"string"===typeof a.data){var b=a.xhr.getResponseHeader("content-type");if(b&&0===b.indexOf("image")){a.data=new Image;a.data.src="data:"+b+";base64,"+m["default"].encodeBinary(a.xhr.responseText);a.type=n["default"].TYPE.IMAGE;a.data.onload=function(){a.data.onload=null;e()};return}}else if(0===a.data.type.indexOf("image")&&
(b=function(){var b=g.createObjectURL(a.data);a.blob=a.data;a.data=new Image;a.data.src=b;a.type=n["default"].TYPE.IMAGE;a.data.onload=function(){g.revokeObjectURL(b);a.data.onload=null;e()};return{v:void 0}}(),"object"===("undefined"===typeof b?"undefined":h(b))))return b.v;e()}};var n=(c=a("../../Resource"))&&c.__esModule?c:{"default":c},m=(a=a("../../b64"))&&a.__esModule?a:{"default":a},g=window.URL||window.webkitURL},{"../../Resource":31,"../../b64":33}],36:[function(a,c,f){function h(a,e){if(!(a instanceof
e))throw new TypeError("Cannot call a class as a function");}function n(a,e){a._head?(a._tail._next=e,e._prev=a._tail):a._head=e;a._tail=e;e._owner=a;return e}Object.defineProperty(f,"__esModule",{value:!0});var m=function(){function a(a,b){for(var d=0;d<b.length;d++){var e=b[d];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(d,b,g){b&&a(d.prototype,b);g&&a(d,g);return d}}(),g=function(){function a(d,b,g){void 0===b&&(b=
!1);h(this,a);this._fn=d;this._once=b;this._thisArg=g;this._next=this._prev=this._owner=null}m(a,[{key:"detach",value:function(){if(null===this._owner)return!1;this._owner.detach(this);return!0}}]);return a}();a=function(){function a(){h(this,a);this._head=this._tail=void 0}m(a,[{key:"handlers",value:function(){var a=this._head;if(0>=arguments.length||void 0===arguments[0]?0:arguments[0])return!!a;for(var b=[];a;)b.push(a),a=a._next;return b}},{key:"has",value:function(a){if(!(a instanceof g))throw Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");
return a._owner===this}},{key:"dispatch",value:function(){var a=this._head;if(!a)return!1;for(;a;)a._once&&this.detach(a),a._fn.apply(a._thisArg,arguments),a=a._next;return!0}},{key:"add",value:function(a){var b=1>=arguments.length||void 0===arguments[1]?null:arguments[1];if("function"!==typeof a)throw Error("MiniSignal#add(): First arg must be a Function.");return n(this,new g(a,!1,b))}},{key:"once",value:function(a){var b=1>=arguments.length||void 0===arguments[1]?null:arguments[1];if("function"!==
typeof a)throw Error("MiniSignal#once(): First arg must be a Function.");return n(this,new g(a,!0,b))}},{key:"detach",value:function(a){if(!(a instanceof g))throw Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");if(a._owner!==this)return this;a._prev&&(a._prev._next=a._next);a._next&&(a._next._prev=a._prev);a===this._head?(this._head=a._next,null===a._next&&(this._tail=null)):a===this._tail&&(this._tail=a._prev,this._tail._next=null);a._owner=null;return this}},{key:"detachAll",
value:function(){var a=this._head;if(!a)return this;for(this._head=this._tail=null;a;)a._owner=null,a=a._next;return this}}]);return a}();a.MiniSignalBinding=g;f["default"]=a;c.exports=f["default"]},{}],37:[function(a,c,f){c.exports=function(a,c){c=c||{};for(var m="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),g={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}[c.strictMode?"strict":"loose"].exec(a),d={},e=14;e--;)d[m[e]]=g[e]||"";d.queryKey={};d[m[12]].replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,e,g){e&&(d.queryKey[e]=g)});return d}},{}],38:[function(a,c,f){f.__esModule=!0;var h=function(a){if(a&&a.__esModule)return a;var g={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,
d)&&(g[d]=a[d]);g["default"]=a;return g}(a("../core")),n=(c=a("ismobilejs"))&&c.__esModule?c:{"default":c};a=a("./accessibleTarget");Object.assign(h.DisplayObject.prototype,(a&&a.__esModule?a:{"default":a})["default"]);a=function(){function a(g){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");!n["default"].tablet&&!n["default"].phone||navigator.isCocoonJS||this.createTouchHook();var d=document.createElement("div");d.style.width="100px";d.style.height="100px";d.style.position=
"absolute";d.style.top="0px";d.style.left="0px";d.style.zIndex=2;this.div=d;this.pool=[];this.renderId=0;this.debug=!1;this.renderer=g;this.children=[];this._onKeyDown=this._onKeyDown.bind(this);this._onMouseMove=this._onMouseMove.bind(this);this.isMobileAccessabillity=this.isActive=!1;window.addEventListener("keydown",this._onKeyDown,!1)}a.prototype.createTouchHook=function(){var a=this,d=document.createElement("button");d.style.width="1px";d.style.height="1px";d.style.position="absolute";d.style.top=
"-1000px";d.style.left="-1000px";d.style.zIndex=2;d.style.backgroundColor="#FF0000";d.title="HOOK DIV";d.addEventListener("focus",function(){a.isMobileAccessabillity=!0;a.activate();document.body.removeChild(d)});document.body.appendChild(d)};a.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&
this.renderer.view.parentNode.appendChild(this.div))};a.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessabillity&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))};a.prototype.updateAccessibleObjects=function(a){if(a.visible){a.accessible&&a.interactive&&(a._accessibleActive||this.addChild(a),
a.renderId=this.renderId);a=a.children;for(var d=a.length-1;0<=d;d--)this.updateAccessibleObjects(a[d])}};a.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var a=this.renderer.view.getBoundingClientRect(),d=a.width/this.renderer.width,e=a.height/this.renderer.height,b=this.div;b.style.left=a.left+"px";b.style.top=a.top+"px";b.style.width=this.renderer.width+"px";b.style.height=this.renderer.height+"px";for(a=0;a<this.children.length;a++){var p=
this.children[a];if(p.renderId!==this.renderId)p._accessibleActive=!1,h.utils.removeItems(this.children,a,1),this.div.removeChild(p._accessibleDiv),this.pool.push(p._accessibleDiv),p._accessibleDiv=null,a--,0===this.children.length&&this.deactivate();else{var b=p._accessibleDiv,m=p.hitArea,c=p.worldTransform;p.hitArea?(b.style.left=(c.tx+m.x*c.a)*d+"px",b.style.top=(c.ty+m.y*c.d)*e+"px",b.style.width=m.width*c.a*d+"px",b.style.height=m.height*c.d*e+"px"):(m=p.getBounds(),this.capHitArea(m),b.style.left=
m.x*d+"px",b.style.top=m.y*e+"px",b.style.width=m.width*d+"px",b.style.height=m.height*e+"px")}}this.renderId++}};a.prototype.capHitArea=function(a){0>a.x&&(a.width+=a.x,a.x=0);0>a.y&&(a.height+=a.y,a.y=0);a.x+a.width>this.renderer.width&&(a.width=this.renderer.width-a.x);a.y+a.height>this.renderer.height&&(a.height=this.renderer.height-a.y)};a.prototype.addChild=function(a){var d=this.pool.pop();d||(d=document.createElement("button"),d.style.width="100px",d.style.height="100px",d.style.backgroundColor=
this.debug?"rgba(255,0,0,0.5)":"transparent",d.style.position="absolute",d.style.zIndex=2,d.style.borderStyle="none",d.addEventListener("click",this._onClick.bind(this)),d.addEventListener("focus",this._onFocus.bind(this)),d.addEventListener("focusout",this._onFocusOut.bind(this)));a.accessibleTitle?d.title=a.accessibleTitle:a.accessibleTitle||a.accessibleHint||(d.title="displayObject "+this.tabIndex);a.accessibleHint&&d.setAttribute("aria-label",a.accessibleHint);a._accessibleActive=!0;a._accessibleDiv=
d;d.displayObject=a;this.children.push(a);this.div.appendChild(a._accessibleDiv);a._accessibleDiv.tabIndex=a.tabIndex};a.prototype._onClick=function(a){var d=this.renderer.plugins.interaction;d.dispatchEvent(a.target.displayObject,"click",d.eventData)};a.prototype._onFocus=function(a){var d=this.renderer.plugins.interaction;d.dispatchEvent(a.target.displayObject,"mouseover",d.eventData)};a.prototype._onFocusOut=function(a){var d=this.renderer.plugins.interaction;d.dispatchEvent(a.target.displayObject,
"mouseout",d.eventData)};a.prototype._onKeyDown=function(a){9===a.keyCode&&this.activate()};a.prototype._onMouseMove=function(){this.deactivate()};a.prototype.destroy=function(){this.div=null;for(var a=0;a<this.children.length;a++)this.children[a].div=null;window.document.removeEventListener("mousemove",this._onMouseMove);window.removeEventListener("keydown",this._onKeyDown);this.renderer=this.children=this.pool=null};return a}();f["default"]=a;h.WebGLRenderer.registerPlugin("accessibility",a);h.CanvasRenderer.registerPlugin("accessibility",
a)},{"../core":63,"./accessibleTarget":39,ismobilejs:4}],39:[function(a,c,f){f.__esModule=!0;f["default"]={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1}},{}],40:[function(a,c,f){f.__esModule=!0;var h=a("./accessibleTarget");Object.defineProperty(f,"accessibleTarget",{enumerable:!0,get:function(){return(h&&h.__esModule?h:{"default":h})["default"]}});var n=a("./AccessibilityManager");Object.defineProperty(f,"AccessibilityManager",{enumerable:!0,
get:function(){return(n&&n.__esModule?n:{"default":n})["default"]}})},{"./AccessibilityManager":38,"./accessibleTarget":39}],41:[function(a,c,f){f.__esModule=!0;var h=function(){function a(a,b){for(var d=0;d<b.length;d++){var e=b[d];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(d,b,g){b&&a(d.prototype,b);g&&a(d,g);return d}}(),n=a("./autoDetectRenderer"),m=(c=a("./display/Container"))&&c.__esModule?c:{"default":c},g=
(a=a("./ticker/Ticker"))&&a.__esModule?a:{"default":a};a=function(){function a(d,b,p,c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=(0,n.autoDetectRenderer)(d,b,p,c);this.stage=new m["default"];this.ticker=new g["default"];this.ticker.add(this.render,this);this.start()}a.prototype.render=function(){this.renderer.render(this.stage)};a.prototype.stop=function(){this.ticker.stop()};a.prototype.start=function(){this.ticker.start()};a.prototype.destroy=
function(a){this.stop();this.ticker.remove(this.render,this);this.ticker=null;this.stage.destroy();this.stage=null;this.renderer.destroy(a);this.renderer=null};h(a,[{key:"view",get:function(){return this.renderer.view}}]);return a}();f["default"]=a},{"./autoDetectRenderer":43,"./display/Container":46,"./ticker/Ticker":114}],42:[function(a,c,f){function h(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+typeof d);a.prototype=Object.create(d&&
d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});d&&(Object.setPrototypeOf?Object.setPrototypeOf(a,d):a.__proto__=d)}function n(a){if(a instanceof Array)"precision"!==a[0].substring(0,9)&&(a=a.slice(0),a.unshift("precision "+m+" float;"));else if("precision"!==a.substring(0,9))return"precision "+m+" float;\n"+a;return a}f.__esModule=!0;c=a("pixi-gl-core");a=a("./settings");var m=(a&&a.__esModule?a:{"default":a})["default"].PRECISION;a=function(a){function d(e,b,g){if(!(this instanceof
d))throw new TypeError("Cannot call a class as a function");e=a.call(this,e,n(b),n(g));if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?this:e}h(d,a);return d}(c.GLShader);f["default"]=a},{"./settings":99,"pixi-gl-core":12}],43:[function(a,c,f){f.__esModule=!0;f.autoDetectRenderer=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:800,d=1<arguments.length&&void 0!==arguments[1]?
arguments[1]:600,e=arguments[2];return!arguments[3]&&h.isWebGLSupported()?new m["default"](a,d,e):new n["default"](a,d,e)};var h=function(a){if(a&&a.__esModule)return a;var d={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(d[e]=a[e]);d["default"]=a;return d}(a("./utils")),n=(c=a("./renderers/canvas/CanvasRenderer"))&&c.__esModule?c:{"default":c},m=(a=a("./renderers/webgl/WebGLRenderer"))&&a.__esModule?a:{"default":a}},{"./renderers/canvas/CanvasRenderer":75,"./renderers/webgl/WebGLRenderer":82,
"./utils":119}],44:[function(a,c,f){f.__esModule=!0;f.VERSION="4.3.4";f.PI_2=2*Math.PI;f.RAD_TO_DEG=180/Math.PI;f.DEG_TO_RAD=Math.PI/180;f.RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2};f.BLEND_MODES={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16};f.DRAW_MODES={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};f.SCALE_MODES=
{LINEAR:0,NEAREST:1};f.WRAP_MODES={CLAMP:0,REPEAT:1,MIRRORED_REPEAT:2};f.GC_MODES={AUTO:0,MANUAL:1};f.URL_FILE_EXTENSION=/\.(\w{3,4})(?:$|\?|#)/i;f.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;(charset=[\w-]+|base64))?,(.*)/i;f.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;f.SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4};f.PRECISION={LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"};f.TRANSFORM_MODE={STATIC:0,DYNAMIC:1};
f.TEXT_GRADIENT={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1}},{}],45:[function(a,c,f){f.__esModule=!0;var h=a("../math");a=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.minY=this.minX=Infinity;this.maxY=this.maxX=-Infinity;this.rect=null}a.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY};a.prototype.clear=function(){this.updateID++;this.minY=this.minX=Infinity;this.maxY=this.maxX=-Infinity};a.prototype.getRectangle=
function(a){if(this.minX>this.maxX||this.minY>this.maxY)return h.Rectangle.EMPTY;a=a||new h.Rectangle(0,0,1,1);a.x=this.minX;a.y=this.minY;a.width=this.maxX-this.minX;a.height=this.maxY-this.minY;return a};a.prototype.addPoint=function(a){this.minX=Math.min(this.minX,a.x);this.maxX=Math.max(this.maxX,a.x);this.minY=Math.min(this.minY,a.y);this.maxY=Math.max(this.maxY,a.y)};a.prototype.addQuad=function(a){var g=this.minX,d=this.minY,e=this.maxX,b=this.maxY,p=a[0],m=a[1],g=p<g?p:g,d=m<d?m:d,e=p>e?p:
e,b=m>b?m:b,p=a[2],m=a[3],g=p<g?p:g,d=m<d?m:d,e=p>e?p:e,b=m>b?m:b,p=a[4],m=a[5],g=p<g?p:g,d=m<d?m:d,e=p>e?p:e,b=m>b?m:b,p=a[6],m=a[7];this.minX=p<g?p:g;this.minY=m<d?m:d;this.maxX=p>e?p:e;this.maxY=m>b?m:b};a.prototype.addFrame=function(a,g,d,e,b){var p=a.worldTransform;a=p.a;var m=p.b,c=p.c,f=p.d,h=p.tx,p=p.ty,n=this.minX,u=this.minY,t=this.maxX,z=this.maxY,w=a*g+c*d+h,A=m*g+f*d+p,n=w<n?w:n,u=A<u?A:u,t=w>t?w:t,z=A>z?A:z,w=a*e+c*d+h,A=m*e+f*d+p,n=w<n?w:n,u=A<u?A:u,t=w>t?w:t,z=A>z?A:z,w=a*g+c*b+h,
A=m*g+f*b+p,n=w<n?w:n,u=A<u?A:u,t=w>t?w:t,z=A>z?A:z,w=a*e+c*b+h,A=m*e+f*b+p;this.minX=w<n?w:n;this.minY=A<u?A:u;this.maxX=w>t?w:t;this.maxY=A>z?A:z};a.prototype.addVertices=function(a,g,d,e){var b=a.worldTransform;a=b.a;for(var p=b.b,m=b.c,c=b.d,f=b.tx,b=b.ty,h=this.minX,n=this.minY,u=this.maxX,t=this.maxY;d<e;d+=2)var z=g[d],w=g[d+1],A=a*z+m*w+f,z=c*w+p*z+b,h=A<h?A:h,n=z<n?z:n,u=A>u?A:u,t=z>t?z:t;this.minX=h;this.minY=n;this.maxX=u;this.maxY=t};a.prototype.addBounds=function(a){var g=this.minX,d=
this.minY,e=this.maxX,b=this.maxY;this.minX=a.minX<g?a.minX:g;this.minY=a.minY<d?a.minY:d;this.maxX=a.maxX>e?a.maxX:e;this.maxY=a.maxY>b?a.maxY:b};a.prototype.addBoundsMask=function(a,g){var d=a.minX>g.minX?a.minX:g.minX,e=a.minY>g.minY?a.minY:g.minY,b=a.maxX<g.maxX?a.maxX:g.maxX,p=a.maxY<g.maxY?a.maxY:g.maxY;if(d<=b&&e<=p){var m=this.minX,c=this.minY,f=this.maxX,h=this.maxY;this.minX=d<m?d:m;this.minY=e<c?e:c;this.maxX=b>f?b:f;this.maxY=p>h?p:h}};a.prototype.addBoundsArea=function(a,g){var d=a.minX>
g.x?a.minX:g.x,e=a.minY>g.y?a.minY:g.y,b=a.maxX<g.x+g.width?a.maxX:g.x+g.width,p=a.maxY<g.y+g.height?a.maxY:g.y+g.height;if(d<=b&&e<=p){var m=this.minX,c=this.minY,f=this.maxX,h=this.maxY;this.minX=d<m?d:m;this.minY=e<c?e:c;this.maxX=b>f?b:f;this.maxY=p>h?p:h}};return a}();f["default"]=a},{"../math":68}],46:[function(a,c,f){function h(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+typeof d);a.prototype=Object.create(d&&d.prototype,
{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});d&&(Object.setPrototypeOf?Object.setPrototypeOf(a,d):a.__proto__=d)}f.__esModule=!0;var n=function(){function a(a,e){for(var b=0;b<e.length;b++){var d=e[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(d,e,b){e&&a(d.prototype,e);b&&a(d,b);return d}}(),m=a("../utils");a=a("./DisplayObject");a=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");
var e;e=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");e=!e||"object"!==typeof e&&"function"!==typeof e?this:e;e.children=[];return e}h(d,a);d.prototype.onChildrenChange=function(){};d.prototype.addChild=function(a){var b=arguments.length;if(1<b)for(var d=0;d<b;d++)this.addChild(arguments[d]);else a.parent&&a.parent.removeChild(a),a.parent=this,this.transform._parentID=-1,this._boundsID++,this.children.push(a),this.onChildrenChange(this.children.length-
1),a.emit("added",this);return a};d.prototype.addChildAt=function(a,b){if(0>b||b>this.children.length)throw Error(a+"addChildAt: The index "+b+" supplied is out of bounds "+this.children.length);a.parent&&a.parent.removeChild(a);a.parent=this;this.children.splice(b,0,a);this.onChildrenChange(b);a.emit("added",this);return a};d.prototype.swapChildren=function(a,b){if(a!==b){var d=this.getChildIndex(a),e=this.getChildIndex(b);this.children[d]=b;this.children[e]=a;this.onChildrenChange(d<e?d:e)}};d.prototype.getChildIndex=
function(a){a=this.children.indexOf(a);if(-1===a)throw Error("The supplied DisplayObject must be a child of the caller");return a};d.prototype.setChildIndex=function(a,b){if(0>b||b>=this.children.length)throw Error("The supplied index is out of bounds");var d=this.getChildIndex(a);(0,m.removeItems)(this.children,d,1);this.children.splice(b,0,a);this.onChildrenChange(b)};d.prototype.getChildAt=function(a){if(0>a||a>=this.children.length)throw Error("getChildAt: Index ("+a+") does not exist.");return this.children[a]};
d.prototype.removeChild=function(a){var b=arguments.length;if(1<b)for(var d=0;d<b;d++)this.removeChild(arguments[d]);else{b=this.children.indexOf(a);if(-1===b)return null;a.parent=null;(0,m.removeItems)(this.children,b,1);this.transform._parentID=-1;this._boundsID++;this.onChildrenChange(b);a.emit("removed",this)}return a};d.prototype.removeChildAt=function(a){var b=this.getChildAt(a);b.parent=null;(0,m.removeItems)(this.children,a,1);this.onChildrenChange(a);b.emit("removed",this);return b};d.prototype.removeChildren=
function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,b=arguments[1],b="number"===typeof b?b:this.children.length,d=b-a;if(0<d&&d<=b){b=this.children.splice(a,d);for(d=0;d<b.length;++d)b[d].parent=null;this.onChildrenChange(a);for(a=0;a<b.length;++a)b[a].emit("removed",this);return b}if(0===d&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.");};d.prototype.updateTransform=function(){this._boundsID++;this.transform.updateTransform(this.parent.transform);
this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var a=0,b=this.children.length;a<b;++a){var d=this.children[a];d.visible&&d.updateTransform()}};d.prototype.calculateBounds=function(){this._bounds.clear();this._calculateBounds();for(var a=0;a<this.children.length;a++){var b=this.children[a];b.visible&&b.renderable&&(b.calculateBounds(),b._mask?(b._mask.calculateBounds(),this._bounds.addBoundsMask(b._bounds,b._mask._bounds)):b.filterArea?this._bounds.addBoundsArea(b._bounds,b.filterArea):this._bounds.addBounds(b._bounds))}this._lastBoundsID=
this._boundsID};d.prototype._calculateBounds=function(){};d.prototype.renderWebGL=function(a){if(this.visible&&!(0>=this.worldAlpha)&&this.renderable)if(this._mask||this._filters)this.renderAdvancedWebGL(a);else{this._renderWebGL(a);for(var b=0,d=this.children.length;b<d;++b)this.children[b].renderWebGL(a)}};d.prototype.renderAdvancedWebGL=function(a){a.flush();var b=this._filters,d=this._mask;if(b){this._enabledFilters||(this._enabledFilters=[]);for(var e=this._enabledFilters.length=0;e<b.length;e++)b[e].enabled&&
this._enabledFilters.push(b[e]);this._enabledFilters.length&&a.filterManager.pushFilter(this,this._enabledFilters)}d&&a.maskManager.pushMask(this,this._mask);this._renderWebGL(a);for(var e=0,g=this.children.length;e<g;e++)this.children[e].renderWebGL(a);a.flush();d&&a.maskManager.popMask(this,this._mask);b&&this._enabledFilters&&this._enabledFilters.length&&a.filterManager.popFilter()};d.prototype._renderWebGL=function(a){};d.prototype._renderCanvas=function(a){};d.prototype.renderCanvas=function(a){if(this.visible&&
!(0>=this.worldAlpha)&&this.renderable){this._mask&&a.maskManager.pushMask(this._mask);this._renderCanvas(a);for(var b=0,d=this.children.length;b<d;++b)this.children[b].renderCanvas(a);this._mask&&a.maskManager.popMask(a)}};d.prototype.destroy=function(d){a.prototype.destroy.call(this);var b="boolean"===typeof d?d:d&&d.children,e=this.removeChildren(0,this.children.length);if(b)for(b=0;b<e.length;++b)e[b].destroy(d)};n(d,[{key:"width",get:function(){return this.scale.x*this.getLocalBounds().width},
set:function(a){var b=this.getLocalBounds().width;this.scale.x=0!==b?a/b:1;this._width=a}},{key:"height",get:function(){return this.scale.y*this.getLocalBounds().height},set:function(a){var b=this.getLocalBounds().height;this.scale.y=0!==b?a/b:1;this._height=a}}]);return d}((a&&a.__esModule?a:{"default":a})["default"]);f["default"]=a;a.prototype.containerUpdateTransform=a.prototype.updateTransform},{"../utils":119,"./DisplayObject":47}],47:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}
function n(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;var m=function(){function a(a,b){for(var d=0;d<b.length;d++){var e=b[d];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,
e.key,e)}}return function(b,d,e){d&&a(b.prototype,d);e&&a(b,e);return b}}();c=a("eventemitter3");c=h(c);var g=a("../const"),d=a("../settings"),e=h(d),d=a("./TransformStatic"),b=h(d),d=a("./Transform"),p=h(d),d=a("./Bounds"),r=h(d),q=a("../math");a=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var m;m=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");m=!m||"object"!==typeof m&&"function"!==
typeof m?this:m;var c=e["default"].TRANSFORM_MODE===g.TRANSFORM_MODE.STATIC?b["default"]:p["default"];m.tempDisplayObjectParent=null;m.transform=new c;m.alpha=1;m.visible=!0;m.renderable=!0;m.parent=null;m.worldAlpha=1;m.filterArea=null;m._filters=null;m._enabledFilters=null;m._bounds=new r["default"];m._boundsID=0;m._lastBoundsID=-1;m._boundsRect=null;m._localBoundsRect=null;m._mask=null;return m}n(d,a);d.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform);
this.worldAlpha=this.alpha*this.parent.worldAlpha;this._bounds.updateID++};d.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)};d.prototype.getBounds=function(a,b){a||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=
null));this._boundsID!==this._lastBoundsID&&this.calculateBounds();b||(this._boundsRect||(this._boundsRect=new q.Rectangle),b=this._boundsRect);return this._bounds.getRectangle(b)};d.prototype.getLocalBounds=function(a){var b=this.transform,d=this.parent;this.parent=null;this.transform=this._tempDisplayObjectParent.transform;a||(this._localBoundsRect||(this._localBoundsRect=new q.Rectangle),a=this._localBoundsRect);a=this.getBounds(!1,a);this.parent=d;this.transform=b;return a};d.prototype.toGlobal=
function(a,b){2<arguments.length&&void 0!==arguments[2]&&arguments[2]||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null));return this.worldTransform.apply(a,b)};d.prototype.toLocal=function(a,b,d,e){b&&(a=b.toGlobal(a,d,e));e||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),
this.parent=null));return this.worldTransform.applyInverse(a,d)};d.prototype.renderWebGL=function(a){};d.prototype.renderCanvas=function(a){};d.prototype.setParent=function(a){if(!a||!a.addChild)throw Error("setParent: Argument must be a Container");a.addChild(this);return a};d.prototype.setTransform=function(){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,e=4<arguments.length&&
void 0!==arguments[4]?arguments[4]:0,g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,p=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,m=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,c=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0;this.position.x=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.position.y=a;this.scale.x=b?b:1;this.scale.y=d?d:1;this.rotation=e;this.skew.x=g;this.skew.y=p;this.pivot.x=m;this.pivot.y=c;return this};d.prototype.destroy=
function(){this.removeAllListeners();this.parent&&this.parent.removeChild(this);this.filterArea=this._mask=this._currentBounds=this._bounds=this.parent=this.transform=null;this.interactiveChildren=this.interactive=!1};m(d,[{key:"_tempDisplayObjectParent",get:function(){null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new d);return this.tempDisplayObjectParent}},{key:"x",get:function(){return this.position.x},set:function(a){this.transform.position.x=a}},{key:"y",get:function(){return this.position.y},
set:function(a){this.transform.position.y=a}},{key:"worldTransform",get:function(){return this.transform.worldTransform}},{key:"localTransform",get:function(){return this.transform.localTransform}},{key:"position",get:function(){return this.transform.position},set:function(a){this.transform.position.copy(a)}},{key:"scale",get:function(){return this.transform.scale},set:function(a){this.transform.scale.copy(a)}},{key:"pivot",get:function(){return this.transform.pivot},set:function(a){this.transform.pivot.copy(a)}},
{key:"skew",get:function(){return this.transform.skew},set:function(a){this.transform.skew.copy(a)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(a){this.transform.rotation=a}},{key:"worldVisible",get:function(){var a=this;do{if(!a.visible)return!1;a=a.parent}while(a);return!0}},{key:"mask",get:function(){return this._mask},set:function(a){this._mask&&(this._mask.renderable=!0);if(this._mask=a)this._mask.renderable=!1}},{key:"filters",get:function(){return this._filters&&
this._filters.slice()},set:function(a){this._filters=a&&a.slice()}}]);return d}(c["default"]);f["default"]=a;a.prototype.displayObjectUpdateTransform=a.prototype.updateTransform},{"../const":44,"../math":68,"../settings":99,"./Bounds":45,"./Transform":48,"./TransformStatic":50,eventemitter3:3}],48:[function(a,c,f){function h(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+typeof d);a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,
enumerable:!1,writable:!0,configurable:!0}});d&&(Object.setPrototypeOf?Object.setPrototypeOf(a,d):a.__proto__=d)}f.__esModule=!0;var n=function(){function a(a,e){for(var b=0;b<e.length;b++){var d=e[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(d,e,b){e&&a(d.prototype,e);b&&a(d,b);return d}}(),m=a("../math");a=a("./TransformBase");a=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");
var e;e=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");e=!e||"object"!==typeof e&&"function"!==typeof e?this:e;e.position=new m.Point(0,0);e.scale=new m.Point(1,1);e.skew=new m.ObservablePoint(e.updateSkew,e,0,0);e.pivot=new m.Point(0,0);e._rotation=0;e._cx=1;e._sx=0;e._cy=0;e._sy=1;return e}h(d,a);d.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y);this._sx=Math.sin(this._rotation+this.skew._y);this._cy=-Math.sin(this._rotation-
this.skew._x);this._sy=Math.cos(this._rotation-this.skew._x)};d.prototype.updateLocalTransform=function(){var a=this.localTransform;a.a=this._cx*this.scale.x;a.b=this._sx*this.scale.x;a.c=this._cy*this.scale.y;a.d=this._sy*this.scale.y;a.tx=this.position.x-(this.pivot.x*a.a+this.pivot.y*a.c);a.ty=this.position.y-(this.pivot.x*a.b+this.pivot.y*a.d)};d.prototype.updateTransform=function(a){var b=this.localTransform;b.a=this._cx*this.scale.x;b.b=this._sx*this.scale.x;b.c=this._cy*this.scale.y;b.d=this._sy*
this.scale.y;b.tx=this.position.x-(this.pivot.x*b.a+this.pivot.y*b.c);b.ty=this.position.y-(this.pivot.x*b.b+this.pivot.y*b.d);a=a.worldTransform;var d=this.worldTransform;d.a=b.a*a.a+b.b*a.c;d.b=b.a*a.b+b.b*a.d;d.c=b.c*a.a+b.d*a.c;d.d=b.c*a.b+b.d*a.d;d.tx=b.tx*a.a+b.ty*a.c+a.tx;d.ty=b.tx*a.b+b.ty*a.d+a.ty;this._worldID++};d.prototype.setFromMatrix=function(a){a.decompose(this)};n(d,[{key:"rotation",get:function(){return this._rotation},set:function(a){this._rotation=a;this.updateSkew()}}]);return d}((a&&
a.__esModule?a:{"default":a})["default"]);f["default"]=a},{"../math":68,"./TransformBase":49}],49:[function(a,c,f){f.__esModule=!0;var h=a("../math");a=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.worldTransform=new h.Matrix;this.localTransform=new h.Matrix;this._parentID=this._worldID=0}a.prototype.updateLocalTransform=function(){};a.prototype.updateTransform=function(a){a=a.worldTransform;var g=this.worldTransform,d=this.localTransform;
g.a=d.a*a.a+d.b*a.c;g.b=d.a*a.b+d.b*a.d;g.c=d.c*a.a+d.d*a.c;g.d=d.c*a.b+d.d*a.d;g.tx=d.tx*a.a+d.ty*a.c+a.tx;g.ty=d.tx*a.b+d.ty*a.d+a.ty;this._worldID++};return a}();f["default"]=a;a.prototype.updateWorldTransform=a.prototype.updateTransform;a.IDENTITY=new a},{"../math":68}],50:[function(a,c,f){function h(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+typeof d);a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,
writable:!0,configurable:!0}});d&&(Object.setPrototypeOf?Object.setPrototypeOf(a,d):a.__proto__=d)}f.__esModule=!0;var n=function(){function a(a,e){for(var b=0;b<e.length;b++){var d=e[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(d,e,b){e&&a(d.prototype,e);b&&a(d,b);return d}}(),m=a("../math");a=a("./TransformBase");a=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");
var e;e=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");e=!e||"object"!==typeof e&&"function"!==typeof e?this:e;e.position=new m.ObservablePoint(e.onChange,e,0,0);e.scale=new m.ObservablePoint(e.onChange,e,1,1);e.pivot=new m.ObservablePoint(e.onChange,e,0,0);e.skew=new m.ObservablePoint(e.updateSkew,e,0,0);e._rotation=0;e._cx=1;e._sx=0;e._cy=0;e._sy=1;e._localID=0;e._currentLocalID=0;return e}h(d,a);d.prototype.onChange=function(){this._localID++};
d.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y);this._sx=Math.sin(this._rotation+this.skew._y);this._cy=-Math.sin(this._rotation-this.skew._x);this._sy=Math.cos(this._rotation-this.skew._x);this._localID++};d.prototype.updateLocalTransform=function(){var a=this.localTransform;this._localID!==this._currentLocalID&&(a.a=this._cx*this.scale._x,a.b=this._sx*this.scale._x,a.c=this._cy*this.scale._y,a.d=this._sy*this.scale._y,a.tx=this.position._x-(this.pivot._x*a.a+this.pivot._y*
a.c),a.ty=this.position._y-(this.pivot._x*a.b+this.pivot._y*a.d),this._currentLocalID=this._localID,this._parentID=-1)};d.prototype.updateTransform=function(a){var b=this.localTransform;this._localID!==this._currentLocalID&&(b.a=this._cx*this.scale._x,b.b=this._sx*this.scale._x,b.c=this._cy*this.scale._y,b.d=this._sy*this.scale._y,b.tx=this.position._x-(this.pivot._x*b.a+this.pivot._y*b.c),b.ty=this.position._y-(this.pivot._x*b.b+this.pivot._y*b.d),this._currentLocalID=this._localID,this._parentID=
-1);if(this._parentID!==a._worldID){var d=a.worldTransform,e=this.worldTransform;e.a=b.a*d.a+b.b*d.c;e.b=b.a*d.b+b.b*d.d;e.c=b.c*d.a+b.d*d.c;e.d=b.c*d.b+b.d*d.d;e.tx=b.tx*d.a+b.ty*d.c+d.tx;e.ty=b.tx*d.b+b.ty*d.d+d.ty;this._parentID=a._worldID;this._worldID++}};d.prototype.setFromMatrix=function(a){a.decompose(this);this._localID++};n(d,[{key:"rotation",get:function(){return this._rotation},set:function(a){this._rotation=a;this.updateSkew()}}]);return d}((a&&a.__esModule?a:{"default":a})["default"]);
f["default"]=a},{"../math":68,"./TransformBase":49}],51:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}function n(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;c=a("../display/Container");c=h(c);var m=a("../textures/RenderTexture"),
g=h(m),m=a("../textures/Texture"),d=h(m),m=a("./GraphicsData"),e=h(m),m=a("../sprites/Sprite"),b=h(m),p=a("../math"),r=a("../utils"),q=a("../const"),m=a("../display/Bounds"),y=h(m),m=a("./utils/bezierCurveTo"),x=h(m);a=a("../renderers/canvas/CanvasRenderer");var v=h(a),u=void 0,t=new p.Matrix,z=new p.Point,w=new Float32Array(4),A=new Float32Array(4);a=function(a){function m(){if(!(this instanceof m))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
b=!b||"object"!==typeof b&&"function"!==typeof b?this:b;b.fillAlpha=1;b.lineWidth=0;b.lineColor=0;b.graphicsData=[];b.tint=16777215;b._prevTint=16777215;b.blendMode=q.BLEND_MODES.NORMAL;b.currentPath=null;b._webGL={};b.isMask=!1;b.boundsPadding=0;b._localBounds=new y["default"];b.dirty=0;b.fastRectDirty=-1;b.clearDirty=0;b.boundsDirty=-1;b.cachedSpriteDirty=!1;b._spriteRect=null;b._fastRect=!1;return b}n(m,a);m.prototype.clone=function(){var a=new m;a.renderable=this.renderable;a.fillAlpha=this.fillAlpha;
a.lineWidth=this.lineWidth;a.lineColor=this.lineColor;a.tint=this.tint;a.blendMode=this.blendMode;a.isMask=this.isMask;a.boundsPadding=this.boundsPadding;a.dirty=0;a.cachedSpriteDirty=this.cachedSpriteDirty;for(var b=0;b<this.graphicsData.length;++b)a.graphicsData.push(this.graphicsData[b].clone());a.currentPath=a.graphicsData[a.graphicsData.length-1];a.updateLocalBounds();return a};m.prototype.lineStyle=function(){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,b=2<arguments.length&&
void 0!==arguments[2]?arguments[2]:1;this.lineWidth=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.lineColor=a;this.lineAlpha=b;this.currentPath&&(this.currentPath.shape.points.length?(a=new p.Polygon(this.currentPath.shape.points.slice(-2)),a.closed=!1,this.drawShape(a)):(this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha));return this};m.prototype.moveTo=function(a,b){var d=new p.Polygon([a,b]);d.closed=!1;
this.drawShape(d);return this};m.prototype.lineTo=function(a,b){this.currentPath.shape.points.push(a,b);this.dirty++;return this};m.prototype.quadraticCurveTo=function(a,b,d,e){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var g=this.currentPath.shape.points,p,m;0===g.length&&this.moveTo(0,0);for(var c=g[g.length-2],f=g[g.length-1],q=1;20>=q;++q){var h=q/20;p=c+(a-c)*h;m=f+(b-f)*h;g.push(p+(a+(d-a)*h-p)*h,m+(b+(e-b)*h-m)*h)}this.dirty++;
return this};m.prototype.bezierCurveTo=function(a,b,d,e,g,p){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var m=this.currentPath.shape.points,c=m[m.length-2],f=m[m.length-1];m.length-=2;(0,x["default"])(c,f,a,b,d,e,g,p,m);this.dirty++;return this};m.prototype.arcTo=function(a,b,d,e,g){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(a,b):this.moveTo(a,b);var m=this.currentPath.shape.points,
p=m[m.length-1]-b,c=m[m.length-2]-a;e-=b;d-=a;var f=Math.abs(p*d-c*e);if(1E-8>f||0===g)m[m.length-2]===a&&m[m.length-1]===b||m.push(a,b);else{var q=p*p+c*c,h=e*e+d*d,n=p*e+c*d,m=g*Math.sqrt(q)/f,f=g*Math.sqrt(h)/f,q=m*n/q,h=f*n/h,n=m*d+f*c,r=m*e+f*p;this.arc(n+a,r+b,g,Math.atan2(p*(f+q)-r,c*(f+q)-n),Math.atan2(e*(m+h)-r,d*(m+h)-n),c*e>d*p)}this.dirty++;return this};m.prototype.arc=function(a,b,d,e,g){var m=5<arguments.length&&void 0!==arguments[5]?arguments[5]:!1;if(e===g)return this;!m&&g<=e?g+=
2*Math.PI:m&&e<=g&&(e+=2*Math.PI);var p=g-e,c=40*Math.ceil(Math.abs(p)/(2*Math.PI));if(0===p)return this;var f=a+Math.cos(e)*d,q=b+Math.sin(e)*d;(m=this.currentPath?this.currentPath.shape.points:null)?m[m.length-2]===f&&m[m.length-1]===q||m.push(f,q):(this.moveTo(f,q),m=this.currentPath.shape.points);for(var p=p/(2*c),f=2*p,q=Math.cos(p),h=Math.sin(p),c=c-1,n=c%1/c,r=0;r<=c;++r){var y=p+e+f*(r+n*r),x=Math.cos(y),y=-Math.sin(y);m.push((q*x+h*y)*d+a,(q*-y+h*x)*d+b)}this.dirty++;return this};m.prototype.beginFill=
function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;this.filling=!0;this.fillColor=a;this.fillAlpha=b;this.currentPath&&2>=this.currentPath.shape.points.length&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha);return this};m.prototype.endFill=function(){this.filling=!1;this.fillColor=null;this.fillAlpha=1;return this};m.prototype.drawRect=function(a,
b,d,e){this.drawShape(new p.Rectangle(a,b,d,e));return this};m.prototype.drawRoundedRect=function(a,b,d,e,g){this.drawShape(new p.RoundedRectangle(a,b,d,e,g));return this};m.prototype.drawCircle=function(a,b,d){this.drawShape(new p.Circle(a,b,d));return this};m.prototype.drawEllipse=function(a,b,d,e){this.drawShape(new p.Ellipse(a,b,d,e));return this};m.prototype.drawPolygon=function(a){var b=a,d=!0;b instanceof p.Polygon&&(d=b.closed,b=b.points);if(!Array.isArray(b))for(var b=Array(arguments.length),
e=0;e<b.length;++e)b[e]=arguments[e];b=new p.Polygon(b);b.closed=d;this.drawShape(b);return this};m.prototype.clear=function(){if(this.lineWidth||this.filling||0<this.graphicsData.length)this.lineWidth=0,this.filling=!1,this.boundsDirty=-1,this.dirty++,this.clearDirty++,this.graphicsData.length=0;this._spriteRect=this.currentPath=null;return this};m.prototype.isFastRect=function(){return 1===this.graphicsData.length&&this.graphicsData[0].shape.type===q.SHAPES.RECT&&!this.graphicsData[0].lineWidth};
m.prototype._renderWebGL=function(a){this.dirty!==this.fastRectDirty&&(this.fastRectDirty=this.dirty,this._fastRect=this.isFastRect());this._fastRect?this._renderSpriteRect(a):(a.setObjectRenderer(a.plugins.graphics),a.plugins.graphics.render(this))};m.prototype._renderSpriteRect=function(a){var e=this.graphicsData[0].shape;if(!this._spriteRect){if(!m._SPRITE_TEXTURE){m._SPRITE_TEXTURE=g["default"].create(10,10);var p=document.createElement("canvas");p.width=10;p.height=10;var c=p.getContext("2d");
c.fillStyle="white";c.fillRect(0,0,10,10);m._SPRITE_TEXTURE=d["default"].fromCanvas(p)}this._spriteRect=new b["default"](m._SPRITE_TEXTURE)}16777215===this.tint?this._spriteRect.tint=this.graphicsData[0].fillColor:((0,r.hex2rgb)(this.graphicsData[0].fillColor,w),(0,r.hex2rgb)(this.tint,A),w[0]*=A[0],w[1]*=A[1],w[2]*=A[2],this._spriteRect.tint=(0,r.rgb2hex)(w));this._spriteRect.alpha=this.graphicsData[0].fillAlpha;this._spriteRect.worldAlpha=this.worldAlpha*this._spriteRect.alpha;m._SPRITE_TEXTURE._frame.width=
e.width;m._SPRITE_TEXTURE._frame.height=e.height;this._spriteRect.transform.worldTransform=this.transform.worldTransform;this._spriteRect.anchor.set(-e.x/e.width,-e.y/e.height);this._spriteRect._onAnchorUpdate();this._spriteRect._renderWebGL(a)};m.prototype._renderCanvas=function(a){!0!==this.isMask&&a.plugins.graphics.render(this)};m.prototype._calculateBounds=function(){this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.updateLocalBounds(),this.cachedSpriteDirty=!0);var a=this._localBounds;
this._bounds.addFrame(this.transform,a.minX,a.minY,a.maxX,a.maxY)};m.prototype.containsPoint=function(a){this.worldTransform.applyInverse(a,z);a=this.graphicsData;for(var b=0;b<a.length;++b){var d=a[b];if(d.fill&&d.shape&&d.shape.contains(z.x,z.y))return!0}return!1};m.prototype.updateLocalBounds=function(){var a=Infinity,b=-Infinity,d=Infinity,e=-Infinity;if(this.graphicsData.length)for(var g,m,p,c,f,h=0;h<this.graphicsData.length;h++){g=this.graphicsData[h];p=g.type;var n=g.lineWidth;g=g.shape;if(p===
q.SHAPES.RECT||p===q.SHAPES.RREC)m=g.x-n/2,p=g.y-n/2,c=g.width+n,f=g.height+n,a=m<a?m:a,b=m+c>b?m+c:b,d=p<d?p:d,e=p+f>e?p+f:e;else if(p===q.SHAPES.CIRC)m=g.x,p=g.y,c=g.radius+n/2,f=g.radius+n/2,a=m-c<a?m-c:a,b=m+c>b?m+c:b,d=p-f<d?p-f:d,e=p+f>e?p+f:e;else if(p===q.SHAPES.ELIP)m=g.x,p=g.y,c=g.width+n/2,f=g.height+n/2,a=m-c<a?m-c:a,b=m+c>b?m+c:b,d=p-f<d?p-f:d,e=p+f>e?p+f:e;else{g=g.points;for(var r,y,x,u,t,v=0;v+2<g.length;v+=2)m=g[v],p=g[v+1],r=g[v+2],y=g[v+3],x=Math.abs(r-m),u=Math.abs(y-p),f=n,c=
Math.sqrt(x*x+u*u),1E-9>c||(t=(f/c*u+x)/2,c=(f/c*x+u)/2,m=(r+m)/2,p=(y+p)/2,a=m-t<a?m-t:a,b=m+t>b?m+t:b,d=p-c<d?p-c:d,e=p+c>e?p+c:e)}}else e=d=b=a=0;h=this.boundsPadding;this._localBounds.minX=a-h;this._localBounds.maxX=b+2*h;this._localBounds.minY=d-h;this._localBounds.maxY=e+2*h};m.prototype.drawShape=function(a){this.currentPath&&2>=this.currentPath.shape.points.length&&this.graphicsData.pop();this.currentPath=null;a=new e["default"](this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,
this.fillAlpha,this.filling,a);this.graphicsData.push(a);a.type===q.SHAPES.POLY&&(a.shape.closed=a.shape.closed||this.filling,this.currentPath=a);this.dirty++;return a};m.prototype.generateCanvasTexture=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,e=this.getLocalBounds(),m=g["default"].create(e.width,e.height,a,b);u||(u=new v["default"]);t.tx=-e.x;t.ty=-e.y;u.render(this,m,!1,t);e=d["default"].fromCanvas(m.baseTexture._canvasRenderTarget.canvas,a);e.baseTexture.resolution=
b;e.baseTexture.update();return e};m.prototype.closePath=function(){var a=this.currentPath;a&&a.shape&&a.shape.close();return this};m.prototype.addHole=function(){var a=this.graphicsData.pop();this.currentPath=this.graphicsData[this.graphicsData.length-1];this.currentPath.addHole(a.shape);this.currentPath=null;return this};m.prototype.destroy=function(b){a.prototype.destroy.call(this,b);for(b=0;b<this.graphicsData.length;++b)this.graphicsData[b].destroy();for(var d in this._webgl)for(b=0;b<this._webgl[d].data.length;++b)this._webgl[d].data[b].destroy();
this._spriteRect&&this._spriteRect.destroy();this._localBounds=this._webgl=this.currentPath=this.graphicsData=null};return m}(c["default"]);f["default"]=a;a._SPRITE_TEXTURE=null},{"../const":44,"../display/Bounds":45,"../display/Container":46,"../math":68,"../renderers/canvas/CanvasRenderer":75,"../sprites/Sprite":100,"../textures/RenderTexture":110,"../textures/Texture":111,"../utils":119,"./GraphicsData":52,"./utils/bezierCurveTo":54}],52:[function(a,c,f){f.__esModule=!0;a=function(){function a(c,
m,g,d,e,b,p){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.lineWidth=c;this.lineColor=m;this.lineAlpha=g;this._lineTint=m;this.fillColor=d;this.fillAlpha=e;this._fillTint=d;this.fill=b;this.holes=[];this.shape=p;this.type=p.type}a.prototype.clone=function(){return new a(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)};a.prototype.addHole=function(a){this.holes.push(a)};a.prototype.destroy=function(){this.holes=
this.shape=null};return a}();f["default"]=a},{}],53:[function(a,c,f){f.__esModule=!0;c=(c=a("../../renderers/canvas/CanvasRenderer"))&&c.__esModule?c:{"default":c};var h=a("../../const");a=function(){function a(m){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=m}a.prototype.render=function(a){var g=this.renderer,d=g.context,e=a.worldAlpha,b=a.transform.worldTransform,p=g.resolution;this._prevTint!==this.tint&&(this.dirty=!0);d.setTransform(b.a*p,b.b*
p,b.c*p,b.d*p,b.tx*p,b.ty*p);a.dirty&&(this.updateGraphicsTint(a),a.dirty=!1);g.setBlendMode(a.blendMode);for(g=0;g<a.graphicsData.length;g++){var b=a.graphicsData[g],m=b.shape,p=b._fillTint,c=b._lineTint;d.lineWidth=b.lineWidth;if(b.type===h.SHAPES.POLY){d.beginPath();this.renderPolygon(m.points,m.closed,d);for(var f=0;f<b.holes.length;f++)this.renderPolygon(b.holes[f].points,!0,d);b.fill&&(d.globalAlpha=b.fillAlpha*e,d.fillStyle="#"+("00000"+(p|0).toString(16)).substr(-6),d.fill());b.lineWidth&&
(d.globalAlpha=b.lineAlpha*e,d.strokeStyle="#"+("00000"+(c|0).toString(16)).substr(-6),d.stroke())}else if(b.type===h.SHAPES.RECT){if(b.fillColor||0===b.fillColor)d.globalAlpha=b.fillAlpha*e,d.fillStyle="#"+("00000"+(p|0).toString(16)).substr(-6),d.fillRect(m.x,m.y,m.width,m.height);b.lineWidth&&(d.globalAlpha=b.lineAlpha*e,d.strokeStyle="#"+("00000"+(c|0).toString(16)).substr(-6),d.strokeRect(m.x,m.y,m.width,m.height))}else if(b.type===h.SHAPES.CIRC)d.beginPath(),d.arc(m.x,m.y,m.radius,0,2*Math.PI),
d.closePath(),b.fill&&(d.globalAlpha=b.fillAlpha*e,d.fillStyle="#"+("00000"+(p|0).toString(16)).substr(-6),d.fill()),b.lineWidth&&(d.globalAlpha=b.lineAlpha*e,d.strokeStyle="#"+("00000"+(c|0).toString(16)).substr(-6),d.stroke());else if(b.type===h.SHAPES.ELIP){var n=2*m.width,v=2*m.height,f=m.x-n/2,m=m.y-v/2;d.beginPath();var u=n/2*.5522848,t=v/2*.5522848,z=f+n,w=m+v,n=f+n/2,v=m+v/2;d.moveTo(f,v);d.bezierCurveTo(f,v-t,n-u,m,n,m);d.bezierCurveTo(n+u,m,z,v-t,z,v);d.bezierCurveTo(z,v+t,n+u,w,n,w);d.bezierCurveTo(n-
u,w,f,v+t,f,v);d.closePath();b.fill&&(d.globalAlpha=b.fillAlpha*e,d.fillStyle="#"+("00000"+(p|0).toString(16)).substr(-6),d.fill());b.lineWidth&&(d.globalAlpha=b.lineAlpha*e,d.strokeStyle="#"+("00000"+(c|0).toString(16)).substr(-6),d.stroke())}else if(b.type===h.SHAPES.RREC){f=m.x;v=m.y;u=m.width;t=m.height;m=m.radius;z=Math.min(u,t)/2|0;m=m>z?z:m;d.beginPath();d.moveTo(f,v+m);d.lineTo(f,v+t-m);d.quadraticCurveTo(f,v+t,f+m,v+t);d.lineTo(f+u-m,v+t);d.quadraticCurveTo(f+u,v+t,f+u,v+t-m);d.lineTo(f+
u,v+m);d.quadraticCurveTo(f+u,v,f+u-m,v);d.lineTo(f+m,v);d.quadraticCurveTo(f,v,f,v+m);d.closePath();if(b.fillColor||0===b.fillColor)d.globalAlpha=b.fillAlpha*e,d.fillStyle="#"+("00000"+(p|0).toString(16)).substr(-6),d.fill();b.lineWidth&&(d.globalAlpha=b.lineAlpha*e,d.strokeStyle="#"+("00000"+(c|0).toString(16)).substr(-6),d.stroke())}}};a.prototype.updateGraphicsTint=function(a){a._prevTint=a.tint;for(var g=(a.tint>>16&255)/255,d=(a.tint>>8&255)/255,e=(a.tint&255)/255,b=0;b<a.graphicsData.length;++b){var m=
a.graphicsData[b],c=m.fillColor|0,f=m.lineColor|0;m._fillTint=((c>>16&255)/255*g*255<<16)+((c>>8&255)/255*d*255<<8)+(c&255)/255*e*255;m._lineTint=((f>>16&255)/255*g*255<<16)+((f>>8&255)/255*d*255<<8)+(f&255)/255*e*255}};a.prototype.renderPolygon=function(a,g,d){d.moveTo(a[0],a[1]);for(var e=1;e<a.length/2;++e)d.lineTo(a[2*e],a[2*e+1]);g&&d.closePath()};a.prototype.destroy=function(){this.renderer=null};return a}();f["default"]=a;c["default"].registerPlugin("graphics",a)},{"../../const":44,"../../renderers/canvas/CanvasRenderer":75}],
54:[function(a,c,f){f.__esModule=!0;f["default"]=function(a,c,m,g,d,e,b,p){var f=8<arguments.length&&void 0!==arguments[8]?arguments[8]:[],q,h,n,v,u;f.push(a,c);for(var t=1,z;20>=t;++t)z=t/20,q=1-z,h=q*q,n=h*q,v=z*z,u=v*z,f.push(n*a+3*h*z*m+3*q*v*d+u*b,n*c+3*h*z*g+3*q*v*e+u*p);return f}},{}],55:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}function n(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);
a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;var m=a("../../utils"),g=a("../../const");c=a("../../renderers/webgl/utils/ObjectRenderer");var d=h(c);c=a("../../renderers/webgl/WebGLRenderer");c=h(c);var e=a("./WebGLGraphicsData"),b=h(e),e=a("./shaders/PrimitiveShader"),p=h(e),e=a("./utils/buildPoly"),r=h(e),e=a("./utils/buildRectangle"),q=h(e),e=a("./utils/buildRoundedRectangle"),
y=h(e);a=a("./utils/buildCircle");var x=h(a);a=function(a){function e(b){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var d;d=a.call(this,b);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");d=!d||"object"!==typeof d&&"function"!==typeof d?this:d;d.graphicsDataPool=[];d.primitiveShader=null;d.gl=b.gl;d.CONTEXT_UID=0;return d}n(e,a);e.prototype.onContextChange=function(){this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID;
this.primitiveShader=new p["default"](this.gl)};e.prototype.destroy=function(){d["default"].prototype.destroy.call(this);for(var a=0;a<this.graphicsDataPool.length;++a)this.graphicsDataPool[a].destroy();this.graphicsDataPool=null};e.prototype.render=function(a){var b=this.renderer,d=b.gl,e,g=a._webGL[this.CONTEXT_UID];g&&a.dirty===g.dirty||(this.updateGraphics(a),g=a._webGL[this.CONTEXT_UID]);b.bindShader(this.primitiveShader);b.state.setBlendMode(a.blendMode);for(var p=0,c=g.data.length;p<c;p++){e=
g.data[p];var f=e.shader;b.bindShader(f);f.uniforms.translationMatrix=a.transform.worldTransform.toArray(!0);f.uniforms.tint=(0,m.hex2rgb)(a.tint);f.uniforms.alpha=a.worldAlpha;b.bindVao(e.vao);e.vao.draw(d.TRIANGLE_STRIP,e.indices.length)}};e.prototype.updateGraphics=function(a){var b=this.renderer.gl,d=a._webGL[this.CONTEXT_UID];d||(d=a._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:b,clearDirty:-1,dirty:-1});d.dirty=a.dirty;if(a.clearDirty!==d.clearDirty){d.clearDirty=a.clearDirty;for(b=0;b<
d.data.length;b++)this.graphicsDataPool.push(d.data[b]);d.data.length=0;d.lastIndex=0}for(var e=d.lastIndex;e<a.graphicsData.length;e++){var m=a.graphicsData[e],b=this.getWebGLData(d,0);m.type===g.SHAPES.POLY&&(0,r["default"])(m,b);m.type===g.SHAPES.RECT?(0,q["default"])(m,b):m.type===g.SHAPES.CIRC||m.type===g.SHAPES.ELIP?(0,x["default"])(m,b):m.type===g.SHAPES.RREC&&(0,y["default"])(m,b);d.lastIndex++}this.renderer.bindVao(null);for(a=0;a<d.data.length;a++)b=d.data[a],b.dirty&&b.upload()};e.prototype.getWebGLData=
function(a,d){var e=a.data[a.data.length-1];if(!e||32E4<e.points.length)e=this.graphicsDataPool.pop()||new b["default"](this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState),e.reset(d),a.data.push(e);e.dirty=!0;return e};return e}(d["default"]);f["default"]=a;c["default"].registerPlugin("graphics",a)},{"../../const":44,"../../renderers/webgl/WebGLRenderer":82,"../../renderers/webgl/utils/ObjectRenderer":92,"../../utils":119,"./WebGLGraphicsData":56,"./shaders/PrimitiveShader":57,
"./utils/buildCircle":58,"./utils/buildPoly":60,"./utils/buildRectangle":61,"./utils/buildRoundedRectangle":62}],56:[function(a,c,f){f.__esModule=!0;var h=(a=a("pixi-gl-core"))&&a.__esModule?a:{"default":a};a=function(){function a(m,g,d){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.gl=m;this.color=[0,0,0];this.points=[];this.indices=[];this.buffer=h["default"].GLBuffer.createVertexBuffer(m);this.indexBuffer=h["default"].GLBuffer.createIndexBuffer(m);this.dirty=
!0;this.glIndices=this.glPoints=null;this.shader=g;this.vao=(new h["default"].VertexArrayObject(m,d)).addIndex(this.indexBuffer).addAttribute(this.buffer,g.attributes.aVertexPosition,m.FLOAT,!1,24,0).addAttribute(this.buffer,g.attributes.aColor,m.FLOAT,!1,24,8)}a.prototype.reset=function(){this.points.length=0;this.indices.length=0};a.prototype.upload=function(){this.glPoints=new Float32Array(this.points);this.buffer.upload(this.glPoints);this.glIndices=new Uint16Array(this.indices);this.indexBuffer.upload(this.glIndices);
this.dirty=!1};a.prototype.destroy=function(){this.indices=this.points=this.color=null;this.vao.destroy();this.buffer.destroy();this.indexBuffer.destroy();this.glIndices=this.glPoints=this.indexBuffer=this.buffer=this.gl=null};return a}();f["default"]=a},{"pixi-gl-core":12}],57:[function(a,c,f){function h(a,m){if("function"!==typeof m&&null!==m)throw new TypeError("Super expression must either be null or a function, not "+typeof m);a.prototype=Object.create(m&&m.prototype,{constructor:{value:a,enumerable:!1,
writable:!0,configurable:!0}});m&&(Object.setPrototypeOf?Object.setPrototypeOf(a,m):a.__proto__=m)}f.__esModule=!0;a=a("../../../Shader");a=function(a){function m(g){if(!(this instanceof m))throw new TypeError("Cannot call a class as a function");g=a.call(this,g,"attribute vec2 aVertexPosition;\nattribute vec4 aColor;\nuniform mat3 translationMatrix;\nuniform mat3 projectionMatrix;\nuniform float alpha;\nuniform vec3 tint;\nvarying vec4 vColor;\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vColor = aColor * vec4(tint * alpha, alpha);\n}",
"varying vec4 vColor;\nvoid main(void){\n   gl_FragColor = vColor;\n}");if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!g||"object"!==typeof g&&"function"!==typeof g?this:g}h(m,a);return m}((a&&a.__esModule?a:{"default":a})["default"]);f["default"]=a},{"../../../Shader":42}],58:[function(a,c,f){f.__esModule=!0;f["default"]=function(a,d){var e=a.shape,b=e.x,g=e.y,c,f;a.type===n.SHAPES.CIRC?f=c=e.radius:(c=e.width,f=e.height);var e=Math.floor(30*
Math.sqrt(e.radius))||Math.floor(15*Math.sqrt(e.width+e.height)),y=2*Math.PI/e;if(a.fill){var x=(0,m.hex2rgb)(a.fillColor),v=a.fillAlpha,u=x[0]*v,t=x[1]*v,x=x[2]*v,z=d.points,w=d.indices,A=z.length/6;w.push(A);for(var B=0;B<e+1;B++)z.push(b,g,u,t,x,v),z.push(b+Math.sin(y*B)*c,g+Math.cos(y*B)*f,u,t,x,v),w.push(A++,A++);w.push(A-1)}if(a.lineWidth){v=a.points;a.points=[];for(u=0;u<e+1;u++)a.points.push(b+Math.sin(y*u)*c,g+Math.cos(y*u)*f);(0,h["default"])(a,d);a.points=v}};var h=(c=a("./buildLine"))&&
c.__esModule?c:{"default":c},n=a("../../../const"),m=a("../../../utils")},{"../../../const":44,"../../../utils":119,"./buildLine":59}],59:[function(a,c,f){f.__esModule=!0;f["default"]=function(a,g){var d=a.points;if(0!==d.length){var e=new h.Point(d[0],d[1]),b=new h.Point(d[d.length-2],d[d.length-1]);if(e.x===b.x&&e.y===b.y){d=d.slice();d.pop();d.pop();var b=new h.Point(d[d.length-2],d[d.length-1]),m=b.x+.5*(e.x-b.x),e=b.y+.5*(e.y-b.y);d.unshift(m,e);d.push(m,e)}var c=g.points,m=g.indices,f=d.length/
2,e=d.length,b=c.length/6,y=a.lineWidth/2,x=(0,n.hex2rgb)(a.lineColor),v=a.lineAlpha,u=x[0]*v,t=x[1]*v,x=x[2]*v,z=d[0],w=d[1],A=d[2],B=d[3],F,C,D=-(w-B),E=z-A,G,I,H=Math.sqrt(D*D+E*E),D=D/H*y,E=E/H*y;c.push(z-D,w-E,u,t,x,v);c.push(z+D,w+E,u,t,x,v);for(var N=1;N<f-1;++N){z=d[2*(N-1)];w=d[2*(N-1)+1];A=d[2*N];B=d[2*N+1];F=d[2*(N+1)];C=d[2*(N+1)+1];D=-(w-B);E=z-A;H=Math.sqrt(D*D+E*E);D/=H;E/=H;D*=y;E*=y;G=-(B-C);I=A-F;H=Math.sqrt(G*G+I*I);G/=H;I/=H;G*=y;I*=y;var H=-E+w-(-E+B),P=-D+A-(-D+z),z=(-D+z)*(-E+
B)-(-D+A)*(-E+w),w=-I+C-(-I+B),R=-G+A-(-G+F);F=(-G+F)*(-I+B)-(-G+A)*(-I+C);C=H*R-w*P;.1>Math.abs(C)?(c.push(A-D,B-E,u,t,x,v),c.push(A+D,B+E,u,t,x,v)):(P=(P*F-R*z)/C,H=(w*z-H*F)/C,(P-A)*(P-A)+(H-B)*(H-B)>196*y*y?(D-=G,E-=I,H=Math.sqrt(D*D+E*E),D/=H,E/=H,D*=y,E*=y,c.push(A-D,B-E),c.push(u,t,x,v),c.push(A+D,B+E),c.push(u,t,x,v),c.push(A-D,B-E),c.push(u,t,x,v),e++):(c.push(P,H),c.push(u,t,x,v),c.push(A-(P-A),B-(H-B)),c.push(u,t,x,v)))}z=d[2*(f-2)];w=d[2*(f-2)+1];A=d[2*(f-1)];B=d[2*(f-1)+1];D=-(w-B);E=
z-A;H=Math.sqrt(D*D+E*E);D=D/H*y;E=E/H*y;c.push(A-D,B-E);c.push(u,t,x,v);c.push(A+D,B+E);c.push(u,t,x,v);m.push(b);for(d=0;d<e;++d)m.push(b++);m.push(b-1)}};var h=a("../../../math"),n=a("../../../utils")},{"../../../math":68,"../../../utils":119}],60:[function(a,c,f){f.__esModule=!0;f["default"]=function(a,d){a.points=a.shape.points.slice();var e=a.points;if(a.fill&&6<=e.length){for(var b=[],g=a.holes,c=0;c<g.length;c++){var f=g[c];b.push(e.length/2);e=e.concat(f.points)}var g=d.points,y=d.indices,
c=e.length/2,x=(0,n.hex2rgb)(a.fillColor),f=a.fillAlpha,v=x[0]*f,u=x[1]*f,x=x[2]*f,b=(0,m["default"])(e,b,2);if(!b)return;for(var t=g.length/6,z=0;z<b.length;z+=3)y.push(b[z]+t),y.push(b[z]+t),y.push(b[z+1]+t),y.push(b[z+2]+t),y.push(b[z+2]+t);for(b=0;b<c;b++)g.push(e[2*b],e[2*b+1],v,u,x,f)}0<a.lineWidth&&(0,h["default"])(a,d)};var h=(c=a("./buildLine"))&&c.__esModule?c:{"default":c},n=a("../../../utils"),m=(a=a("earcut"))&&a.__esModule?a:{"default":a}},{"../../../utils":119,"./buildLine":59,earcut:2}],
61:[function(a,c,f){f.__esModule=!0;f["default"]=function(a,g){var d=a.shape,e=d.x,b=d.y,m=d.width,d=d.height;if(a.fill){var c=(0,n.hex2rgb)(a.fillColor),f=a.fillAlpha,y=c[0]*f,x=c[1]*f,c=c[2]*f,v=g.points,u=g.indices,t=v.length/6;v.push(e,b);v.push(y,x,c,f);v.push(e+m,b);v.push(y,x,c,f);v.push(e,b+d);v.push(y,x,c,f);v.push(e+m,b+d);v.push(y,x,c,f);u.push(t,t,t+1,t+2,t+3,t+3)}a.lineWidth&&(f=a.points,a.points=[e,b,e+m,b,e+m,b+d,e,b+d,e,b],(0,h["default"])(a,g),a.points=f)};var h=(c=a("./buildLine"))&&
c.__esModule?c:{"default":c},n=a("../../../utils")},{"../../../utils":119,"./buildLine":59}],62:[function(a,c,f){function h(a,e,b,g,m,c){for(var d=6<arguments.length&&void 0!==arguments[6]?arguments[6]:[],p,f,q,h,n=0,r;20>=n;++n)r=n/20,p=a+(b-a)*r,f=e+(g-e)*r,q=b+(m-b)*r,h=g+(c-g)*r,p+=(q-p)*r,f+=(h-f)*r,d.push(p,f);return d}f.__esModule=!0;f["default"]=function(a,e){var b=a.shape,d=b.x,c=b.y,f=b.width,y=b.height,x=b.radius,b=[];b.push(d,c+x);h(d,c+y-x,d,c+y,d+x,c+y,b);h(d+f-x,c+y,d+f,c+y,d+f,c+y-
x,b);h(d+f,c+x,d+f,c,d+f-x,c,b);h(d+x,c,d,c,d,c+x+1E-10,b);if(a.fill){for(var y=(0,g.hex2rgb)(a.fillColor),d=a.fillAlpha,c=y[0]*d,f=y[1]*d,y=y[2]*d,x=e.points,v=e.indices,u=x.length/6,t=(0,n["default"])(b,null,2),z=0,w=t.length;z<w;z+=3)v.push(t[z]+u),v.push(t[z]+u),v.push(t[z+1]+u),v.push(t[z+2]+u),v.push(t[z+2]+u);v=0;for(u=b.length;v<u;v++)x.push(b[v],b[++v],c,f,y,d)}a.lineWidth&&(d=a.points,a.points=b,(0,m["default"])(a,e),a.points=d)};var n=(c=a("earcut"))&&c.__esModule?c:{"default":c},m=(c=
a("./buildLine"))&&c.__esModule?c:{"default":c},g=a("../../../utils")},{"../../../utils":119,"./buildLine":59,earcut:2}],63:[function(a,c,f){function h(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}function n(a){return a&&a.__esModule?a:{"default":a}}f.__esModule=!0;f.autoDetectRenderer=f.Application=f.Filter=f.SpriteMaskFilter=f.Quad=f.RenderTarget=f.ObjectRenderer=f.WebGLManager=f.Shader=f.CanvasRenderTarget=
f.TextureUvs=f.VideoBaseTexture=f.BaseRenderTexture=f.RenderTexture=f.BaseTexture=f.Texture=f.CanvasGraphicsRenderer=f.GraphicsRenderer=f.GraphicsData=f.Graphics=f.TextStyle=f.Text=f.SpriteRenderer=f.CanvasTinter=f.CanvasSpriteRenderer=f.Sprite=f.TransformBase=f.TransformStatic=f.Transform=f.Container=f.DisplayObject=f.Bounds=f.glCore=f.WebGLRenderer=f.CanvasRenderer=f.ticker=f.utils=f.settings=void 0;var m=a("./const");Object.keys(m).forEach(function(a){"default"!==a&&"__esModule"!==a&&Object.defineProperty(f,
a,{enumerable:!0,get:function(){return m[a]}})});var g=a("./math");Object.keys(g).forEach(function(a){"default"!==a&&"__esModule"!==a&&Object.defineProperty(f,a,{enumerable:!0,get:function(){return g[a]}})});var d=a("pixi-gl-core");Object.defineProperty(f,"glCore",{enumerable:!0,get:function(){return n(d)["default"]}});var e=a("./display/Bounds");Object.defineProperty(f,"Bounds",{enumerable:!0,get:function(){return n(e)["default"]}});var b=a("./display/DisplayObject");Object.defineProperty(f,"DisplayObject",
{enumerable:!0,get:function(){return n(b)["default"]}});var p=a("./display/Container");Object.defineProperty(f,"Container",{enumerable:!0,get:function(){return n(p)["default"]}});var r=a("./display/Transform");Object.defineProperty(f,"Transform",{enumerable:!0,get:function(){return n(r)["default"]}});var q=a("./display/TransformStatic");Object.defineProperty(f,"TransformStatic",{enumerable:!0,get:function(){return n(q)["default"]}});var y=a("./display/TransformBase");Object.defineProperty(f,"TransformBase",
{enumerable:!0,get:function(){return n(y)["default"]}});var x=a("./sprites/Sprite");Object.defineProperty(f,"Sprite",{enumerable:!0,get:function(){return n(x)["default"]}});var v=a("./sprites/canvas/CanvasSpriteRenderer");Object.defineProperty(f,"CanvasSpriteRenderer",{enumerable:!0,get:function(){return n(v)["default"]}});var u=a("./sprites/canvas/CanvasTinter");Object.defineProperty(f,"CanvasTinter",{enumerable:!0,get:function(){return n(u)["default"]}});var t=a("./sprites/webgl/SpriteRenderer");
Object.defineProperty(f,"SpriteRenderer",{enumerable:!0,get:function(){return n(t)["default"]}});var z=a("./text/Text");Object.defineProperty(f,"Text",{enumerable:!0,get:function(){return n(z)["default"]}});var w=a("./text/TextStyle");Object.defineProperty(f,"TextStyle",{enumerable:!0,get:function(){return n(w)["default"]}});var A=a("./graphics/Graphics");Object.defineProperty(f,"Graphics",{enumerable:!0,get:function(){return n(A)["default"]}});var B=a("./graphics/GraphicsData");Object.defineProperty(f,
"GraphicsData",{enumerable:!0,get:function(){return n(B)["default"]}});var F=a("./graphics/webgl/GraphicsRenderer");Object.defineProperty(f,"GraphicsRenderer",{enumerable:!0,get:function(){return n(F)["default"]}});var C=a("./graphics/canvas/CanvasGraphicsRenderer");Object.defineProperty(f,"CanvasGraphicsRenderer",{enumerable:!0,get:function(){return n(C)["default"]}});var D=a("./textures/Texture");Object.defineProperty(f,"Texture",{enumerable:!0,get:function(){return n(D)["default"]}});var E=a("./textures/BaseTexture");
Object.defineProperty(f,"BaseTexture",{enumerable:!0,get:function(){return n(E)["default"]}});var G=a("./textures/RenderTexture");Object.defineProperty(f,"RenderTexture",{enumerable:!0,get:function(){return n(G)["default"]}});var I=a("./textures/BaseRenderTexture");Object.defineProperty(f,"BaseRenderTexture",{enumerable:!0,get:function(){return n(I)["default"]}});var H=a("./textures/VideoBaseTexture");Object.defineProperty(f,"VideoBaseTexture",{enumerable:!0,get:function(){return n(H)["default"]}});
var N=a("./textures/TextureUvs");Object.defineProperty(f,"TextureUvs",{enumerable:!0,get:function(){return n(N)["default"]}});var P=a("./renderers/canvas/utils/CanvasRenderTarget");Object.defineProperty(f,"CanvasRenderTarget",{enumerable:!0,get:function(){return n(P)["default"]}});var R=a("./Shader");Object.defineProperty(f,"Shader",{enumerable:!0,get:function(){return n(R)["default"]}});var S=a("./renderers/webgl/managers/WebGLManager");Object.defineProperty(f,"WebGLManager",{enumerable:!0,get:function(){return n(S)["default"]}});
var M=a("./renderers/webgl/utils/ObjectRenderer");Object.defineProperty(f,"ObjectRenderer",{enumerable:!0,get:function(){return n(M)["default"]}});var J=a("./renderers/webgl/utils/RenderTarget");Object.defineProperty(f,"RenderTarget",{enumerable:!0,get:function(){return n(J)["default"]}});var O=a("./renderers/webgl/utils/Quad");Object.defineProperty(f,"Quad",{enumerable:!0,get:function(){return n(O)["default"]}});var T=a("./renderers/webgl/filters/spriteMask/SpriteMaskFilter");Object.defineProperty(f,
"SpriteMaskFilter",{enumerable:!0,get:function(){return n(T)["default"]}});var K=a("./renderers/webgl/filters/Filter");Object.defineProperty(f,"Filter",{enumerable:!0,get:function(){return n(K)["default"]}});var Q=a("./Application");Object.defineProperty(f,"Application",{enumerable:!0,get:function(){return n(Q)["default"]}});var L=a("./autoDetectRenderer");Object.defineProperty(f,"autoDetectRenderer",{enumerable:!0,get:function(){return L.autoDetectRenderer}});c=a("./utils");c=h(c);var U=a("./ticker"),
U=h(U),V=a("./settings"),V=n(V),W=a("./renderers/canvas/CanvasRenderer"),W=n(W);a=a("./renderers/webgl/WebGLRenderer");a=n(a);f.settings=V["default"];f.utils=c;f.ticker=U;f.CanvasRenderer=W["default"];f.WebGLRenderer=a["default"]},{"./Application":41,"./Shader":42,"./autoDetectRenderer":43,"./const":44,"./display/Bounds":45,"./display/Container":46,"./display/DisplayObject":47,"./display/Transform":48,"./display/TransformBase":49,"./display/TransformStatic":50,"./graphics/Graphics":51,"./graphics/GraphicsData":52,
"./graphics/canvas/CanvasGraphicsRenderer":53,"./graphics/webgl/GraphicsRenderer":55,"./math":68,"./renderers/canvas/CanvasRenderer":75,"./renderers/canvas/utils/CanvasRenderTarget":77,"./renderers/webgl/WebGLRenderer":82,"./renderers/webgl/filters/Filter":84,"./renderers/webgl/filters/spriteMask/SpriteMaskFilter":87,"./renderers/webgl/managers/WebGLManager":91,"./renderers/webgl/utils/ObjectRenderer":92,"./renderers/webgl/utils/Quad":93,"./renderers/webgl/utils/RenderTarget":94,"./settings":99,"./sprites/Sprite":100,
"./sprites/canvas/CanvasSpriteRenderer":101,"./sprites/canvas/CanvasTinter":102,"./sprites/webgl/SpriteRenderer":104,"./text/Text":106,"./text/TextStyle":107,"./textures/BaseRenderTexture":108,"./textures/BaseTexture":109,"./textures/RenderTexture":110,"./textures/Texture":111,"./textures/TextureUvs":112,"./textures/VideoBaseTexture":113,"./ticker":115,"./utils":119,"pixi-gl-core":12}],64:[function(a,c,f){function h(a){return 0>a?-1:0<a?1:0}f.__esModule=!0;var n=(a=a("./Matrix"))&&a.__esModule?a:
{"default":a},m=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],g=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],d=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],e=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],b=[],p=[];(function(){for(var a=0;16>a;a++){var c=[];p.push(c);for(var f=0;16>f;f++)for(var r=h(m[a]*m[f]+d[a]*g[f]),u=h(g[a]*m[f]+e[a]*g[f]),t=h(m[a]*d[f]+d[a]*e[f]),z=h(g[a]*d[f]+e[a]*e[f]),w=0;16>w;w++)if(m[w]===r&&g[w]===u&&d[w]===t&&e[w]===z){c.push(w);break}}for(a=0;16>a;a++)c=new n["default"],c.set(m[a],g[a],d[a],
e[a],0,0),b.push(c)})();var r={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(a){return m[a]},uY:function(a){return g[a]},vX:function(a){return d[a]},vY:function(a){return e[a]},inv:function(a){return a&8?a&15:-a&7},add:function(a,b){return p[a][b]},sub:function(a,b){return p[a][r.inv(b)]},rotate180:function(a){return a^4},isSwapWidthHeight:function(a){return 2===(a&3)},byDirection:function(a,b){return 2*Math.abs(a)<=Math.abs(b)?0<=b?r.S:r.N:2*Math.abs(b)<=
Math.abs(a)?0<a?r.E:r.W:0<b?0<a?r.SE:r.SW:0<a?r.NE:r.NW},matrixAppendRotationInv:function(a,d){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,g=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,m=b[r.inv(d)];m.tx=e;m.ty=g;a.append(m)}};f["default"]=r},{"./Matrix":65}],65:[function(a,c,f){f.__esModule=!0;var h=function(){function a(a,d){for(var e=0;e<d.length;e++){var b=d[e];b.enumerable=b.enumerable||!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(a,
b.key,b)}}return function(g,d,e){d&&a(g.prototype,d);e&&a(g,e);return g}}(),n=(a=a("./Point"))&&a.__esModule?a:{"default":a};a=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.a=1;this.c=this.b=0;this.d=1;this.ty=this.tx=0;this.array=null}a.prototype.fromArray=function(a){this.a=a[0];this.b=a[1];this.c=a[3];this.d=a[4];this.tx=a[2];this.ty=a[5]};a.prototype.set=function(a,d,e,b,m,c){this.a=a;this.b=d;this.c=e;this.d=b;this.tx=m;this.ty=
c;return this};a.prototype.toArray=function(a,d){this.array||(this.array=new Float32Array(9));var e=d||this.array;a?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.tx,e[7]=this.ty):(e[0]=this.a,e[1]=this.c,e[2]=this.tx,e[3]=this.b,e[4]=this.d,e[5]=this.ty,e[6]=0,e[7]=0);e[8]=1;return e};a.prototype.apply=function(a,d){d=d||new n["default"];var e=a.x,b=a.y;d.x=this.a*e+this.c*b+this.tx;d.y=this.b*e+this.d*b+this.ty;return d};a.prototype.applyInverse=function(a,d){d=d||new n["default"];
var e=1/(this.a*this.d+this.c*-this.b),b=a.x,g=a.y;d.x=this.d*e*b+-this.c*e*g+(this.ty*this.c-this.tx*this.d)*e;d.y=this.a*e*g+-this.b*e*b+(-this.ty*this.a+this.tx*this.b)*e;return d};a.prototype.translate=function(a,d){this.tx+=a;this.ty+=d;return this};a.prototype.scale=function(a,d){this.a*=a;this.d*=d;this.c*=a;this.b*=d;this.tx*=a;this.ty*=d;return this};a.prototype.rotate=function(a){var d=Math.cos(a);a=Math.sin(a);var e=this.a,b=this.c,g=this.tx;this.a=e*d-this.b*a;this.b=e*a+this.b*d;this.c=
b*d-this.d*a;this.d=b*a+this.d*d;this.tx=g*d-this.ty*a;this.ty=g*a+this.ty*d;return this};a.prototype.append=function(a){var d=this.a,e=this.b,b=this.c,g=this.d;this.a=a.a*d+a.b*b;this.b=a.a*e+a.b*g;this.c=a.c*d+a.d*b;this.d=a.c*e+a.d*g;this.tx=a.tx*d+a.ty*b+this.tx;this.ty=a.tx*e+a.ty*g+this.ty;return this};a.prototype.setTransform=function(a,d,e,b,m,c,f,h,n){var g=Math.sin(f),p=Math.cos(f);f=Math.cos(n);n=Math.sin(n);var q=-Math.sin(h);h=Math.cos(h);var r=p*m;m*=g;g=-g*c;c*=p;this.a=f*r+n*g;this.b=
f*m+n*c;this.c=q*r+h*g;this.d=q*m+h*c;this.tx=a+(e*r+b*g);this.ty=d+(e*m+b*c);return this};a.prototype.prepend=function(a){var d=this.tx;if(1!==a.a||0!==a.b||0!==a.c||1!==a.d){var e=this.a,b=this.c;this.a=e*a.a+this.b*a.c;this.b=e*a.b+this.b*a.d;this.c=b*a.a+this.d*a.c;this.d=b*a.b+this.d*a.d}this.tx=d*a.a+this.ty*a.c+a.tx;this.ty=d*a.b+this.ty*a.d+a.ty;return this};a.prototype.decompose=function(a){var d=this.a,e=this.b,b=this.c,g=this.d,m=-Math.atan2(-b,g),c=Math.atan2(e,d);1E-5>Math.abs(m+c)?(a.rotation=
c,0>d&&0<=g&&(a.rotation+=0>=a.rotation?Math.PI:-Math.PI),a.skew.x=a.skew.y=0):(a.skew.x=m,a.skew.y=c);a.scale.x=Math.sqrt(d*d+e*e);a.scale.y=Math.sqrt(b*b+g*g);a.position.x=this.tx;a.position.y=this.ty;return a};a.prototype.invert=function(){var a=this.a,d=this.b,e=this.c,b=this.d,m=this.tx,c=a*b-d*e;this.a=b/c;this.b=-d/c;this.c=-e/c;this.d=a/c;this.tx=(e*this.ty-b*m)/c;this.ty=-(a*this.ty-d*m)/c;return this};a.prototype.identity=function(){this.a=1;this.c=this.b=0;this.d=1;this.ty=this.tx=0;return this};
a.prototype.clone=function(){var g=new a;g.a=this.a;g.b=this.b;g.c=this.c;g.d=this.d;g.tx=this.tx;g.ty=this.ty;return g};a.prototype.copy=function(a){a.a=this.a;a.b=this.b;a.c=this.c;a.d=this.d;a.tx=this.tx;a.ty=this.ty;return a};h(a,null,[{key:"IDENTITY",get:function(){return new a}},{key:"TEMP_MATRIX",get:function(){return new a}}]);return a}();f["default"]=a},{"./Point":67}],66:[function(a,c,f){f.__esModule=!0;var h=function(){function a(a,g){for(var d=0;d<g.length;d++){var e=g[d];e.enumerable=
e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(m,g,d){g&&a(m.prototype,g);d&&a(m,d);return m}}();a=function(){function a(m,g){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this._x=d;this._y=e;this.cb=m;this.scope=g}a.prototype.set=function(a,g){var d=a||0,e=g||(0!==g?d:0);if(this._x!==
d||this._y!==e)this._x=d,this._y=e,this.cb.call(this.scope)};a.prototype.copy=function(a){if(this._x!==a.x||this._y!==a.y)this._x=a.x,this._y=a.y,this.cb.call(this.scope)};h(a,[{key:"x",get:function(){return this._x},set:function(a){this._x!==a&&(this._x=a,this.cb.call(this.scope))}},{key:"y",get:function(){return this._y},set:function(a){this._y!==a&&(this._y=a,this.cb.call(this.scope))}}]);return a}();f["default"]=a},{}],67:[function(a,c,f){f.__esModule=!0;a=function(){function a(){var c=0<arguments.length&&
void 0!==arguments[0]?arguments[0]:0,m=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.x=c;this.y=m}a.prototype.clone=function(){return new a(this.x,this.y)};a.prototype.copy=function(a){this.set(a.x,a.y)};a.prototype.equals=function(a){return a.x===this.x&&a.y===this.y};a.prototype.set=function(a,m){this.x=a||0;this.y=m||(0!==m?this.x:0)};return a}();f["default"]=a},{}],68:[function(a,c,f){function h(a){return a&&
a.__esModule?a:{"default":a}}f.__esModule=!0;var n=a("./Point");Object.defineProperty(f,"Point",{enumerable:!0,get:function(){return h(n)["default"]}});var m=a("./ObservablePoint");Object.defineProperty(f,"ObservablePoint",{enumerable:!0,get:function(){return h(m)["default"]}});var g=a("./Matrix");Object.defineProperty(f,"Matrix",{enumerable:!0,get:function(){return h(g)["default"]}});var d=a("./GroupD8");Object.defineProperty(f,"GroupD8",{enumerable:!0,get:function(){return h(d)["default"]}});var e=
a("./shapes/Circle");Object.defineProperty(f,"Circle",{enumerable:!0,get:function(){return h(e)["default"]}});var b=a("./shapes/Ellipse");Object.defineProperty(f,"Ellipse",{enumerable:!0,get:function(){return h(b)["default"]}});var p=a("./shapes/Polygon");Object.defineProperty(f,"Polygon",{enumerable:!0,get:function(){return h(p)["default"]}});var r=a("./shapes/Rectangle");Object.defineProperty(f,"Rectangle",{enumerable:!0,get:function(){return h(r)["default"]}});var q=a("./shapes/RoundedRectangle");
Object.defineProperty(f,"RoundedRectangle",{enumerable:!0,get:function(){return h(q)["default"]}})},{"./GroupD8":64,"./Matrix":65,"./ObservablePoint":66,"./Point":67,"./shapes/Circle":69,"./shapes/Ellipse":70,"./shapes/Polygon":71,"./shapes/Rectangle":72,"./shapes/RoundedRectangle":73}],69:[function(a,c,f){f.__esModule=!0;var h=(c=a("./Rectangle"))&&c.__esModule?c:{"default":c},n=a("../../const");a=function(){function a(){var g=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,d=1<arguments.length&&
void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.x=g;this.y=d;this.radius=e;this.type=n.SHAPES.CIRC}a.prototype.clone=function(){return new a(this.x,this.y,this.radius)};a.prototype.contains=function(a,d){if(0>=this.radius)return!1;var e=this.x-a,b=this.y-d;return e*e+b*b<=this.radius*this.radius};a.prototype.getBounds=function(){return new h["default"](this.x-this.radius,
this.y-this.radius,2*this.radius,2*this.radius)};return a}();f["default"]=a},{"../../const":44,"./Rectangle":72}],70:[function(a,c,f){f.__esModule=!0;var h=(c=a("./Rectangle"))&&c.__esModule?c:{"default":c},n=a("../../const");a=function(){function a(){var g=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,b=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;if(!(this instanceof
a))throw new TypeError("Cannot call a class as a function");this.x=g;this.y=d;this.width=e;this.height=b;this.type=n.SHAPES.ELIP}a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height)};a.prototype.contains=function(a,d){if(0>=this.width||0>=this.height)return!1;var e=(a-this.x)/this.width,b=(d-this.y)/this.height;return 1>=e*e+b*b};a.prototype.getBounds=function(){return new h["default"](this.x-this.width,this.y-this.height,this.width,this.height)};return a}();f["default"]=
a},{"../../const":44,"./Rectangle":72}],71:[function(a,c,f){f.__esModule=!0;var h=(c=a("../Point"))&&c.__esModule?c:{"default":c},n=a("../../const");a=function(){function a(){for(var g=arguments.length,d=Array(g),e=0;e<g;e++)d[e]=arguments[e];if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");Array.isArray(d[0])&&(d=d[0]);if(d[0]instanceof h["default"]){for(var g=[],e=0,b=d.length;e<b;e++)g.push(d[e].x,d[e].y);d=g}this.closed=!0;this.points=d;this.type=n.SHAPES.POLY}
a.prototype.clone=function(){return new a(this.points.slice())};a.prototype.close=function(){var a=this.points;a[0]===a[a.length-2]&&a[1]===a[a.length-1]||a.push(a[0],a[1])};a.prototype.contains=function(a,d){for(var e=!1,b=this.points.length/2,g=0,m=b-1;g<b;m=g++){var c=this.points[2*g],f=this.points[2*g+1],h=this.points[2*m],m=this.points[2*m+1];f>d!==m>d&&a<(d-f)/(m-f)*(h-c)+c&&(e=!e)}return e};return a}();f["default"]=a},{"../../const":44,"../Point":67}],72:[function(a,c,f){f.__esModule=!0;var h=
function(){function a(a,d){for(var e=0;e<d.length;e++){var b=d[e];b.enumerable=b.enumerable||!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(a,b.key,b)}}return function(g,d,e){d&&a(g.prototype,d);e&&a(g,e);return g}}(),n=a("../../const");a=function(){function a(){var g=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,b=3<arguments.length&&void 0!==arguments[3]?
arguments[3]:0;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.x=g;this.y=d;this.width=e;this.height=b;this.type=n.SHAPES.RECT}a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height)};a.prototype.copy=function(a){this.x=a.x;this.y=a.y;this.width=a.width;this.height=a.height;return this};a.prototype.contains=function(a,d){return 0>=this.width||0>=this.height?!1:a>=this.x&&a<this.x+this.width&&d>=this.y&&d<this.y+this.height?!0:!1};a.prototype.pad=
function(a,d){a=a||0;d=d||(0!==d?a:0);this.x-=a;this.y-=d;this.width+=2*a;this.height+=2*d};a.prototype.fit=function(a){this.x<a.x&&(this.width+=this.x,0>this.width&&(this.width=0),this.x=a.x);this.y<a.y&&(this.height+=this.y,0>this.height&&(this.height=0),this.y=a.y);this.x+this.width>a.x+a.width&&(this.width=a.width-this.x,0>this.width&&(this.width=0));this.y+this.height>a.y+a.height&&(this.height=a.height-this.y,0>this.height&&(this.height=0))};a.prototype.enlarge=function(a){var d=Math.min(this.x,
a.x),e=Math.max(this.x+this.width,a.x+a.width),b=Math.min(this.y,a.y);a=Math.max(this.y+this.height,a.y+a.height);this.x=d;this.width=e-d;this.y=b;this.height=a-b};h(a,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}}],[{key:"EMPTY",get:function(){return new a(0,0,0,0)}}]);return a}();f["default"]=a},{"../../const":44}],73:[function(a,c,f){f.__esModule=
!0;var h=a("../../const");a=function(){function a(){var m=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,g=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,b=4<arguments.length&&void 0!==arguments[4]?arguments[4]:20;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.x=m;this.y=g;this.width=d;this.height=e;this.radius=b;this.type=
h.SHAPES.RREC}a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.radius)};a.prototype.contains=function(a,g){if(0>=this.width||0>=this.height)return!1;if(a>=this.x&&a<=this.x+this.width&&g>=this.y&&g<=this.y+this.height){if(g>=this.y+this.radius&&g<=this.y+this.height-this.radius||a>=this.x+this.radius&&a<=this.x+this.width-this.radius)return!0;var d=a-(this.x+this.radius),e=g-(this.y+this.radius),b=this.radius*this.radius;if(d*d+e*e<=b)return!0;d=a-(this.x+this.width-
this.radius);if(d*d+e*e<=b)return!0;e=g-(this.y+this.height-this.radius);if(d*d+e*e<=b)return!0;d=a-(this.x+this.radius);if(d*d+e*e<=b)return!0}return!1};return a}();f["default"]=a},{"../../const":44}],74:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}function n(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,
configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;var m=function(){function a(a,b){for(var d=0;d<b.length;d++){var e=b[d];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,d,e){d&&a(b.prototype,d);e&&a(b,e);return b}}(),g=a("../utils");c=a("../math");var d=a("../const"),e=a("../settings"),b=h(e),e=a("../display/Container"),p=h(e),e=a("../textures/RenderTexture"),r=h(e);
a=a("eventemitter3");a=h(a);var q=new c.Matrix;c=function(a){function e(m,c,f,h){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var q;q=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");q=!q||"object"!==typeof q&&"function"!==typeof q?this:q;(0,g.sayHello)(m);if(h)for(var n in b["default"].RENDER_OPTIONS)"undefined"===typeof h[n]&&(h[n]=b["default"].RENDER_OPTIONS[n]);else h=b["default"].RENDER_OPTIONS;q.type=
d.RENDERER_TYPE.UNKNOWN;q.width=c||800;q.height=f||600;q.view=h.view||document.createElement("canvas");q.resolution=h.resolution||b["default"].RESOLUTION;q.transparent=h.transparent;q.autoResize=h.autoResize||!1;q.blendModes=null;q.preserveDrawingBuffer=h.preserveDrawingBuffer;q.clearBeforeRender=h.clearBeforeRender;q.roundPixels=h.roundPixels;q._backgroundColor=0;q._backgroundColorRgba=[0,0,0,0];q._backgroundColorString="#000000";q.backgroundColor=h.backgroundColor||q._backgroundColor;q._tempDisplayObjectParent=
new p["default"];q._lastObjectRendered=q._tempDisplayObjectParent;return q}n(e,a);e.prototype.resize=function(a,b){this.width=a*this.resolution;this.height=b*this.resolution;this.view.width=this.width;this.view.height=this.height;this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")};e.prototype.generateTexture=function(a,b,d){var e=a.getLocalBounds();b=r["default"].create(e.width|0,e.height|0,b,d);q.tx=-e.x;q.ty=-e.y;this.render(a,
b,!1,q,!0);return b};e.prototype.destroy=function(a){a&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);this.type=d.RENDERER_TYPE.UNKNOWN;this.height=this.width=0;this.view=null;this.resolution=0;this.autoResize=this.transparent=!1;this.blendModes=null;this.roundPixels=this.clearBeforeRender=this.preserveDrawingBuffer=!1;this._backgroundColor=0;this._backgroundColorString=this._backgroundColorRgba=null;this.backgroundColor=0;this._lastObjectRendered=this._tempDisplayObjectParent=
null};m(e,[{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(a){this._backgroundColor=a;this._backgroundColorString=(0,g.hex2string)(a);(0,g.hex2rgb)(a,this._backgroundColorRgba)}}]);return e}(a["default"]);f["default"]=c},{"../const":44,"../display/Container":46,"../math":68,"../settings":99,"../textures/RenderTexture":110,"../utils":119,eventemitter3:3}],75:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}function n(a,b){if("function"!==typeof b&&
null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;c=a("../SystemRenderer");c=h(c);var m=a("./utils/CanvasMaskManager"),g=h(m),m=a("./utils/CanvasRenderTarget"),d=h(m),m=a("./utils/mapCanvasBlendModesToPixi"),e=h(m),m=a("../../utils"),b=a("../../const");a=a("../../settings");
var p=h(a);a=function(a){function m(d,c){var p=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(!(this instanceof m))throw new TypeError("Cannot call a class as a function");p=a.call(this,"Canvas",d,c,p);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");p=!p||"object"!==typeof p&&"function"!==typeof p?this:p;p.type=b.RENDERER_TYPE.CANVAS;p.rootContext=p.view.getContext("2d",{alpha:p.transparent});p.refresh=!0;p.maskManager=new g["default"](p);
p.smoothProperty="imageSmoothingEnabled";p.rootContext.imageSmoothingEnabled||(p.rootContext.webkitImageSmoothingEnabled?p.smoothProperty="webkitImageSmoothingEnabled":p.rootContext.mozImageSmoothingEnabled?p.smoothProperty="mozImageSmoothingEnabled":p.rootContext.oImageSmoothingEnabled?p.smoothProperty="oImageSmoothingEnabled":p.rootContext.msImageSmoothingEnabled&&(p.smoothProperty="msImageSmoothingEnabled"));p.initPlugins();p.blendModes=(0,e["default"])();p._activeBlendMode=null;p.context=null;
p.renderingToScreen=!1;p.resize(d,c);return p}n(m,a);m.prototype.render=function(a,e,g,m,p){if(this.view){this.renderingToScreen=!e;this.emit("prerender");var c=this.resolution;e?(e=e.baseTexture||e,e._canvasRenderTarget||(e._canvasRenderTarget=new d["default"](e.width,e.height,e.resolution),e.source=e._canvasRenderTarget.canvas,e.valid=!0),this.context=e._canvasRenderTarget.context,this.resolution=e._canvasRenderTarget.resolution):this.context=this.rootContext;var f=this.context;e||(this._lastObjectRendered=
a);p||(e=a.parent,p=this._tempDisplayObjectParent.transform.worldTransform,m?m.copy(p):p.identity(),a.parent=this._tempDisplayObjectParent,a.updateTransform(),a.parent=e);f.setTransform(1,0,0,1,0,0);f.globalAlpha=1;f.globalCompositeOperation=this.blendModes[b.BLEND_MODES.NORMAL];navigator.isCocoonJS&&this.view.screencanvas&&(f.fillStyle="black",f.clear());(void 0!==g?g:this.clearBeforeRender)&&this.renderingToScreen&&(this.transparent?f.clearRect(0,0,this.width,this.height):(f.fillStyle=this._backgroundColorString,
f.fillRect(0,0,this.width,this.height)));g=this.context;this.context=f;a.renderCanvas(this);this.context=g;this.resolution=c;this.emit("postrender")}};m.prototype.clear=function(a){var b=this.context;a=a||this._backgroundColorString;!this.transparent&&a?(b.fillStyle=a,b.fillRect(0,0,this.width,this.height)):b.clearRect(0,0,this.width,this.height)};m.prototype.setBlendMode=function(a){this._activeBlendMode!==a&&(this._activeBlendMode=a,this.context.globalCompositeOperation=this.blendModes[a])};m.prototype.destroy=
function(b){this.destroyPlugins();a.prototype.destroy.call(this,b);this.context=null;this.refresh=!0;this.maskManager.destroy();this.smoothProperty=this.maskManager=null};m.prototype.resize=function(d,e){a.prototype.resize.call(this,d,e);this.smoothProperty&&(this.rootContext[this.smoothProperty]=p["default"].SCALE_MODE===b.SCALE_MODES.LINEAR)};return m}(c["default"]);f["default"]=a;m.pluginTarget.mixin(a)},{"../../const":44,"../../settings":99,"../../utils":119,"../SystemRenderer":74,"./utils/CanvasMaskManager":76,
"./utils/CanvasRenderTarget":77,"./utils/mapCanvasBlendModesToPixi":79}],76:[function(a,c,f){f.__esModule=!0;var h=a("../../../const");a=function(){function a(m){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=m}a.prototype.pushMask=function(a){var g=this.renderer;g.context.save();var d=a.alpha,e=a.transform.worldTransform,b=g.resolution;g.context.setTransform(e.a*b,e.b*b,e.c*b,e.d*b,e.tx*b,e.ty*b);a._texture||(this.renderGraphicsShape(a),g.context.clip());
a.worldAlpha=d};a.prototype.renderGraphicsShape=function(a){var g=this.renderer.context,d=a.graphicsData.length;if(0!==d){g.beginPath();for(var e=0;e<d;e++){var b=a.graphicsData[e],m=b.shape;if(b.type===h.SHAPES.POLY){b=m.points;g.moveTo(b[0],b[1]);for(var c=1;c<b.length/2;c++)g.lineTo(b[2*c],b[2*c+1]);b[0]===b[b.length-2]&&b[1]===b[b.length-1]&&g.closePath()}else if(b.type===h.SHAPES.RECT)g.rect(m.x,m.y,m.width,m.height),g.closePath();else if(b.type===h.SHAPES.CIRC)g.arc(m.x,m.y,m.radius,0,2*Math.PI),
g.closePath();else if(b.type===h.SHAPES.ELIP){var f=2*m.width,c=2*m.height,b=m.x-f/2,m=m.y-c/2,n=f/2*.5522848,x=c/2*.5522848,v=b+f,u=m+c,f=b+f/2,c=m+c/2;g.moveTo(b,c);g.bezierCurveTo(b,c-x,f-n,m,f,m);g.bezierCurveTo(f+n,m,v,c-x,v,c);g.bezierCurveTo(v,c+x,f+n,u,f,u);g.bezierCurveTo(f-n,u,b,c+x,b,c);g.closePath()}else b.type===h.SHAPES.RREC&&(b=m.x,c=m.y,n=m.width,x=m.height,m=m.radius,v=Math.min(n,x)/2|0,m=m>v?v:m,g.moveTo(b,c+m),g.lineTo(b,c+x-m),g.quadraticCurveTo(b,c+x,b+m,c+x),g.lineTo(b+n-m,c+
x),g.quadraticCurveTo(b+n,c+x,b+n,c+x-m),g.lineTo(b+n,c+m),g.quadraticCurveTo(b+n,c,b+n-m,c),g.lineTo(b+m,c),g.quadraticCurveTo(b,c,b,c+m),g.closePath())}}};a.prototype.popMask=function(a){a.context.restore()};a.prototype.destroy=function(){};return a}();f["default"]=a},{"../../../const":44}],77:[function(a,c,f){f.__esModule=!0;var h=function(){function a(a,d){for(var e=0;e<d.length;e++){var b=d[e];b.enumerable=b.enumerable||!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(a,
b.key,b)}}return function(g,d,e){d&&a(g.prototype,d);e&&a(g,e);return g}}();a=a("../../../settings");var n=(a&&a.__esModule?a:{"default":a})["default"].RESOLUTION;a=function(){function a(g,d,e){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.resolution=e||n;this.resize(g,d)}a.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0);this.context.clearRect(0,0,this.canvas.width,
this.canvas.height)};a.prototype.resize=function(a,d){this.canvas.width=a*this.resolution;this.canvas.height=d*this.resolution};a.prototype.destroy=function(){this.canvas=this.context=null};h(a,[{key:"width",get:function(){return this.canvas.width},set:function(a){this.canvas.width=a}},{key:"height",get:function(){return this.canvas.height},set:function(a){this.canvas.height=a}}]);return a}();f["default"]=a},{"../../../settings":99}],78:[function(a,c,f){function h(a){var m=document.createElement("canvas");
m.width=6;m.height=1;var g=m.getContext("2d");g.fillStyle=a;g.fillRect(0,0,6,1);return m}f.__esModule=!0;f["default"]=function(){if("undefined"===typeof document)return!1;var a=h("#ff00ff"),m=h("#ffff00"),g=document.createElement("canvas");g.width=6;g.height=1;g=g.getContext("2d");g.globalCompositeOperation="multiply";g.drawImage(a,0,0);g.drawImage(m,2,0);a=g.getImageData(2,0,1,1);if(!a)return!1;a=a.data;return 255===a[0]&&0===a[1]&&0===a[2]}},{}],79:[function(a,c,f){f.__esModule=!0;f["default"]=
function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];(0,n["default"])()?(a[h.BLEND_MODES.NORMAL]="source-over",a[h.BLEND_MODES.ADD]="lighter",a[h.BLEND_MODES.MULTIPLY]="multiply",a[h.BLEND_MODES.SCREEN]="screen",a[h.BLEND_MODES.OVERLAY]="overlay",a[h.BLEND_MODES.DARKEN]="darken",a[h.BLEND_MODES.LIGHTEN]="lighten",a[h.BLEND_MODES.COLOR_DODGE]="color-dodge",a[h.BLEND_MODES.COLOR_BURN]="color-burn",a[h.BLEND_MODES.HARD_LIGHT]="hard-light",a[h.BLEND_MODES.SOFT_LIGHT]="soft-light",
a[h.BLEND_MODES.DIFFERENCE]="difference",a[h.BLEND_MODES.EXCLUSION]="exclusion",a[h.BLEND_MODES.HUE]="hue",a[h.BLEND_MODES.SATURATION]="saturate",a[h.BLEND_MODES.COLOR]="color",a[h.BLEND_MODES.LUMINOSITY]="luminosity"):(a[h.BLEND_MODES.NORMAL]="source-over",a[h.BLEND_MODES.ADD]="lighter",a[h.BLEND_MODES.MULTIPLY]="source-over",a[h.BLEND_MODES.SCREEN]="source-over",a[h.BLEND_MODES.OVERLAY]="source-over",a[h.BLEND_MODES.DARKEN]="source-over",a[h.BLEND_MODES.LIGHTEN]="source-over",a[h.BLEND_MODES.COLOR_DODGE]=
"source-over",a[h.BLEND_MODES.COLOR_BURN]="source-over",a[h.BLEND_MODES.HARD_LIGHT]="source-over",a[h.BLEND_MODES.SOFT_LIGHT]="source-over",a[h.BLEND_MODES.DIFFERENCE]="source-over",a[h.BLEND_MODES.EXCLUSION]="source-over",a[h.BLEND_MODES.HUE]="source-over",a[h.BLEND_MODES.SATURATION]="source-over",a[h.BLEND_MODES.COLOR]="source-over",a[h.BLEND_MODES.LUMINOSITY]="source-over");return a};var h=a("../../../const"),n=(a=a("./canUseNewCanvasBlendModes"))&&a.__esModule?a:{"default":a}},{"../../../const":44,
"./canUseNewCanvasBlendModes":78}],80:[function(a,c,f){f.__esModule=!0;var h=a("../../const"),n=(a=a("../../settings"))&&a.__esModule?a:{"default":a};a=function(){function a(g){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=g;this.checkCount=this.count=0;this.maxIdle=n["default"].GC_MAX_IDLE;this.checkCountMax=n["default"].GC_MAX_CHECK_COUNT;this.mode=n["default"].GC_MODE}a.prototype.update=function(){this.count++;this.mode!==h.GC_MODES.MANUAL&&(this.checkCount++,
this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run()))};a.prototype.run=function(){for(var a=this.renderer.textureManager,d=a._managedTextures,e=!1,b=0;b<d.length;b++){var c=d[b];!c._glRenderTargets&&this.count-c.touched>this.maxIdle&&(a.destroyTexture(c,!0),d[b]=null,e=!0)}if(e){for(e=a=0;e<d.length;e++)null!==d[e]&&(d[a++]=d[e]);d.length=a}};a.prototype.unload=function(a){var d=this.renderer.textureManager;a._texture&&a._texture._glRenderTargets&&d.destroyTexture(a._texture,!0);for(d=
a.children.length-1;0<=d;d--)this.unload(a.children[d])};return a}();f["default"]=a},{"../../const":44,"../../settings":99}],81:[function(a,c,f){f.__esModule=!0;var h=a("pixi-gl-core"),n=a("../../const"),m=(c=a("./utils/RenderTarget"))&&c.__esModule?c:{"default":c},g=a("../../utils");a=function(){function a(d){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=d;this.gl=d.gl;this._managedTextures=[]}a.prototype.bindTexture=function(){};a.prototype.getTexture=
function(){};a.prototype.updateTexture=function(a,b){var d=this.gl,e=!!a._glRenderTargets;if(!a.hasLoaded)return null;var g=this.renderer.boundTextures;if(void 0===b)for(var c=b=0;c<g.length;++c)if(g[c]===a){b=c;break}g[b]=a;d.activeTexture(d.TEXTURE0+b);(d=a._glTextures[this.renderer.CONTEXT_UID])?e?a._glRenderTargets[this.renderer.CONTEXT_UID].resize(a.width,a.height):d.upload(a.source):(e?(e=new m["default"](this.gl,a.width,a.height,a.scaleMode,a.resolution),e.resize(a.width,a.height),a._glRenderTargets[this.renderer.CONTEXT_UID]=
e,d=e.texture):(d=new h.GLTexture(this.gl,null,null,null,null),d.bind(b),d.premultiplyAlpha=!0,d.upload(a.source)),a._glTextures[this.renderer.CONTEXT_UID]=d,a.on("update",this.updateTexture,this),a.on("dispose",this.destroyTexture,this),this._managedTextures.push(a),a.isPowerOfTwo?(a.mipmap&&d.enableMipmap(),a.wrapMode===n.WRAP_MODES.CLAMP?d.enableWrapClamp():a.wrapMode===n.WRAP_MODES.REPEAT?d.enableWrapRepeat():d.enableWrapMirrorRepeat()):d.enableWrapClamp(),a.scaleMode===n.SCALE_MODES.NEAREST?
d.enableNearestScaling():d.enableLinearScaling());return d};a.prototype.destroyTexture=function(a,b){a=a.baseTexture||a;if(a.hasLoaded&&a._glTextures[this.renderer.CONTEXT_UID]&&(this.renderer.unbindTexture(a),a._glTextures[this.renderer.CONTEXT_UID].destroy(),a.off("update",this.updateTexture,this),a.off("dispose",this.destroyTexture,this),delete a._glTextures[this.renderer.CONTEXT_UID],!b)){var d=this._managedTextures.indexOf(a);-1!==d&&(0,g.removeItems)(this._managedTextures,d,1)}};a.prototype.removeAll=
function(){for(var a=0;a<this._managedTextures.length;++a){var b=this._managedTextures[a];b._glTextures[this.renderer.CONTEXT_UID]&&delete b._glTextures[this.renderer.CONTEXT_UID]}};a.prototype.destroy=function(){for(var a=0;a<this._managedTextures.length;++a){var b=this._managedTextures[a];this.destroyTexture(b,!0);b.off("update",this.updateTexture,this);b.off("dispose",this.destroyTexture,this)}this._managedTextures=null};return a}();f["default"]=a},{"../../const":44,"../../utils":119,"./utils/RenderTarget":94,
"pixi-gl-core":12}],82:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}function n(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;c=a("../SystemRenderer");var m=h(c);c=a("./managers/MaskManager");var g=h(c);
c=a("./managers/StencilManager");var d=h(c);c=a("./managers/FilterManager");var e=h(c);c=a("./utils/RenderTarget");var b=h(c);c=a("./utils/ObjectRenderer");var p=h(c);c=a("./TextureManager");var r=h(c);c=a("../../textures/BaseTexture");var q=h(c);c=a("./TextureGarbageCollector");var y=h(c);c=a("./WebGLState");var x=h(c);c=a("./utils/mapWebGLDrawModesToPixi");var v=h(c);c=a("./utils/validateContext");var u=h(c);c=a("../../utils");var t=a("pixi-gl-core"),z=h(t),w=a("../../const"),A=0;a=function(a){function c(b,
m){var f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var h;h=a.call(this,"WebGL",b,m,f);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");h=!h||"object"!==typeof h&&"function"!==typeof h?this:h;h.type=w.RENDERER_TYPE.WEBGL;h.handleContextLost=h.handleContextLost.bind(h);h.handleContextRestored=h.handleContextRestored.bind(h);h.view.addEventListener("webglcontextlost",
h.handleContextLost,!1);h.view.addEventListener("webglcontextrestored",h.handleContextRestored,!1);h._contextOptions={alpha:h.transparent,antialias:f.antialias,premultipliedAlpha:h.transparent&&"notMultiplied"!==h.transparent,stencil:!0,preserveDrawingBuffer:f.preserveDrawingBuffer};h._backgroundColorRgba[3]=h.transparent?0:1;h.maskManager=new g["default"](h);h.stencilManager=new d["default"](h);h.emptyRenderer=new p["default"](h);h.currentRenderer=h.emptyRenderer;h.initPlugins();f.context&&(0,u["default"])(f.context);
h.gl=f.context||z["default"].createContext(h.view,h._contextOptions);h.CONTEXT_UID=A++;h.state=new x["default"](h.gl);h.renderingToScreen=!0;h.boundTextures=null;h._activeShader=null;h._activeVao=null;h._activeRenderTarget=null;h._initContext();h.filterManager=new e["default"](h);h.drawModes=(0,v["default"])(h.gl);h._nextTextureLocation=0;h.setBlendMode(0);return h}n(c,a);c.prototype._initContext=function(){var a=this.gl;a.isContextLost()&&a.getExtension("WEBGL_lose_context")&&a.getExtension("WEBGL_lose_context").restoreContext();
var d=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures=Array(d);this.emptyTextures=Array(d);this.textureManager=new r["default"](this);this.textureGC=new y["default"](this);this.state.resetToDefault();this.rootRenderTarget=new b["default"](a,this.width,this.height,null,this.resolution,!0);this.rootRenderTarget.clearColor=this._backgroundColorRgba;this.bindRenderTarget(this.rootRenderTarget);var e=new z["default"].GLTexture.fromData(a,null,1,1),g={_glTextures:{}};g._glTextures[this.CONTEXT_UID]=
{};for(var c=0;c<d;c++){var m=new q["default"];m._glTextures[this.CONTEXT_UID]=e;this.boundTextures[c]=g;this.emptyTextures[c]=m;this.bindTexture(null,c)}this.emit("context",a);this.resize(this.width,this.height)};c.prototype.render=function(a,b,d,e,g){this.renderingToScreen=!b;this.emit("prerender");this.gl&&!this.gl.isContextLost()&&(this._nextTextureLocation=0,b||(this._lastObjectRendered=a),g||(g=a.parent,a.parent=this._tempDisplayObjectParent,a.updateTransform(),a.parent=g),this.bindRenderTexture(b,
e),this.currentRenderer.start(),(void 0!==d?d:this.clearBeforeRender)&&this._activeRenderTarget.clear(),a.renderWebGL(this),this.currentRenderer.flush(),this.textureGC.update(),this.emit("postrender"))};c.prototype.setObjectRenderer=function(a){this.currentRenderer!==a&&(this.currentRenderer.stop(),this.currentRenderer=a,this.currentRenderer.start())};c.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)};c.prototype.resize=function(a,b){m["default"].prototype.resize.call(this,a,
b);this.rootRenderTarget.resize(a,b);this._activeRenderTarget===this.rootRenderTarget&&(this.rootRenderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=this.rootRenderTarget.projectionMatrix.toArray(!0)))};c.prototype.setBlendMode=function(a){this.state.setBlendMode(a)};c.prototype.clear=function(a){this._activeRenderTarget.clear(a)};c.prototype.setTransform=function(a){this._activeRenderTarget.transform=a};c.prototype.bindRenderTexture=function(a,b){var d;a?(d=
a.baseTexture,d._glRenderTargets[this.CONTEXT_UID]||this.textureManager.updateTexture(d,0),this.unbindTexture(d),d=d._glRenderTargets[this.CONTEXT_UID],d.setFrame(a.frame)):d=this.rootRenderTarget;d.transform=b;this.bindRenderTarget(d);return this};c.prototype.bindRenderTarget=function(a){a!==this._activeRenderTarget&&(this._activeRenderTarget=a,a.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=a.projectionMatrix.toArray(!0)),this.stencilManager.setMaskStack(a.stencilMaskStack));
return this};c.prototype.bindShader=function(a){this._activeShader!==a&&(this._activeShader=a,a.bind(),a.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(!0));return this};c.prototype.bindTexture=function(a,b,d){a=a||this.emptyTextures[b];a=a.baseTexture||a;a.touched=this.textureGC.count;if(d)b=b||0;else{for(d=0;d<this.boundTextures.length;d++)if(this.boundTextures[d]===a)return d;void 0===b&&(this._nextTextureLocation++,this._nextTextureLocation%=this.boundTextures.length,
b=this.boundTextures.length-this._nextTextureLocation-1)}d=this.gl;var e=a._glTextures[this.CONTEXT_UID];e?(this.boundTextures[b]=a,d.activeTexture(d.TEXTURE0+b),d.bindTexture(d.TEXTURE_2D,e.texture)):this.textureManager.updateTexture(a,b);return b};c.prototype.unbindTexture=function(a){var b=this.gl;a=a.baseTexture||a;for(var d=0;d<this.boundTextures.length;d++)this.boundTextures[d]===a&&(this.boundTextures[d]=this.emptyTextures[d],b.activeTexture(b.TEXTURE0+d),b.bindTexture(b.TEXTURE_2D,this.emptyTextures[d]._glTextures[this.CONTEXT_UID].texture));
return this};c.prototype.createVao=function(){return new z["default"].VertexArrayObject(this.gl,this.state.attribState)};c.prototype.bindVao=function(a){if(this._activeVao===a)return this;a?a.bind():this._activeVao&&this._activeVao.unbind();this._activeVao=a;return this};c.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer);this._activeShader=null;this._activeRenderTarget=this.rootRenderTarget;this.rootRenderTarget.activate();this.state.resetToDefault();return this};c.prototype.handleContextLost=
function(a){a.preventDefault()};c.prototype.handleContextRestored=function(){this._initContext();this.textureManager.removeAll()};c.prototype.destroy=function(b){this.destroyPlugins();this.view.removeEventListener("webglcontextlost",this.handleContextLost);this.view.removeEventListener("webglcontextrestored",this.handleContextRestored);this.textureManager.destroy();a.prototype.destroy.call(this,b);this.uid=0;this.maskManager.destroy();this.stencilManager.destroy();this.filterManager.destroy();this._contextOptions=
this.handleContextRestored=this.handleContextLost=this.currentRenderer=this.textureManager=this.filterManager=this.maskManager=null;this.gl.useProgram(null);this.gl.getExtension("WEBGL_lose_context")&&this.gl.getExtension("WEBGL_lose_context").loseContext();this.gl=null};return c}(m["default"]);f["default"]=a;c.pluginTarget.mixin(a)},{"../../const":44,"../../textures/BaseTexture":109,"../../utils":119,"../SystemRenderer":74,"./TextureGarbageCollector":80,"./TextureManager":81,"./WebGLState":83,"./managers/FilterManager":88,
"./managers/MaskManager":89,"./managers/StencilManager":90,"./utils/ObjectRenderer":92,"./utils/RenderTarget":94,"./utils/mapWebGLDrawModesToPixi":97,"./utils/validateContext":98,"pixi-gl-core":12}],83:[function(a,c,f){f.__esModule=!0;var h=(a=a("./utils/mapWebGLBlendModesToPixi"))&&a.__esModule?a:{"default":a};a=function(){function a(c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.activeState=new Uint8Array(16);this.defaultState=new Uint8Array(16);this.defaultState[0]=
1;this.stackIndex=0;this.stack=[];this.gl=c;this.maxAttribs=c.getParameter(c.MAX_VERTEX_ATTRIBS);this.attribState={tempAttribState:Array(this.maxAttribs),attribState:Array(this.maxAttribs)};this.blendModes=(0,h["default"])(c);this.nativeVaoExtension=c.getExtension("OES_vertex_array_object")||c.getExtension("MOZ_OES_vertex_array_object")||c.getExtension("WEBKIT_OES_vertex_array_object")}a.prototype.push=function(){var a=this.stack[++this.stackIndex];a||(a=this.stack[this.stackIndex]=new Uint8Array(16));
for(var g=0;g<this.activeState.length;g++)this.activeState[g]=a[g]};a.prototype.pop=function(){var a=this.stack[--this.stackIndex];this.setState(a)};a.prototype.setState=function(a){this.setBlend(a[0]);this.setDepthTest(a[1]);this.setFrontFace(a[2]);this.setCullFace(a[3]);this.setBlendMode(a[4])};a.prototype.setBlend=function(a){a=a?1:0;this.activeState[0]!==a&&(this.activeState[0]=a,this.gl[a?"enable":"disable"](this.gl.BLEND))};a.prototype.setBlendMode=function(a){a!==this.activeState[4]&&(this.activeState[4]=
a,this.gl.blendFunc(this.blendModes[a][0],this.blendModes[a][1]))};a.prototype.setDepthTest=function(a){a=a?1:0;this.activeState[1]!==a&&(this.activeState[1]=a,this.gl[a?"enable":"disable"](this.gl.DEPTH_TEST))};a.prototype.setCullFace=function(a){a=a?1:0;this.activeState[3]!==a&&(this.activeState[3]=a,this.gl[a?"enable":"disable"](this.gl.CULL_FACE))};a.prototype.setFrontFace=function(a){a=a?1:0;this.activeState[2]!==a&&(this.activeState[2]=a,this.gl.frontFace(this.gl[a?"CW":"CCW"]))};a.prototype.resetAttributes=
function(){for(var a=0;a<this.attribState.tempAttribState.length;a++)this.attribState.tempAttribState[a]=0;for(a=0;a<this.attribState.attribState.length;a++)this.attribState.attribState[a]=0;for(a=1;a<this.maxAttribs;a++)this.gl.disableVertexAttribArray(a)};a.prototype.resetToDefault=function(){this.nativeVaoExtension&&this.nativeVaoExtension.bindVertexArrayOES(null);this.resetAttributes();for(var a=0;a<this.activeState.length;++a)this.activeState[a]=32;this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,
!1);this.setState(this.defaultState)};return a}();f["default"]=a},{"./utils/mapWebGLBlendModesToPixi":96}],84:[function(a,c,f){f.__esModule=!0;var h=function(){function a(a,d){for(var b=0;b<d.length;b++){var e=d[b];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,d,e){d&&a(b.prototype,d);e&&a(b,e);return b}}(),n=(c=a("./extractUniformsFromSrc"))&&c.__esModule?c:{"default":c},m=a("../../../utils"),g=a("../../../const"),
d={};a=function(){function a(b,e,c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.vertexSrc=b||a.defaultVertexSrc;this.fragmentSrc=e||a.defaultFragmentSrc;this.blendMode=g.BLEND_MODES.NORMAL;this.uniformData=c||(0,n["default"])(this.vertexSrc,this.fragmentSrc,"projectionMatrix|uSampler");this.uniforms={};for(var p in this.uniformData)this.uniforms[p]=this.uniformData[p].value;this.glShaders={};d[this.vertexSrc+this.fragmentSrc]||(d[this.vertexSrc+this.fragmentSrc]=
(0,m.uid)());this.glShaderKey=d[this.vertexSrc+this.fragmentSrc];this.padding=4;this.resolution=1;this.enabled=!0}a.prototype.apply=function(a,d,e,g){a.applyFilter(this,d,e,g)};h(a,null,[{key:"defaultVertexSrc",get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord ;\n}"}},
{key:"defaultFragmentSrc",get:function(){return"varying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\nuniform sampler2D uSampler;\nuniform sampler2D filterSampler;\nvoid main(void){\n   vec4 masky = texture2D(filterSampler, vFilterCoord);\n   vec4 sample = texture2D(uSampler, vTextureCoord);\n   vec4 color;\n   if(mod(vFilterCoord.x, 1.0) > 0.5)\n   {\n     color = vec4(1.0, 0.0, 0.0, 1.0);\n   }\n   else\n   {\n     color = vec4(0.0, 1.0, 0.0, 1.0);\n   }\n   gl_FragColor = mix(sample, masky, 0.5);\n   gl_FragColor *= sample.a;\n}"}}]);
return a}();f["default"]=a},{"../../../const":44,"../../../utils":119,"./extractUniformsFromSrc":85}],85:[function(a,c,f){function h(a){var g=/^(projectionMatrix|uSampler|filterArea)$/,d={},e;a=a.replace(/\s+/g," ").split(/\s*;\s*/);for(var b=0;b<a.length;b++){var c=a[b].trim();if(-1<c.indexOf("uniform")){e=c.split(" ");var c=e[1],m=e[2],f=1;-1<m.indexOf("[")&&(e=m.split(/\[|]/),m=e[0],f*=Number(e[1]));m.match(g)||(d[m]={value:n(c,f),name:m,type:c})}}return d}f.__esModule=!0;f["default"]=function(a,
g,d){a=h(a,d);g=h(g,d);return Object.assign(a,g)};a=a("pixi-gl-core");var n=(a&&a.__esModule?a:{"default":a})["default"].shader.defaultValue},{"pixi-gl-core":12}],86:[function(a,c,f){f.__esModule=!0;f.calculateScreenSpaceMatrix=function(a,c,g){a=a.identity();a.translate(c.x/g.width,c.y/g.height);a.scale(g.width,g.height);return a};f.calculateNormalizedScreenSpaceMatrix=function(a,c,g){a=a.identity();a.translate(c.x/g.width,c.y/g.height);a.scale(g.width/c.width,g.height/c.height);return a};f.calculateSpriteMatrix=
function(a,c,g,d){var e=d.worldTransform.copy(h.Matrix.TEMP_MATRIX),b=d._texture.baseTexture;a=a.identity();var m=g.height/g.width;a.translate(c.x/g.width,c.y/g.height);a.scale(1,m);c=g.width/b.width;g=g.height/b.height;e.tx/=b.width*c;e.ty/=b.width*c;e.invert();a.prepend(e);a.scale(1,1/m);a.scale(c,g);a.translate(d.anchor.x,d.anchor.y);return a};var h=a("../../../math")},{"../../../math":68}],87:[function(a,c,f){function h(a,g){if("function"!==typeof g&&null!==g)throw new TypeError("Super expression must either be null or a function, not "+
typeof g);a.prototype=Object.create(g&&g.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});g&&(Object.setPrototypeOf?Object.setPrototypeOf(a,g):a.__proto__=g)}f.__esModule=!0;c=(c=a("../Filter"))&&c.__esModule?c:{"default":c};var n=a("../../../../math");a("path");a=function(a){function g(d){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");var e=new n.Matrix,b;b=a.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    // check clip! this will stop the mask bleeding out from the edges\n    vec2 text = abs( vMaskCoord - 0.5 );\n    text = step(0.5, text);\n\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n");
if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==typeof b&&"function"!==typeof b?this:b;d.renderable=!1;b.maskSprite=d;b.maskMatrix=e;return b}h(g,a);g.prototype.apply=function(a,e,b){var d=this.maskSprite;this.uniforms.mask=d._texture;this.uniforms.otherMatrix=a.calculateSpriteMatrix(this.maskMatrix,d);this.uniforms.alpha=d.worldAlpha;a.applyFilter(this,e,b)};return g}(c["default"]);f["default"]=a},{"../../../../math":68,"../Filter":84,
path:22}],88:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}function n(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}f.__esModule=
!0;c=a("./WebGLManager");c=h(c);var g=a("../utils/RenderTarget"),d=h(g),g=a("../utils/Quad"),e=h(g),b=a("../../../math"),g=a("../../../Shader"),p=h(g),r=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../filters/filterTransforms"));a=a("bit-twiddle");var q=h(a),y=function v(){m(this,v);this.renderTarget=null;this.sourceFrame=new b.Rectangle;this.destinationFrame=new b.Rectangle;this.filters=
[];this.target=null;this.resolution=1};a=function(a){function b(d){m(this,b);var g;g=a.call(this,d);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");g=!g||"object"!==typeof g&&"function"!==typeof g?this:g;g.gl=g.renderer.gl;g.quad=new e["default"](g.gl,d.state.attribState);g.shaderCache={};g.pool={};g.filterData=null;return g}n(b,a);b.prototype.pushFilter=function(a,b){var d=this.renderer,e=this.filterData;if(!e){var g=new y;g.sourceFrame=g.destinationFrame=
this.renderer._activeRenderTarget.size;g.renderTarget=d._activeRenderTarget;this.filterData=this.renderer._activeRenderTarget.filterData=e={index:0,stack:[g]}}(g=e.stack[++e.index])||(g=e.stack[e.index]=new y);var c=b[0].resolution,m=b[0].padding|0,p=a.filterArea||a.getBounds(!0),f=g.sourceFrame,h=g.destinationFrame;f.x=(p.x*c|0)/c;f.y=(p.y*c|0)/c;f.width=(p.width*c|0)/c;f.height=(p.height*c|0)/c;e.stack[0].renderTarget.transform||f.fit(e.stack[0].destinationFrame);f.pad(m);h.width=f.width;h.height=
f.height;e=this.getPotRenderTarget(d.gl,f.width,f.height,c);g.target=a;g.filters=b;g.resolution=c;g.renderTarget=e;e.setFrame(h,f);d.bindRenderTarget(e);e.clear()};b.prototype.popFilter=function(){var a=this.filterData,b=a.stack[a.index-1],d=a.stack[a.index];this.quad.map(d.renderTarget.size,d.sourceFrame).upload();var e=d.filters;if(1===e.length)e[0].apply(this,d.renderTarget,b.renderTarget,!1),this.freePotRenderTarget(d.renderTarget);else{var g=d.renderTarget,c=this.getPotRenderTarget(this.renderer.gl,
d.sourceFrame.width,d.sourceFrame.height,d.resolution);c.setFrame(d.destinationFrame,d.sourceFrame);c.clear();for(d=0;d<e.length-1;++d){e[d].apply(this,g,c,!0);var m=g,g=c,c=m}e[d].apply(this,g,b.renderTarget,!0);this.freePotRenderTarget(g);this.freePotRenderTarget(c)}a.index--;0===a.index&&(this.filterData=null)};b.prototype.applyFilter=function(a,b,d,e){var g=this.renderer,c=g.gl,m=a.glShaders[g.CONTEXT_UID];m||(a.glShaderKey?(m=this.shaderCache[a.glShaderKey],m||(m=new p["default"](this.gl,a.vertexSrc,
a.fragmentSrc),a.glShaders[g.CONTEXT_UID]=this.shaderCache[a.glShaderKey]=m)):m=a.glShaders[g.CONTEXT_UID]=new p["default"](this.gl,a.vertexSrc,a.fragmentSrc),g.bindVao(null),this.quad.initVao(m));g.bindVao(this.quad.vao);g.bindRenderTarget(d);e&&(c.disable(c.SCISSOR_TEST),g.clear(),c.enable(c.SCISSOR_TEST));d===g.maskManager.scissorRenderTarget&&g.maskManager.pushScissorMask(null,g.maskManager.scissorData);g.bindShader(m);this.syncUniforms(m,a);g.state.setBlendMode(a.blendMode);a=this.renderer.boundTextures[0];
c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,b.texture.texture);this.quad.vao.draw(this.renderer.gl.TRIANGLES,6,0);c.bindTexture(c.TEXTURE_2D,a._glTextures[this.renderer.CONTEXT_UID].texture)};b.prototype.syncUniforms=function(a,b){var d=b.uniformData,e=b.uniforms,g=1,c;if(a.uniforms.data.filterArea){c=this.filterData.stack[this.filterData.index];var m=a.uniforms.filterArea;m[0]=c.renderTarget.size.width;m[1]=c.renderTarget.size.height;m[2]=c.sourceFrame.x;m[3]=c.sourceFrame.y;a.uniforms.filterArea=
m}a.uniforms.data.filterClamp&&(c=this.filterData.stack[this.filterData.index],m=a.uniforms.filterClamp,m[0]=0,m[1]=0,m[2]=(c.sourceFrame.width-1)/c.renderTarget.size.width,m[3]=(c.sourceFrame.height-1)/c.renderTarget.size.height,a.uniforms.filterClamp=m);for(var p in d)"sampler2D"===d[p].type&&0!==e[p]?(e[p].baseTexture?a.uniforms[p]=this.renderer.bindTexture(e[p].baseTexture,g):(a.uniforms[p]=g,c=this.renderer.gl,this.renderer.boundTextures[g]=this.renderer.emptyTextures[g],c.activeTexture(c.TEXTURE0+
g),e[p].texture.bind()),g++):"mat3"===d[p].type?a.uniforms[p]=void 0!==e[p].a?e[p].toArray(!0):e[p]:"vec2"===d[p].type?void 0!==e[p].x?(c=a.uniforms[p]||new Float32Array(2),c[0]=e[p].x,c[1]=e[p].y,a.uniforms[p]=c):a.uniforms[p]=e[p]:"float"===d[p].type?a.uniforms.data[p].value!==d[p]&&(a.uniforms[p]=e[p]):a.uniforms[p]=e[p]};b.prototype.getRenderTarget=function(a,b){var d=this.filterData.stack[this.filterData.index],e=this.getPotRenderTarget(this.renderer.gl,d.sourceFrame.width,d.sourceFrame.height,
b||d.resolution);e.setFrame(d.destinationFrame,d.sourceFrame);return e};b.prototype.returnRenderTarget=function(a){this.freePotRenderTarget(a)};b.prototype.calculateScreenSpaceMatrix=function(a){var b=this.filterData.stack[this.filterData.index];return r.calculateScreenSpaceMatrix(a,b.sourceFrame,b.renderTarget.size)};b.prototype.calculateNormalizedScreenSpaceMatrix=function(a){var b=this.filterData.stack[this.filterData.index];return r.calculateNormalizedScreenSpaceMatrix(a,b.sourceFrame,b.renderTarget.size,
b.destinationFrame)};b.prototype.calculateSpriteMatrix=function(a,b){var d=this.filterData.stack[this.filterData.index];return r.calculateSpriteMatrix(a,d.sourceFrame,d.renderTarget.size,b)};b.prototype.destroy=function(){this.shaderCache=[];this.emptyPool()};b.prototype.getPotRenderTarget=function(a,b,e,g){b=q["default"].nextPow2(b*g);e=q["default"].nextPow2(e*g);var c=(b&65535)<<16|e&65535;this.pool[c]||(this.pool[c]=[]);c=this.pool[c].pop();if(!c){var p=this.renderer.boundTextures[0];a.activeTexture(a.TEXTURE0);
c=new d["default"](a,b,e,null,1);a.bindTexture(a.TEXTURE_2D,p._glTextures[this.renderer.CONTEXT_UID].texture)}c.resolution=g;c.defaultFrame.width=c.size.width=b/g;c.defaultFrame.height=c.size.height=e/g;return c};b.prototype.emptyPool=function(){for(var a in this.pool){var b=this.pool[a];if(b)for(var d=0;d<b.length;d++)b[d].destroy(!0)}this.pool={}};b.prototype.freePotRenderTarget=function(a){this.pool[(a.size.width*a.resolution&65535)<<16|a.size.height*a.resolution&65535].push(a)};return b}(c["default"]);
f["default"]=a},{"../../../Shader":42,"../../../math":68,"../filters/filterTransforms":86,"../utils/Quad":93,"../utils/RenderTarget":94,"./WebGLManager":91,"bit-twiddle":1}],89:[function(a,c,f){function h(a,g){if("function"!==typeof g&&null!==g)throw new TypeError("Super expression must either be null or a function, not "+typeof g);a.prototype=Object.create(g&&g.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});g&&(Object.setPrototypeOf?Object.setPrototypeOf(a,g):a.__proto__=
g)}f.__esModule=!0;c=(c=a("./WebGLManager"))&&c.__esModule?c:{"default":c};var n=(a=a("../filters/spriteMask/SpriteMaskFilter"))&&a.__esModule?a:{"default":a};a=function(a){function g(d){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");d=a.call(this,d);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");d=!d||"object"!==typeof d&&"function"!==typeof d?this:d;d.scissor=!1;d.scissorData=null;d.scissorRenderTarget=null;d.enableScissor=
!0;d.alphaMaskPool=[];d.alphaMaskIndex=0;return d}h(g,a);g.prototype.pushMask=function(a,e){if(e.texture)this.pushSpriteMask(a,e);else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencilManager.stencilMaskStack.length&&e.isFastRect()){var b=e.worldTransform,b=Math.atan2(b.b,b.a),b=Math.round(180/Math.PI*b);b%90?this.pushStencilMask(e):this.pushScissorMask(a,e)}else this.pushStencilMask(e)};g.prototype.popMask=function(a,e){e.texture?this.popSpriteMask(a,
e):this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length?this.popScissorMask(a,e):this.popStencilMask(a,e)};g.prototype.pushSpriteMask=function(a,e){var b=this.alphaMaskPool[this.alphaMaskIndex];b||(b=this.alphaMaskPool[this.alphaMaskIndex]=[new n["default"](e)]);b[0].resolution=this.renderer.resolution;b[0].maskSprite=e;a.filterArea=e.getBounds(!0);this.renderer.filterManager.pushFilter(a,b);this.alphaMaskIndex++};g.prototype.popSpriteMask=function(){this.renderer.filterManager.popFilter();
this.alphaMaskIndex--};g.prototype.pushStencilMask=function(a){this.renderer.currentRenderer.stop();this.renderer.stencilManager.pushStencil(a)};g.prototype.popStencilMask=function(){this.renderer.currentRenderer.stop();this.renderer.stencilManager.popStencil()};g.prototype.pushScissorMask=function(a,e){e.renderable=!0;var b=this.renderer._activeRenderTarget,d=e.getBounds();d.fit(b.size);e.renderable=!1;this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var g=this.renderer.resolution;this.renderer.gl.scissor(d.x*
g,(b.root?b.size.height-d.y-d.height:d.y)*g,d.width*g,d.height*g);this.scissorRenderTarget=b;this.scissorData=e;this.scissor=!0};g.prototype.popScissorMask=function(){this.scissorData=this.scissorRenderTarget=null;this.scissor=!1;var a=this.renderer.gl;a.disable(a.SCISSOR_TEST)};return g}(c["default"]);f["default"]=a},{"../filters/spriteMask/SpriteMaskFilter":87,"./WebGLManager":91}],90:[function(a,c,f){function h(a,g){if("function"!==typeof g&&null!==g)throw new TypeError("Super expression must either be null or a function, not "+
typeof g);a.prototype=Object.create(g&&g.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});g&&(Object.setPrototypeOf?Object.setPrototypeOf(a,g):a.__proto__=g)}f.__esModule=!0;var n=(a=a("./WebGLManager"))&&a.__esModule?a:{"default":a};a=function(a){function g(d){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");d=a.call(this,d);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");d=!d||"object"!==typeof d&&
"function"!==typeof d?this:d;d.stencilMaskStack=null;return d}h(g,a);g.prototype.setMaskStack=function(a){this.stencilMaskStack=a;var d=this.renderer.gl;0===a.length?d.disable(d.STENCIL_TEST):d.enable(d.STENCIL_TEST)};g.prototype.pushStencil=function(a){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);this.renderer._activeRenderTarget.attachStencilBuffer();var d=this.renderer.gl,b=this.stencilMaskStack;0===b.length&&(d.enable(d.STENCIL_TEST),d.clear(d.STENCIL_BUFFER_BIT),d.stencilFunc(d.ALWAYS,
1,1));b.push(a);d.colorMask(!1,!1,!1,!1);d.stencilOp(d.KEEP,d.KEEP,d.INCR);this.renderer.plugins.graphics.render(a);d.colorMask(!0,!0,!0,!0);d.stencilFunc(d.NOTEQUAL,0,b.length);d.stencilOp(d.KEEP,d.KEEP,d.KEEP)};g.prototype.popStencil=function(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);var a=this.renderer.gl,e=this.stencilMaskStack,b=e.pop();0===e.length?a.disable(a.STENCIL_TEST):(a.colorMask(!1,!1,!1,!1),a.stencilOp(a.KEEP,a.KEEP,a.DECR),this.renderer.plugins.graphics.render(b),
a.colorMask(!0,!0,!0,!0),a.stencilFunc(a.NOTEQUAL,0,e.length),a.stencilOp(a.KEEP,a.KEEP,a.KEEP))};g.prototype.destroy=function(){n["default"].prototype.destroy.call(this);this.stencilMaskStack.stencilStack=null};return g}(n["default"]);f["default"]=a},{"./WebGLManager":91}],91:[function(a,c,f){f.__esModule=!0;a=function(){function a(c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=c;this.renderer.on("context",this.onContextChange,this)}a.prototype.onContextChange=
function(){};a.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this);this.renderer=null};return a}();f["default"]=a},{}],92:[function(a,c,f){function h(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}f.__esModule=!0;
a=a("../managers/WebGLManager");a=function(a){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var g=a.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!g||"object"!==typeof g&&"function"!==typeof g?this:g}h(c,a);c.prototype.start=function(){};c.prototype.stop=function(){this.flush()};c.prototype.flush=function(){};c.prototype.render=function(a){};return c}((a&&a.__esModule?a:{"default":a})["default"]);
f["default"]=a},{"../managers/WebGLManager":91}],93:[function(a,c,f){f.__esModule=!0;var h=(c=a("pixi-gl-core"))&&c.__esModule?c:{"default":c},n=(a=a("../../../utils/createIndicesForQuads"))&&a.__esModule?a:{"default":a};a=function(){function a(c,d){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.gl=c;this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]);this.uvs=new Float32Array([0,0,1,0,1,1,0,1]);this.interleaved=new Float32Array(16);for(var e=0;4>e;e++)this.interleaved[4*
e]=this.vertices[2*e],this.interleaved[4*e+1]=this.vertices[2*e+1],this.interleaved[4*e+2]=this.uvs[2*e],this.interleaved[4*e+3]=this.uvs[2*e+1];this.indices=(0,n["default"])(1);this.vertexBuffer=h["default"].GLBuffer.createVertexBuffer(c,this.interleaved,c.STATIC_DRAW);this.indexBuffer=h["default"].GLBuffer.createIndexBuffer(c,this.indices,c.STATIC_DRAW);this.vao=new h["default"].VertexArrayObject(c,d)}a.prototype.initVao=function(a){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,
a.attributes.aVertexPosition,this.gl.FLOAT,!1,16,0).addAttribute(this.vertexBuffer,a.attributes.aTextureCoord,this.gl.FLOAT,!1,16,8)};a.prototype.map=function(a,d){var e=0,b=0;this.uvs[0]=e;this.uvs[1]=b;this.uvs[2]=e+d.width/a.width;this.uvs[3]=b;this.uvs[4]=e+d.width/a.width;this.uvs[5]=b+d.height/a.height;this.uvs[6]=e;this.uvs[7]=b+d.height/a.height;e=d.x;b=d.y;this.vertices[0]=e;this.vertices[1]=b;this.vertices[2]=e+d.width;this.vertices[3]=b;this.vertices[4]=e+d.width;this.vertices[5]=b+d.height;
this.vertices[6]=e;this.vertices[7]=b+d.height;return this};a.prototype.upload=function(){for(var a=0;4>a;a++)this.interleaved[4*a]=this.vertices[2*a],this.interleaved[4*a+1]=this.vertices[2*a+1],this.interleaved[4*a+2]=this.uvs[2*a],this.interleaved[4*a+3]=this.uvs[2*a+1];this.vertexBuffer.upload(this.interleaved);return this};a.prototype.destroy=function(){var a=this.gl;a.deleteBuffer(this.vertexBuffer);a.deleteBuffer(this.indexBuffer)};return a}();f["default"]=a},{"../../../utils/createIndicesForQuads":117,
"pixi-gl-core":12}],94:[function(a,c,f){f.__esModule=!0;var h=a("../../../math"),n=a("../../../const"),m=(c=a("../../../settings"))&&c.__esModule?c:{"default":c},g=a("pixi-gl-core");a=function(){function a(d,b,c,f,q,y){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.gl=d;this.texture=this.frameBuffer=null;this.clearColor=[0,0,0,0];this.size=new h.Rectangle(0,0,1,1);this.resolution=q||m["default"].RESOLUTION;this.projectionMatrix=new h.Matrix;this.frame=this.transform=
null;this.defaultFrame=new h.Rectangle;this.stencilBuffer=this.sourceFrame=this.destinationFrame=null;this.stencilMaskStack=[];this.filterData=null;this.scaleMode=f||m["default"].SCALE_MODE;(this.root=y)?(this.frameBuffer=new g.GLFramebuffer(d,100,100),this.frameBuffer.framebuffer=null):(this.frameBuffer=g.GLFramebuffer.createRGBA(d,100,100),this.scaleMode===n.SCALE_MODES.NEAREST?this.frameBuffer.texture.enableNearestScaling():this.frameBuffer.texture.enableLinearScaling(),this.texture=this.frameBuffer.texture);
this.setFrame();this.resize(b,c)}a.prototype.clear=function(a){a=a||this.clearColor;this.frameBuffer.clear(a[0],a[1],a[2],a[3])};a.prototype.attachStencilBuffer=function(){this.root||this.frameBuffer.enableStencil()};a.prototype.setFrame=function(a,b){this.destinationFrame=a||this.destinationFrame||this.defaultFrame;this.sourceFrame=b||this.sourceFrame||a};a.prototype.activate=function(){var a=this.gl;this.frameBuffer.bind();this.calculateProjection(this.destinationFrame,this.sourceFrame);this.transform&&
this.projectionMatrix.append(this.transform);this.destinationFrame!==this.sourceFrame?(a.enable(a.SCISSOR_TEST),a.scissor(this.destinationFrame.x|0,this.destinationFrame.y|0,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)):a.disable(a.SCISSOR_TEST);a.viewport(this.destinationFrame.x|0,this.destinationFrame.y|0,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)};a.prototype.calculateProjection=function(a,b){var d=
this.projectionMatrix;b=b||a;d.identity();this.root?(d.a=1/a.width*2,d.d=-1/a.height*2,d.tx=-1-b.x*d.a,d.ty=1-b.y*d.d):(d.a=1/a.width*2,d.d=1/a.height*2,d.tx=-1-b.x*d.a,d.ty=-1-b.y*d.d)};a.prototype.resize=function(a,b){a|=0;b|=0;if(this.size.width!==a||this.size.height!==b)this.size.width=a,this.size.height=b,this.defaultFrame.width=a,this.defaultFrame.height=b,this.frameBuffer.resize(a*this.resolution,b*this.resolution),this.calculateProjection(this.frame||this.size)};a.prototype.destroy=function(){this.frameBuffer.destroy();
this.texture=this.frameBuffer=null};return a}();f["default"]=a},{"../../../const":44,"../../../math":68,"../../../settings":99,"pixi-gl-core":12}],95:[function(a,c,f){function h(a){for(var d="",e=0;e<a;++e)0<e&&(d+="\nelse "),e<a-1&&(d+="if(test == "+e+".0){}");return d}f.__esModule=!0;f["default"]=function(a,d){var e=!d;if(0===a)throw Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");if(e){var b=document.createElement("canvas");b.width=1;b.height=1;d=n["default"].createContext(b)}for(b=
d.createShader(d.FRAGMENT_SHADER);;){var c=m.replace(/%forloop%/gi,h(a));d.shaderSource(b,c);d.compileShader(b);if(d.getShaderParameter(b,d.COMPILE_STATUS))break;else a=a/2|0}e&&d.getExtension("WEBGL_lose_context")&&d.getExtension("WEBGL_lose_context").loseContext();return a};var n=(a=a("pixi-gl-core"))&&a.__esModule?a:{"default":a},m="precision mediump float;\nvoid main(void){\nfloat test = 0.1;\n%forloop%\ngl_FragColor = vec4(0.0);\n}"},{"pixi-gl-core":12}],96:[function(a,c,f){f.__esModule=!0;f["default"]=
function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];c[h.BLEND_MODES.NORMAL]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];c[h.BLEND_MODES.ADD]=[a.ONE,a.DST_ALPHA];c[h.BLEND_MODES.MULTIPLY]=[a.DST_COLOR,a.ONE_MINUS_SRC_ALPHA];c[h.BLEND_MODES.SCREEN]=[a.ONE,a.ONE_MINUS_SRC_COLOR];c[h.BLEND_MODES.OVERLAY]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];c[h.BLEND_MODES.DARKEN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];c[h.BLEND_MODES.LIGHTEN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];c[h.BLEND_MODES.COLOR_DODGE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];
c[h.BLEND_MODES.COLOR_BURN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];c[h.BLEND_MODES.HARD_LIGHT]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];c[h.BLEND_MODES.SOFT_LIGHT]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];c[h.BLEND_MODES.DIFFERENCE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];c[h.BLEND_MODES.EXCLUSION]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];c[h.BLEND_MODES.HUE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];c[h.BLEND_MODES.SATURATION]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];c[h.BLEND_MODES.COLOR]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];c[h.BLEND_MODES.LUMINOSITY]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];
return c};var h=a("../../../const")},{"../../../const":44}],97:[function(a,c,f){f.__esModule=!0;f["default"]=function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};c[h.DRAW_MODES.POINTS]=a.POINTS;c[h.DRAW_MODES.LINES]=a.LINES;c[h.DRAW_MODES.LINE_LOOP]=a.LINE_LOOP;c[h.DRAW_MODES.LINE_STRIP]=a.LINE_STRIP;c[h.DRAW_MODES.TRIANGLES]=a.TRIANGLES;c[h.DRAW_MODES.TRIANGLE_STRIP]=a.TRIANGLE_STRIP;c[h.DRAW_MODES.TRIANGLE_FAN]=a.TRIANGLE_FAN;return c};var h=a("../../../const")},{"../../../const":44}],
98:[function(a,c,f){f.__esModule=!0;f["default"]=function(a){a.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")}},{}],99:[function(a,c,f){f.__esModule=!0;c=(c=a("./utils/maxRecommendedTextures"))&&c.__esModule?c:{"default":c};a=(a=a("./utils/canUploadSameBuffer"))&&a.__esModule?a:{"default":a};f["default"]={TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:(0,c["default"])(32),
SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@(.+)x/,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION:"mediump",CAN_UPLOAD_SAME_BUFFER:(0,a["default"])()}},{"./utils/canUploadSameBuffer":116,"./utils/maxRecommendedTextures":120}],100:[function(a,c,f){function h(a,b){if("function"!==typeof b&&null!==
b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;var n=function(){function a(a,b){for(var d=0;d<b.length;d++){var e=b[d];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,d,e){d&&a(b.prototype,
d);e&&a(b,e);return b}}(),m=a("../math"),g=a("../utils"),d=a("../const"),e=(c=a("../textures/Texture"))&&c.__esModule?c:{"default":c};a=(a=a("../display/Container"))&&a.__esModule?a:{"default":a};var b=new m.Point;a=function(a){function c(b){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var g;g=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");g=!g||"object"!==typeof g&&"function"!==typeof g?this:g;g._anchor=
new m.ObservablePoint(g._onAnchorUpdate,g);g._texture=null;g._width=0;g._height=0;g._tint=null;g._tintRGB=null;g.tint=16777215;g.blendMode=d.BLEND_MODES.NORMAL;g.shader=null;g.cachedTint=16777215;g.texture=b||e["default"].EMPTY;g.vertexData=new Float32Array(8);g.vertexTrimmedData=null;g._transformID=-1;g._textureID=-1;g._transformTrimmedID=-1;g._textureTrimmedID=-1;g.pluginName="sprite";return g}h(c,a);c.prototype._onTextureUpdate=function(){this._textureTrimmedID=this._textureID=-1;this._width&&
(this.scale.x=(0,g.sign)(this.scale.x)*this._width/this.texture.orig.width);this._height&&(this.scale.y=(0,g.sign)(this.scale.y)*this._height/this.texture.orig.height)};c.prototype._onAnchorUpdate=function(){this._transformTrimmedID=this._transformID=-1};c.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID||this._textureID!==this._texture._updateID){this._transformID=this.transform._worldID;this._textureID=this._texture._updateID;var a=this._texture,b=this.transform.worldTransform,
d=b.a,e=b.b,c=b.c,g=b.d,p=b.tx,b=b.ty,m=this.vertexData,f=a.trim,h=a.orig,n=this._anchor,r;f?(r=f.x-n._x*h.width,a=r+f.width,h=f.y-n._y*h.height,f=h+f.height):(a=h.width*(1-n._x),r=h.width*-n._x,f=h.height*(1-n._y),h=h.height*-n._y);m[0]=d*r+c*h+p;m[1]=g*h+e*r+b;m[2]=d*a+c*h+p;m[3]=g*h+e*a+b;m[4]=d*a+c*f+p;m[5]=g*f+e*a+b;m[6]=d*r+c*f+p;m[7]=g*f+e*r+b}};c.prototype.calculateTrimmedVertices=function(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===
this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID;this._textureTrimmedID=this._texture._updateID;var a=this.vertexTrimmedData,b=this._texture.orig,d=this._anchor,e=this.transform.worldTransform,c=e.a,g=e.b,p=e.c,m=e.d,f=e.tx,e=e.ty,h=b.width*(1-d._x),n=b.width*-d._x,r=b.height*(1-d._y),b=b.height*-d._y;a[0]=c*n+p*b+f;a[1]=m*b+g*n+e;a[2]=c*h+p*b+f;a[3]=m*b+g*h+e;a[4]=c*h+p*r+f;a[5]=m*r+g*h+e;a[6]=c*n+p*r+f;a[7]=m*r+g*n+
e};c.prototype._renderWebGL=function(a){this.calculateVertices();a.setObjectRenderer(a.plugins[this.pluginName]);a.plugins[this.pluginName].render(this)};c.prototype._renderCanvas=function(a){a.plugins[this.pluginName].render(this)};c.prototype._calculateBounds=function(){var a=this._texture.trim,b=this._texture.orig;!a||a.width===b.width&&a.height===b.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))};
c.prototype.getLocalBounds=function(b){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._x),b||(this._localBoundsRect||(this._localBoundsRect=new m.Rectangle),b=this._localBoundsRect),this._bounds.getRectangle(b)):a.prototype.getLocalBounds.call(this,b)};c.prototype.containsPoint=
function(a){this.worldTransform.applyInverse(a,b);var d=this._texture.orig.width;a=this._texture.orig.height;var e=-d*this.anchor.x;return b.x>e&&b.x<e+d&&(d=-a*this.anchor.y,b.y>d&&b.y<d+a)?!0:!1};c.prototype.destroy=function(b){a.prototype.destroy.call(this,b);this._anchor=null;("boolean"===typeof b?b:b&&b.texture)&&this._texture.destroy(!!("boolean"===typeof b?b:b&&b.baseTexture));this.shader=this._texture=null};c.from=function(a){return new c(e["default"].from(a))};c.fromFrame=function(a){var b=
g.TextureCache[a];if(!b)throw Error('The frameId "'+a+'" does not exist in the texture cache');return new c(b)};c.fromImage=function(a,b,d){return new c(e["default"].fromImage(a,b,d))};n(c,[{key:"width",get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(a){var b=(0,g.sign)(this.scale.x)||1;this.scale.x=b*a/this._texture.orig.width;this._width=a}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(a){var b=(0,g.sign)(this.scale.y)||
1;this.scale.y=b*a/this._texture.orig.height;this._height=a}},{key:"anchor",get:function(){return this._anchor},set:function(a){this._anchor.copy(a)}},{key:"tint",get:function(){return this._tint},set:function(a){this._tint=a;this._tintRGB=(a>>16)+(a&65280)+((a&255)<<16)}},{key:"texture",get:function(){return this._texture},set:function(a){if(this._texture!==a&&(this._texture=a,this.cachedTint=16777215,this._textureTrimmedID=this._textureID=-1,a))if(a.baseTexture.hasLoaded)this._onTextureUpdate();
else a.once("update",this._onTextureUpdate,this)}}]);return c}(a["default"]);f["default"]=a},{"../const":44,"../display/Container":46,"../math":68,"../textures/Texture":111,"../utils":119}],101:[function(a,c,f){f.__esModule=!0;c=(c=a("../../renderers/canvas/CanvasRenderer"))&&c.__esModule?c:{"default":c};var h=a("../../const"),n=a("../../math"),m=(a=a("./CanvasTinter"))&&a.__esModule?a:{"default":a},g=new n.Matrix;a=function(){function a(d){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");
this.renderer=d}a.prototype.render=function(a){var b=a._texture,d=this.renderer,e=b._frame.width,c=b._frame.height,f=a.transform.worldTransform,x,v;0>=b.orig.width||0>=b.orig.height||!b.baseTexture.source||(d.setBlendMode(a.blendMode),b.valid&&(d.context.globalAlpha=a.worldAlpha,x=b.baseTexture.scaleMode===h.SCALE_MODES.LINEAR,d.smoothProperty&&d.context[d.smoothProperty]!==x&&(d.context[d.smoothProperty]=x),b.trim?(x=b.trim.width/2+b.trim.x-a.anchor.x*b.orig.width,v=b.trim.height/2+b.trim.y-a.anchor.y*
b.orig.height):(x=(.5-a.anchor.x)*b.orig.width,v=(.5-a.anchor.y)*b.orig.height),b.rotate&&(f.copy(g),f=g,n.GroupD8.matrixAppendRotationInv(f,b.rotate,x,v),v=x=0),x-=e/2,v-=c/2,d.roundPixels?(d.context.setTransform(f.a,f.b,f.c,f.d,f.tx*d.resolution|0,f.ty*d.resolution|0),x|=0,v|=0):d.context.setTransform(f.a,f.b,f.c,f.d,f.tx*d.resolution,f.ty*d.resolution),f=b.baseTexture.resolution,16777215!==a.tint?(a.cachedTint!==a.tint&&(a.cachedTint=a.tint,a.tintedTexture=m["default"].getTintedTexture(a,a.tint)),
d.context.drawImage(a.tintedTexture,0,0,e*f,c*f,x*d.resolution,v*d.resolution,e*d.resolution,c*d.resolution)):d.context.drawImage(b.baseTexture.source,b._frame.x*f,b._frame.y*f,e*f,c*f,x*d.resolution,v*d.resolution,e*d.resolution,c*d.resolution)))};a.prototype.destroy=function(){this.renderer=null};return a}();f["default"]=a;c["default"].registerPlugin("sprite",a)},{"../../const":44,"../../math":68,"../../renderers/canvas/CanvasRenderer":75,"./CanvasTinter":102}],102:[function(a,c,f){f.__esModule=
!0;var h=a("../../utils");a=(a=a("../../renderers/canvas/utils/canUseNewCanvasBlendModes"))&&a.__esModule?a:{"default":a};var n={getTintedTexture:function(a,c){var d=a.texture;c=n.roundColor(c);var e="#"+("00000"+(c|0).toString(16)).substr(-6);d.tintCache=d.tintCache||{};if(d.tintCache[e])return d.tintCache[e];var b=n.canvas||document.createElement("canvas");n.tintMethod(d,c,b);if(n.convertTintToImage){var g=new Image;g.src=b.toDataURL();d.tintCache[e]=g}else d.tintCache[e]=b,n.canvas=null;return b},
tintWithMultiply:function(a,c,d){var e=d.getContext("2d"),b=a._frame.clone(),g=a.baseTexture.resolution;b.x*=g;b.y*=g;b.width*=g;b.height*=g;d.width=b.width;d.height=b.height;e.fillStyle="#"+("00000"+(c|0).toString(16)).substr(-6);e.fillRect(0,0,b.width,b.height);e.globalCompositeOperation="multiply";e.drawImage(a.baseTexture.source,b.x,b.y,b.width,b.height,0,0,b.width,b.height);e.globalCompositeOperation="destination-atop";e.drawImage(a.baseTexture.source,b.x,b.y,b.width,b.height,0,0,b.width,b.height)},
tintWithOverlay:function(a,c,d){var e=d.getContext("2d"),b=a._frame.clone(),g=a.baseTexture.resolution;b.x*=g;b.y*=g;b.width*=g;b.height*=g;d.width=b.width;d.height=b.height;e.globalCompositeOperation="copy";e.fillStyle="#"+("00000"+(c|0).toString(16)).substr(-6);e.fillRect(0,0,b.width,b.height);e.globalCompositeOperation="destination-atop";e.drawImage(a.baseTexture.source,b.x,b.y,b.width,b.height,0,0,b.width,b.height)},tintWithPerPixel:function(a,c,d){var e=d.getContext("2d"),b=a._frame.clone(),
g=a.baseTexture.resolution;b.x*=g;b.y*=g;b.width*=g;b.height*=g;d.width=b.width;d.height=b.height;e.globalCompositeOperation="copy";e.drawImage(a.baseTexture.source,b.x,b.y,b.width,b.height,0,0,b.width,b.height);d=(0,h.hex2rgb)(c);a=d[0];c=d[1];d=d[2];for(var b=e.getImageData(0,0,b.width,b.height),g=b.data,f=0;f<g.length;f+=4)g[f+0]*=a,g[f+1]*=c,g[f+2]*=d;e.putImageData(b,0,0)},roundColor:function(a){var c=n.cacheStepsPerColorChannel;a=(0,h.hex2rgb)(a);a[0]=Math.min(255,a[0]/c*c);a[1]=Math.min(255,
a[1]/c*c);a[2]=Math.min(255,a[2]/c*c);return(0,h.rgb2hex)(a)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:(0,a["default"])(),tintMethod:0};n.tintMethod=n.canUseMultiply?n.tintWithMultiply:n.tintWithPerPixel;f["default"]=n},{"../../renderers/canvas/utils/canUseNewCanvasBlendModes":78,"../../utils":119}],103:[function(a,c,f){f.__esModule=!0;a=function(){function a(c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.vertices=new ArrayBuffer(c);
this.float32View=new Float32Array(this.vertices);this.uint32View=new Uint32Array(this.vertices)}a.prototype.destroy=function(){this.colors=this.uvs=this.positions=this.vertices=null};return a}();f["default"]=a},{}],104:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}function n(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,
writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;c=a("../../renderers/webgl/utils/ObjectRenderer");c=h(c);var m=a("../../renderers/webgl/WebGLRenderer"),m=h(m),g=a("../../utils/createIndicesForQuads"),d=h(g),g=a("./generateMultiTextureShader"),e=h(g),g=a("../../renderers/webgl/utils/checkMaxIfStatmentsInShader"),b=h(g),g=a("./BatchBuffer"),p=h(g),g=a("../../settings"),r=h(g),g=a("pixi-gl-core"),q=h(g);a=a("bit-twiddle");var y=h(a),
x=0,v=0;a=function(a){function c(b){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");b=a.call(this,b);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==typeof b&&"function"!==typeof b?this:b;b.vertSize=5;b.vertByteSize=4*b.vertSize;b.size=r["default"].SPRITE_BATCH_SIZE;b.buffers=[];for(var e=1;e<=y["default"].nextPow2(b.size);e*=2)b.buffers.push(new p["default"](4*e*b.vertByteSize));b.indices=(0,d["default"])(b.size);
b.shader=null;x=b.currentIndex=0;b.groups=[];for(e=0;e<b.size;e++)b.groups[e]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0};b.sprites=[];b.vertexBuffers=[];b.vaos=[];b.vaoMax=2;b.vertexCount=0;b.renderer.on("prerender",b.onPrerender,b);return b}n(c,a);c.prototype.onContextChange=function(){var a=this.renderer.gl;this.MAX_TEXTURES=Math.min(a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),r["default"].SPRITE_MAX_TEXTURES);this.MAX_TEXTURES=(0,b["default"])(this.MAX_TEXTURES,a);var d=this.shader=
(0,e["default"])(a,this.MAX_TEXTURES);this.indexBuffer=q["default"].GLBuffer.createIndexBuffer(a,this.indices,a.STATIC_DRAW);this.renderer.bindVao(null);for(var c=0;c<this.vaoMax;c++)this.vertexBuffers[c]=q["default"].GLBuffer.createVertexBuffer(a,null,a.STREAM_DRAW),this.vaos[c]=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(this.vertexBuffers[c],d.attributes.aVertexPosition,a.FLOAT,!1,this.vertByteSize,0).addAttribute(this.vertexBuffers[c],d.attributes.aTextureCoord,a.UNSIGNED_SHORT,
!0,this.vertByteSize,8).addAttribute(this.vertexBuffers[c],d.attributes.aColor,a.UNSIGNED_BYTE,!0,this.vertByteSize,12).addAttribute(this.vertexBuffers[c],d.attributes.aTextureId,a.FLOAT,!1,this.vertByteSize,16);this.vao=this.vaos[0];this.currentBlendMode=99999;this.boundTextures=Array(this.MAX_TEXTURES)};c.prototype.onPrerender=function(){this.vertexCount=0};c.prototype.render=function(a){this.currentIndex>=this.size&&this.flush();a._texture._uvs&&(this.sprites[this.currentIndex++]=a)};c.prototype.flush=
function(){if(0!==this.currentIndex){var a=this.renderer.gl,b=this.MAX_TEXTURES,d=y["default"].nextPow2(this.currentIndex),d=y["default"].log2(d),e=this.buffers[d],c=this.sprites,d=this.groups,g=e.float32View,f=e.uint32View,p=this.boundTextures,m=this.renderer.boundTextures,h=this.renderer.textureGC.count,n=0,u,t=void 0,R=1,S=0,M=d[0],J,O,T=c[0].blendMode;M.textureCount=0;M.start=0;M.blend=T;x++;var K;for(K=0;K<b;++K)p[K]=m[K],p[K]._virtalBoundId=K;for(K=0;K<this.currentIndex;++K){var Q=c[K];u=Q._texture.baseTexture;
T!==Q.blendMode&&(T=Q.blendMode,t=null,S=b,x++);if(t!==u&&(t=u,u._enabled!==x)){S===b&&(x++,M.size=K-M.start,S=0,M=d[R++],M.blend=T,M.textureCount=0,M.start=K);u.touched=h;if(-1===u._virtalBoundId)for(J=0;J<b;++J){O=(J+v)%b;var L=p[O];if(L._enabled!==x){v++;L._virtalBoundId=-1;u._virtalBoundId=O;p[O]=u;break}}u._enabled=x;M.textureCount++;M.ids[S]=u._virtalBoundId;M.textures[S++]=u}J=Q.vertexData;O=Q._texture._uvs.uvsUint32;this.renderer.roundPixels?(L=this.renderer.resolution,g[n]=(J[0]*L|0)/L,g[n+
1]=(J[1]*L|0)/L,g[n+5]=(J[2]*L|0)/L,g[n+6]=(J[3]*L|0)/L,g[n+10]=(J[4]*L|0)/L,g[n+11]=(J[5]*L|0)/L,g[n+15]=(J[6]*L|0)/L,g[n+16]=(J[7]*L|0)/L):(g[n]=J[0],g[n+1]=J[1],g[n+5]=J[2],g[n+6]=J[3],g[n+10]=J[4],g[n+11]=J[5],g[n+15]=J[6],g[n+16]=J[7]);f[n+2]=O[0];f[n+7]=O[1];f[n+12]=O[2];f[n+17]=O[3];f[n+3]=f[n+8]=f[n+13]=f[n+18]=Q._tintRGB+(255*Math.min(Q.worldAlpha,1)<<24);g[n+4]=g[n+9]=g[n+14]=g[n+19]=u._virtalBoundId;n+=20}M.size=K-M.start;r["default"].CAN_UPLOAD_SAME_BUFFER?this.vertexBuffers[this.vertexCount].upload(e.vertices,
0,!0):(this.vaoMax<=this.vertexCount&&(this.vaoMax++,this.vertexBuffers[this.vertexCount]=q["default"].GLBuffer.createVertexBuffer(a,null,a.STREAM_DRAW),this.vaos[this.vertexCount]=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(this.vertexBuffers[this.vertexCount],this.shader.attributes.aVertexPosition,a.FLOAT,!1,this.vertByteSize,0).addAttribute(this.vertexBuffers[this.vertexCount],this.shader.attributes.aTextureCoord,a.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(this.vertexBuffers[this.vertexCount],
this.shader.attributes.aColor,a.UNSIGNED_BYTE,!0,this.vertByteSize,12).addAttribute(this.vertexBuffers[this.vertexCount],this.shader.attributes.aTextureId,a.FLOAT,!1,this.vertByteSize,16)),this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(e.vertices,0,!1),this.vertexCount++);for(K=0;K<b;++K)m[K]._virtalBoundId=-1;for(K=0;K<R;++K){b=d[K];e=b.textureCount;for(c=0;c<e;c++)t=b.textures[c],m[b.ids[c]]!==t&&this.renderer.bindTexture(t,b.ids[c],!0),t._virtalBoundId=
-1;this.renderer.state.setBlendMode(b.blend);a.drawElements(a.TRIANGLES,6*b.size,a.UNSIGNED_SHORT,12*b.start)}this.currentIndex=0}};c.prototype.start=function(){this.renderer.bindShader(this.shader);r["default"].CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())};c.prototype.stop=function(){this.flush()};c.prototype.destroy=function(){for(var b=0;b<this.vaoMax;b++)this.vertexBuffers[b]&&this.vertexBuffers[b].destroy(),this.vaos[b]&&
this.vaos[b].destroy();this.indexBuffer&&this.indexBuffer.destroy();this.renderer.off("prerender",this.onPrerender,this);a.prototype.destroy.call(this);this.shader&&(this.shader.destroy(),this.shader=null);this.sprites=this.indices=this.indexBuffer=this.vaos=this.vertexBuffers=null;for(b=0;b<this.buffers.length;++b)this.buffers[b].destroy()};return c}(c["default"]);f["default"]=a;m["default"].registerPlugin("sprite",a)},{"../../renderers/webgl/WebGLRenderer":82,"../../renderers/webgl/utils/ObjectRenderer":92,
"../../renderers/webgl/utils/checkMaxIfStatmentsInShader":95,"../../settings":99,"../../utils/createIndicesForQuads":117,"./BatchBuffer":103,"./generateMultiTextureShader":105,"bit-twiddle":1,"pixi-gl-core":12}],105:[function(a,c,f){function h(a){var d;d="\n\n";for(var e=0;e<a;e++)0<e&&(d+="\nelse "),e<a-1&&(d+="if(textureId == "+e+".0)"),d+="\n{",d+="\n\tcolor = texture2D(uSamplers["+e+"], vTextureCoord);",d+="\n}";return d+"\n\n"}f.__esModule=!0;f["default"]=function(a,d){for(var e=m,e=e.replace(/%count%/gi,
d),e=e.replace(/%forloop%/gi,h(d)),e=new n["default"](a,"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n",
e),b=[],c=0;c<d;c++)b[c]=c;e.bind();e.uniforms.uSamplers=b;return e};var n=(c=a("../../Shader"))&&c.__esModule?c:{"default":c};a("path");var m="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\nvoid main(void){\nvec4 color;\nfloat textureId = floor(vTextureId+0.5);\n%forloop%\ngl_FragColor = color * vColor;\n}"},{"../../Shader":42,path:22}],106:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}function n(a,b){if("function"!==
typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;var m=function(){function a(a,b){for(var d=0;d<b.length;d++){var e=b[d];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,
d,e){d&&a(b.prototype,d);e&&a(b,e);return b}}();c=a("../sprites/Sprite");c=h(c);var g=a("../textures/Texture"),d=h(g),e=a("../math"),b=a("../utils"),p=a("../const"),g=a("../settings"),r=h(g);a=a("./TextStyle");var q=h(a),y={texture:!0,children:!1,baseTexture:!0};a=function(a){function c(b,g,f){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");f=f||document.createElement("canvas");f.width=3;f.height=3;var p=d["default"].fromCanvas(f);p.orig=new e.Rectangle;p.trim=new e.Rectangle;
p=a.call(this,p);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");p=!p||"object"!==typeof p&&"function"!==typeof p?this:p;p.canvas=f;p.context=p.canvas.getContext("2d");p.resolution=r["default"].RESOLUTION;p._text=null;p._style=null;p._styleListener=null;p._font="";p.text=b;p.style=g;p.localStyleID=-1;return p}n(c,a);c.prototype.updateText=function(a){var b=this._style;this.localStyleID!==b.styleID&&(this.dirty=!0,this.localStyleID=b.styleID);if(this.dirty||
!a){this._font=c.getFontStyle(b);this.context.font=this._font;a=(b.wordWrap?this.wordWrap(this._text):this._text).split(/(?:\r\n|\r|\n)/);for(var d=Array(a.length),e=0,g=c.calculateFontProperties(this._font),f=0;f<a.length;f++){var p=this.context.measureText(a[f]).width+(a[f].length-1)*b.letterSpacing;d[f]=p;e=Math.max(e,p)}f=e+b.strokeThickness;b.dropShadow&&(f+=b.dropShadowDistance);this.canvas.width=Math.ceil((f+2*b.padding)*this.resolution);f=b.lineHeight||g.fontSize+b.strokeThickness;p=Math.max(f,
g.fontSize+b.strokeThickness)+(a.length-1)*f;b.dropShadow&&(p+=b.dropShadowDistance);this.canvas.height=Math.ceil((p+2*b.padding)*this.resolution);this.context.scale(this.resolution,this.resolution);this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.context.font=this._font;this.context.strokeStyle=b.stroke;this.context.lineWidth=b.strokeThickness;this.context.textBaseline=b.textBaseline;this.context.lineJoin=b.lineJoin;this.context.miterLimit=b.miterLimit;var m;if(b.dropShadow){0<
b.dropShadowBlur?(this.context.shadowColor=b.dropShadowColor,this.context.shadowBlur=b.dropShadowBlur):this.context.fillStyle=b.dropShadowColor;for(var h=Math.cos(b.dropShadowAngle)*b.dropShadowDistance,n=Math.sin(b.dropShadowAngle)*b.dropShadowDistance,q=0;q<a.length;q++)p=b.strokeThickness/2,m=b.strokeThickness/2+q*f+g.ascent,"right"===b.align?p+=e-d[q]:"center"===b.align&&(p+=(e-d[q])/2),b.fill&&(this.drawLetterSpacing(a[q],p+h+b.padding,m+n+b.padding),b.stroke&&b.strokeThickness&&(this.context.strokeStyle=
b.dropShadowColor,this.drawLetterSpacing(a[q],p+h+b.padding,m+n+b.padding,!0),this.context.strokeStyle=b.stroke))}this.context.fillStyle=this._generateFillStyle(b,a);for(h=0;h<a.length;h++)p=b.strokeThickness/2,m=b.strokeThickness/2+h*f+g.ascent,"right"===b.align?p+=e-d[h]:"center"===b.align&&(p+=(e-d[h])/2),b.stroke&&b.strokeThickness&&this.drawLetterSpacing(a[h],p+b.padding,m+b.padding,!0),b.fill&&this.drawLetterSpacing(a[h],p+b.padding,m+b.padding);this.updateTexture()}};c.prototype.drawLetterSpacing=
function(a,b,d){var e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!1,c=this._style.letterSpacing;if(0===c)e?this.context.strokeText(a,b,d):this.context.fillText(a,b,d);else for(var g=String.prototype.split.call(a,""),f=b,p=0,m;p<a.length;)m=g[p++],e?this.context.strokeText(m,f,d):this.context.fillText(m,f,d),f+=this.context.measureText(m).width+c};c.prototype.updateTexture=function(){var a=this._texture,b=this._style;a.baseTexture.hasLoaded=!0;a.baseTexture.resolution=this.resolution;a.baseTexture.realWidth=
this.canvas.width;a.baseTexture.realHeight=this.canvas.height;a.baseTexture.width=this.canvas.width/this.resolution;a.baseTexture.height=this.canvas.height/this.resolution;a.trim.width=a._frame.width=this.canvas.width/this.resolution;a.trim.height=a._frame.height=this.canvas.height/this.resolution;a.trim.x=-b.padding;a.trim.y=-b.padding;a.orig.width=a._frame.width-2*b.padding;a.orig.height=a._frame.height-2*b.padding;this._onTextureUpdate();a.baseTexture.emit("update",a.baseTexture);this.dirty=!1};
c.prototype.renderWebGL=function(b){this.resolution!==b.resolution&&(this.resolution=b.resolution,this.dirty=!0);this.updateText(!0);a.prototype.renderWebGL.call(this,b)};c.prototype._renderCanvas=function(b){this.resolution!==b.resolution&&(this.resolution=b.resolution,this.dirty=!0);this.updateText(!0);a.prototype._renderCanvas.call(this,b)};c.prototype.wordWrap=function(a){var b="",d=this._style;a=a.split("\n");for(var e=d.wordWrapWidth,c=0;c<a.length;c++){for(var g=e,f=a[c].split(" "),p=0;p<f.length;p++){var m=
this.context.measureText(f[p]).width;if(d.breakWords&&m>e)for(var m=f[p].split(""),h=0;h<m.length;h++){var n=this.context.measureText(m[h]).width;n>g?(b+="\n"+m[h],g=e-n):(0===h&&(b+=" "),b+=m[h],g-=n)}else h=m+this.context.measureText(" ").width,0===p||h>g?(0<p&&(b+="\n"),b+=f[p],g=e-m):(g-=h,b+=" "+f[p])}c<a.length-1&&(b+="\n")}return b};c.prototype._calculateBounds=function(){this.updateText(!0);this.calculateVertices();this._bounds.addQuad(this.vertexData)};c.prototype._onStyleChange=function(){this.dirty=
!0};c.prototype._generateFillStyle=function(a,b){if(!Array.isArray(a.fill))return a.fill;if(navigator.isCocoonJS)return a.fill[0];var d,e,c,g;d=this.canvas.width/this.resolution;e=this.canvas.height/this.resolution;if(a.fillGradientType===p.TEXT_GRADIENT.LINEAR_VERTICAL){d=this.context.createLinearGradient(d/2,0,d/2,e);e=(a.fill.length+1)*b.length;for(var f=c=0;f<b.length;f++){c+=1;for(var m=0;m<a.fill.length;m++)g=c/e,d.addColorStop(g,a.fill[m]),c++}}else for(d=this.context.createLinearGradient(0,
e/2,d,e/2),e=a.fill.length+1,c=1,f=0;f<a.fill.length;f++)g=c/e,d.addColorStop(g,a.fill[f]),c++;return d};c.prototype.destroy=function(b){"boolean"===typeof b&&(b={children:b});b=Object.assign({},y,b);a.prototype.destroy.call(this,b);this._style=this.canvas=this.context=null};c.getFontStyle=function(a){a=a||{};a instanceof q["default"]||(a=new q["default"](a));var b="number"===typeof a.fontSize?a.fontSize+"px":a.fontSize,d=a.fontFamily;Array.isArray(a.fontFamily)||(d=a.fontFamily.split(","));for(var e=
d.length-1;0<=e;e--){var c=d[e].trim();/([\"\'])[^\'\"]+\1/.test(c)||(c='"'+c+'"');d[e]=c}return a.fontStyle+" "+a.fontVariant+" "+a.fontWeight+" "+b+" "+d.join(",")};c.calculateFontProperties=function(a){if(c.fontPropertiesCache[a])return c.fontPropertiesCache[a];var b={},d=c.fontPropertiesCanvas,e=c.fontPropertiesContext;e.font=a;var g=Math.ceil(e.measureText("|M\u00c9q").width),f=Math.ceil(e.measureText("M").width),p=2*f,f=1.4*f|0;d.width=g;d.height=p;e.fillStyle="#f00";e.fillRect(0,0,g,p);e.font=
a;e.textBaseline="alphabetic";e.fillStyle="#000";e.fillText("|M\u00c9q",0,f);var d=e.getImageData(0,0,g,p).data,e=d.length,g=4*g,m,h=0,n=!1;for(m=0;m<f;++m){for(var q=0;q<g;q+=4)if(255!==d[h+q]){n=!0;break}if(n)break;else h+=g}b.ascent=f-m;h=e-g;n=!1;for(m=p;m>f;--m){for(p=0;p<g;p+=4)if(255!==d[h+p]){n=!0;break}if(n)break;else h-=g}b.descent=m-f;b.fontSize=b.ascent+b.descent;return c.fontPropertiesCache[a]=b};m(c,[{key:"width",get:function(){this.updateText(!0);return Math.abs(this.scale.x)*this._texture.orig.width},
set:function(a){this.updateText(!0);var d=(0,b.sign)(this.scale.x)||1;this.scale.x=d*a/this._texture.orig.width;this._width=a}},{key:"height",get:function(){this.updateText(!0);return Math.abs(this.scale.y)*this._texture.orig.height},set:function(a){this.updateText(!0);var d=(0,b.sign)(this.scale.y)||1;this.scale.y=d*a/this._texture.orig.height;this._height=a}},{key:"style",get:function(){return this._style},set:function(a){a=a||{};this._style=a instanceof q["default"]?a:new q["default"](a);this.localStyleID=
-1;this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(a){a=String(a||" ");this._text!==a&&(this._text=a,this.dirty=!0)}}]);return c}(c["default"]);f["default"]=a;a.fontPropertiesCache={};a.fontPropertiesCanvas=document.createElement("canvas");a.fontPropertiesContext=a.fontPropertiesCanvas.getContext("2d")},{"../const":44,"../math":68,"../settings":99,"../sprites/Sprite":100,"../textures/Texture":111,"../utils":119,"./TextStyle":107}],107:[function(a,c,f){function h(a){if("number"===
typeof a)return(0,g.hex2string)(a);"string"===typeof a&&0===a.indexOf("0x")&&(a=a.replace("0x","#"));return a}function n(a){if(Array.isArray(a)){for(var b=0;b<a.length;++b)a[b]=h(a[b]);return a}return h(a)}f.__esModule=!0;var m=function(){function a(a,d){for(var b=0;b<d.length;b++){var e=d[b];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,d,e){d&&a(b.prototype,d);e&&a(b,e);return b}}();c=a("../const");var g=a("../utils"),
d={align:"left",breakWords:!1,dropShadow:!1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"#000000",dropShadowDistance:5,fill:"black",fillGradientType:c.TEXT_GRADIENT.LINEAR_VERTICAL,fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",wordWrap:!1,wordWrapWidth:100};a=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");
this.styleID=0;Object.assign(this,d,b)}a.prototype.clone=function(){var b={},e;for(e in d)b[e]=this[e];return new a(b)};a.prototype.reset=function(){Object.assign(this,d)};m(a,[{key:"align",get:function(){return this._align},set:function(a){this._align!==a&&(this._align=a,this.styleID++)}},{key:"breakWords",get:function(){return this._breakWords},set:function(a){this._breakWords!==a&&(this._breakWords=a,this.styleID++)}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(a){this._dropShadow!==
a&&(this._dropShadow=a,this.styleID++)}},{key:"dropShadowAngle",get:function(){return this._dropShadowAngle},set:function(a){this._dropShadowAngle!==a&&(this._dropShadowAngle=a,this.styleID++)}},{key:"dropShadowBlur",get:function(){return this._dropShadowBlur},set:function(a){this._dropShadowBlur!==a&&(this._dropShadowBlur=a,this.styleID++)}},{key:"dropShadowColor",get:function(){return this._dropShadowColor},set:function(a){a=n(a);this._dropShadowColor!==a&&(this._dropShadowColor=a,this.styleID++)}},
{key:"dropShadowDistance",get:function(){return this._dropShadowDistance},set:function(a){this._dropShadowDistance!==a&&(this._dropShadowDistance=a,this.styleID++)}},{key:"fill",get:function(){return this._fill},set:function(a){a=n(a);this._fill!==a&&(this._fill=a,this.styleID++)}},{key:"fillGradientType",get:function(){return this._fillGradientType},set:function(a){this._fillGradientType!==a&&(this._fillGradientType=a,this.styleID++)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(a){this.fontFamily!==
a&&(this._fontFamily=a,this.styleID++)}},{key:"fontSize",get:function(){return this._fontSize},set:function(a){this._fontSize!==a&&(this._fontSize=a,this.styleID++)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(a){this._fontStyle!==a&&(this._fontStyle=a,this.styleID++)}},{key:"fontVariant",get:function(){return this._fontVariant},set:function(a){this._fontVariant!==a&&(this._fontVariant=a,this.styleID++)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(a){this._fontWeight!==
a&&(this._fontWeight=a,this.styleID++)}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(a){this._letterSpacing!==a&&(this._letterSpacing=a,this.styleID++)}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(a){this._lineHeight!==a&&(this._lineHeight=a,this.styleID++)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(a){this._lineJoin!==a&&(this._lineJoin=a,this.styleID++)}},{key:"miterLimit",get:function(){return this._miterLimit},
set:function(a){this._miterLimit!==a&&(this._miterLimit=a,this.styleID++)}},{key:"padding",get:function(){return this._padding},set:function(a){this._padding!==a&&(this._padding=a,this.styleID++)}},{key:"stroke",get:function(){return this._stroke},set:function(a){a=n(a);this._stroke!==a&&(this._stroke=a,this.styleID++)}},{key:"strokeThickness",get:function(){return this._strokeThickness},set:function(a){this._strokeThickness!==a&&(this._strokeThickness=a,this.styleID++)}},{key:"textBaseline",get:function(){return this._textBaseline},
set:function(a){this._textBaseline!==a&&(this._textBaseline=a,this.styleID++)}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(a){this._wordWrap!==a&&(this._wordWrap=a,this.styleID++)}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(a){this._wordWrapWidth!==a&&(this._wordWrapWidth=a,this.styleID++)}}]);return a}();f["default"]=a},{"../const":44,"../utils":119}],108:[function(a,c,f){function h(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+
typeof d);a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});d&&(Object.setPrototypeOf?Object.setPrototypeOf(a,d):a.__proto__=d)}f.__esModule=!0;c=(c=a("./BaseTexture"))&&c.__esModule?c:{"default":c};a=(a=a("../settings"))&&a.__esModule?a:{"default":a};var n=a["default"].RESOLUTION,m=a["default"].SCALE_MODE;a=function(a){function d(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100,b=1<arguments.length&&void 0!==arguments[1]?
arguments[1]:100,c=arguments[2],g=arguments[3];if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var f;f=a.call(this,null,c);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");f=!f||"object"!==typeof f&&"function"!==typeof f?this:f;f.resolution=g||n;f.width=e;f.height=b;f.realWidth=f.width*f.resolution;f.realHeight=f.height*f.resolution;f.scaleMode=c||m;f.hasLoaded=!0;f._glRenderTargets={};f._canvasRenderTarget=null;f.valid=
!1;return f}h(d,a);d.prototype.resize=function(a,b){if(a!==this.width||b!==this.height)this.valid=0<a&&0<b,this.width=a,this.height=b,this.realWidth=this.width*this.resolution,this.realHeight=this.height*this.resolution,this.valid&&this.emit("update",this)};d.prototype.destroy=function(){a.prototype.destroy.call(this,!0);this.renderer=null};return d}(c["default"]);f["default"]=a},{"../settings":99,"./BaseTexture":109}],109:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}function n(a,
b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;var m="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?
"symbol":typeof a},g=a("../utils");c=a("../settings");var d=h(c);c=a("eventemitter3");c=h(c);var e=a("../utils/determineCrossOrigin"),b=h(e);a=a("bit-twiddle");var p=h(a);a=function(a){function e(b,c,f){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var p;p=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");p=!p||"object"!==typeof p&&"function"!==typeof p?this:p;p.uid=(0,g.uid)();p.touched=0;p.resolution=f||
d["default"].RESOLUTION;p.width=100;p.height=100;p.realWidth=100;p.realHeight=100;p.scaleMode=c||d["default"].SCALE_MODE;p.hasLoaded=!1;p.isLoading=!1;p.source=null;p.origSource=null;p.imageType=null;p.sourceScale=1;p.premultipliedAlpha=!0;p.imageUrl=null;p.isPowerOfTwo=!1;p.mipmap=d["default"].MIPMAP_TEXTURES;p.wrapMode=d["default"].WRAP_MODE;p._glTextures={};p._enabled=0;p._virtalBoundId=-1;b&&p.loadSource(b);return p}n(e,a);e.prototype.update=function(){"svg"!==this.imageType&&(this.realWidth=
this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=p["default"].isPow2(this.realWidth)&&p["default"].isPow2(this.realHeight));this.emit("update",this)};e.prototype.loadSource=function(a){var b=this,d=this.isLoading;this.isLoading=this.hasLoaded=!1;d&&this.source&&(this.source.onload=null,this.source.onerror=
null);var e=!this.source;this.source=a;if((a.src&&a.complete||a.getContext)&&a.width&&a.height)this._updateImageType(),"svg"===this.imageType?this._loadSvgSource():this._sourceLoaded(),e&&this.emit("loaded",this);else if(!a.getContext&&(e=function(){b.isLoading=!0;a.onload=function(){b._updateImageType();a.onload=null;a.onerror=null;b.isLoading&&(b.isLoading=!1,b._sourceLoaded(),"svg"===b.imageType?b._loadSvgSource():b.emit("loaded",b))};a.onerror=function(){a.onload=null;a.onerror=null;b.isLoading&&
(b.isLoading=!1,b.emit("error",b))};if(a.complete&&a.src){a.onload=null;a.onerror=null;if("svg"===b.imageType)return b._loadSvgSource(),{v:void 0};b.isLoading=!1;a.width&&a.height?(b._sourceLoaded(),d&&b.emit("loaded",b)):d&&b.emit("error",b)}}(),"object"===("undefined"===typeof e?"undefined":m(e))))return e.v};e.prototype._updateImageType=function(){if(this.imageUrl){var a=(0,g.decomposeDataUri)(this.imageUrl);if(a&&"image"===a.mediaType){if(a=a.subType.split("+")[0],a=(0,g.getUrlFileExtension)("."+
a),!a)throw Error("Invalid image type in data URI.");}else(a=(0,g.getUrlFileExtension)(this.imageUrl))||(a="png");this.imageType=a}};e.prototype._loadSvgSource=function(){if("svg"===this.imageType){var a=(0,g.decomposeDataUri)(this.imageUrl);a?this._loadSvgSourceUsingDataUri(a):this._loadSvgSourceUsingXhr()}};e.prototype._loadSvgSourceUsingDataUri=function(a){if("base64"===a.encoding){if(!atob)throw Error("Your browser doesn't support base64 conversions.");a=atob(a.data)}else a=a.data;this._loadSvgSourceUsingString(a)};
e.prototype._loadSvgSourceUsingXhr=function(){var a=this,b=new XMLHttpRequest;b.onload=function(){if(b.readyState!==b.DONE||200!==b.status)throw Error("Failed to load SVG using XHR.");a._loadSvgSourceUsingString(b.response)};b.onerror=function(){return a.emit("error",a)};b.open("GET",this.imageUrl,!0);b.send()};e.prototype._loadSvgSourceUsingString=function(a){var b=(0,g.getSvgSize)(a);a=b.width;b=b.height;if(!a||!b)throw Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");
this.realWidth=Math.round(a*this.sourceScale);this.realHeight=Math.round(b*this.sourceScale);this.width=this.realWidth/this.resolution;this.height=this.realHeight/this.resolution;this.isPowerOfTwo=p["default"].isPow2(this.realWidth)&&p["default"].isPow2(this.realHeight);var d=document.createElement("canvas");d.width=this.realWidth;d.height=this.realHeight;d._pixiId="canvas_"+(0,g.uid)();d.getContext("2d").drawImage(this.source,0,0,a,b,0,0,this.realWidth,this.realHeight);this.origSource=this.source;
this.source=d;g.BaseTextureCache[d._pixiId]=this;this.isLoading=!1;this._sourceLoaded();this.emit("loaded",this)};e.prototype._sourceLoaded=function(){this.hasLoaded=!0;this.update()};e.prototype.destroy=function(){this.imageUrl&&(delete g.BaseTextureCache[this.imageUrl],delete g.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src=""));this.source&&this.source._pixiId&&delete g.BaseTextureCache[this.source._pixiId];this.source=null;this.dispose()};e.prototype.dispose=
function(){this.emit("dispose",this)};e.prototype.updateSourceImage=function(a){this.source.src=a;this.loadSource(this.source)};e.fromImage=function(a,d,c,f){var p=g.BaseTextureCache[a];if(!p){var m=new Image;void 0===d&&0!==a.indexOf("data:")&&(m.crossOrigin=(0,b["default"])(a));p=new e(m,c);p.imageUrl=a;f&&(p.sourceScale=f);p.resolution=(0,g.getResolutionOfUrl)(a);m.src=a;g.BaseTextureCache[a]=p}return p};e.fromCanvas=function(a,b){a._pixiId||(a._pixiId="canvas_"+(0,g.uid)());var d=g.BaseTextureCache[a._pixiId];
d||(d=new e(a,b),g.BaseTextureCache[a._pixiId]=d);return d};return e}(c["default"]);f["default"]=a},{"../settings":99,"../utils":119,"../utils/determineCrossOrigin":118,"bit-twiddle":1,eventemitter3:3}],110:[function(a,c,f){function h(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,
c):a.__proto__=c)}f.__esModule=!0;var n=(c=a("./BaseRenderTexture"))&&c.__esModule?c:{"default":c};a=a("./Texture");a=function(a){function c(d,e,b,g,f){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var p=null;if(!(d instanceof n["default"])){var m=e;g=g||0;f=f||1;console.warn("Please use RenderTexture.create("+m+", "+b+") instead of the ctor directly.");p=d;e=null;d=new n["default"](m,b,g,f)}d=a.call(this,d,e);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
d=!d||"object"!==typeof d&&"function"!==typeof d?this:d;d.legacyRenderer=p;d.valid=!0;d._updateUvs();return d}h(c,a);c.prototype.resize=function(a,e,b){this.valid=0<a&&0<e;this._frame.width=this.orig.width=a;this._frame.height=this.orig.height=e;b||this.baseTexture.resize(a,e);this._updateUvs()};c.create=function(a,e,b,g){return new c(new n["default"](a,e,b,g))};return c}((a&&a.__esModule?a:{"default":a})["default"]);f["default"]=a},{"./BaseRenderTexture":108,"./Texture":111}],111:[function(a,c,f){function h(a){return a&&
a.__esModule?a:{"default":a}}function n(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;var m=function(){function a(a,b){for(var d=0;d<b.length;d++){var e=b[d];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=
!0);Object.defineProperty(a,e.key,e)}}return function(b,d,e){d&&a(b.prototype,d);e&&a(b,e);return b}}();c=a("./BaseTexture");var g=h(c);c=a("./VideoBaseTexture");var d=h(c);c=a("./TextureUvs");var e=h(c);c=a("eventemitter3");c=h(c);var b=a("../math"),p=a("../utils");a=function(a){function c(d,e,g,f,p){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var m;m=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");m=
!m||"object"!==typeof m&&"function"!==typeof m?this:m;m.noFrame=!1;e||(m.noFrame=!0,e=new b.Rectangle(0,0,1,1));d instanceof c&&(d=d.baseTexture);m.baseTexture=d;m._frame=e;m.trim=f;m.valid=!1;m.requiresUpdate=!1;m._uvs=null;m.orig=g||e;m._rotate=Number(p||0);if(!0===p)m._rotate=2;else if(0!==m._rotate%2)throw Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");if(d.hasLoaded)m.noFrame&&(e=new b.Rectangle(0,0,d.width,d.height),d.on("update",m.onBaseTextureUpdated,m)),
m.frame=e;else d.once("loaded",m.onBaseTextureLoaded,m);m._updateID=0;m.transform=null;return m}n(c,a);c.prototype.update=function(){this.baseTexture.update()};c.prototype.onBaseTextureLoaded=function(a){this._updateID++;this.frame=this.noFrame?new b.Rectangle(0,0,a.width,a.height):this._frame;this.baseTexture.on("update",this.onBaseTextureUpdated,this);this.emit("update",this)};c.prototype.onBaseTextureUpdated=function(a){this._updateID++;this._frame.width=a.width;this._frame.height=a.height;this.emit("update",
this)};c.prototype.destroy=function(a){this.baseTexture&&(a&&(p.TextureCache[this.baseTexture.imageUrl]&&delete p.TextureCache[this.baseTexture.imageUrl],this.baseTexture.destroy()),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null);this.orig=this.trim=this._uvs=this._frame=null;this.valid=!1;this.off("dispose",this.dispose,this);this.off("update",this.update,this)};c.prototype.clone=function(){return new c(this.baseTexture,
this.frame,this.orig,this.trim,this.rotate)};c.prototype._updateUvs=function(){this._uvs||(this._uvs=new e["default"]);this._uvs.set(this._frame,this.baseTexture,this.rotate);this._updateID++};c.fromImage=function(a,b,d,e){var f=p.TextureCache[a];f||(f=new c(g["default"].fromImage(a,b,d,e)),p.TextureCache[a]=f);return f};c.fromFrame=function(a){var b=p.TextureCache[a];if(!b)throw Error('The frameId "'+a+'" does not exist in the texture cache');return b};c.fromCanvas=function(a,b){return new c(g["default"].fromCanvas(a,
b))};c.fromVideo=function(a,b){return"string"===typeof a?c.fromVideoUrl(a,b):new c(d["default"].fromVideo(a,b))};c.fromVideoUrl=function(a,b){return new c(d["default"].fromUrl(a,b))};c.from=function(a){if("string"===typeof a){var b=p.TextureCache[a];return b?b:null!==a.match(/\.(mp4|webm|ogg|h264|avi|mov)$/)?c.fromVideoUrl(a):c.fromImage(a)}return a instanceof HTMLImageElement?new c(new g["default"](a)):a instanceof HTMLCanvasElement?c.fromCanvas(a):a instanceof HTMLVideoElement?c.fromVideo(a):a instanceof
g["default"]?new c(a):a};c.addTextureToCache=function(a,b){p.TextureCache[b]=a};c.removeTextureFromCache=function(a){var b=p.TextureCache[a];delete p.TextureCache[a];delete p.BaseTextureCache[a];return b};m(c,[{key:"frame",get:function(){return this._frame},set:function(a){this._frame=a;this.noFrame=!1;if(a.x+a.width>this.baseTexture.width||a.y+a.height>this.baseTexture.height)throw Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=a&&a.width&&a.height&&
this.baseTexture.hasLoaded;this.trim||this.rotate||(this.orig=a);this.valid&&this._updateUvs()}},{key:"rotate",get:function(){return this._rotate},set:function(a){this._rotate=a;this.valid&&this._updateUvs()}},{key:"width",get:function(){return this.orig.width}},{key:"height",get:function(){return this.orig.height}}]);return c}(c["default"]);f["default"]=a;a.EMPTY=new a(new g["default"]);a.EMPTY.destroy=function(){};a.EMPTY.on=function(){};a.EMPTY.once=function(){};a.EMPTY.emit=function(){}},{"../math":68,
"../utils":119,"./BaseTexture":109,"./TextureUvs":112,"./VideoBaseTexture":113,eventemitter3:3}],112:[function(a,c,f){f.__esModule=!0;var h=(a=a("../math/GroupD8"))&&a.__esModule?a:{"default":a};a=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.y0=this.x0=0;this.x1=1;this.y1=0;this.y2=this.x2=1;this.x3=0;this.y3=1;this.uvsUint32=new Uint32Array(4)}a.prototype.set=function(a,c,d){var e=c.width,b=c.height;if(d){c=a.width/2/e;var g=a.height/
2/b,e=a.x/e+c;a=a.y/b+g;d=h["default"].add(d,h["default"].NW);this.x0=e+c*h["default"].uX(d);this.y0=a+g*h["default"].uY(d);d=h["default"].add(d,2);this.x1=e+c*h["default"].uX(d);this.y1=a+g*h["default"].uY(d);d=h["default"].add(d,2);this.x2=e+c*h["default"].uX(d);this.y2=a+g*h["default"].uY(d);d=h["default"].add(d,2);this.x3=e+c*h["default"].uX(d);this.y3=a+g*h["default"].uY(d)}else this.x0=a.x/e,this.y0=a.y/b,this.x1=(a.x+a.width)/e,this.y1=a.y/b,this.x2=(a.x+a.width)/e,this.y2=(a.y+a.height)/b,
this.x3=a.x/e,this.y3=(a.y+a.height)/b;this.uvsUint32[0]=(65535*this.y0&65535)<<16|65535*this.x0&65535;this.uvsUint32[1]=(65535*this.y1&65535)<<16|65535*this.x1&65535;this.uvsUint32[2]=(65535*this.y2&65535)<<16|65535*this.x2&65535;this.uvsUint32[3]=(65535*this.y3&65535)<<16|65535*this.x3&65535};return a}();f["default"]=a},{"../math/GroupD8":64}],113:[function(a,c,f){function h(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);
a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function n(a,b){b||(b="video/"+a.substr(a.lastIndexOf(".")+1));var d=document.createElement("source");d.src=a;d.type=b;return d}f.__esModule=!0;var m=function(){function a(a,d){for(var b=0;b<d.length;b++){var e=d[b];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}
return function(b,d,e){d&&a(b.prototype,d);e&&a(b,e);return b}}();c=(c=a("./BaseTexture"))&&c.__esModule?c:{"default":c};var g=a("../utils"),d=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../ticker"));a=function(a){function b(d,e){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");if(!d)throw Error("No video source element specified.");(d.readyState===d.HAVE_ENOUGH_DATA||
d.readyState===d.HAVE_FUTURE_DATA)&&d.width&&d.height&&(d.complete=!0);var c;c=a.call(this,d,e);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;c.width=d.videoWidth;c.height=d.videoHeight;c._autoUpdate=!0;c._isAutoUpdating=!1;c.autoPlay=!0;c.update=c.update.bind(c);c._onCanPlay=c._onCanPlay.bind(c);d.addEventListener("play",c._onPlayStart.bind(c));d.addEventListener("pause",c._onPlayStop.bind(c));
c.hasLoaded=!1;c.__loaded=!1;c._isSourceReady()?c._onCanPlay():(d.addEventListener("canplay",c._onCanPlay),d.addEventListener("canplaythrough",c._onCanPlay));return c}h(b,a);b.prototype._isSourcePlaying=function(){var a=this.source;return 0<a.currentTime&&!1===a.paused&&!1===a.ended&&2<a.readyState};b.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState};b.prototype._onPlayStart=function(){this.hasLoaded||this._onCanPlay();!this._isAutoUpdating&&this.autoUpdate&&
(d.shared.add(this.update,this),this._isAutoUpdating=!0)};b.prototype._onPlayStop=function(){this._isAutoUpdating&&(d.shared.remove(this.update,this),this._isAutoUpdating=!1)};b.prototype._onCanPlay=function(){this.hasLoaded=!0;this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.emit("loaded",this)),this._isSourcePlaying()?
this._onPlayStart():this.autoPlay&&this.source.play())};b.prototype.destroy=function(){this._isAutoUpdating&&d.shared.remove(this.update,this);this.source&&this.source._pixiId&&(delete g.BaseTextureCache[this.source._pixiId],delete this.source._pixiId);a.prototype.destroy.call(this)};b.fromVideo=function(a,d){a._pixiId||(a._pixiId="video_"+(0,g.uid)());var e=g.BaseTextureCache[a._pixiId];e||(e=new b(a,d),g.BaseTextureCache[a._pixiId]=e);return e};b.fromUrl=function(a,d){var e=document.createElement("video");
e.setAttribute("webkit-playsinline","");e.setAttribute("playsinline","");if(Array.isArray(a))for(var c=0;c<a.length;++c)e.appendChild(n(a[c].src||a[c],a[c].mime));else e.appendChild(n(a.src||a,a.mime));e.load();return b.fromVideo(e,d)};m(b,[{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(a){a!==this._autoUpdate&&(this._autoUpdate=a,!this._autoUpdate&&this._isAutoUpdating?(d.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(d.shared.add(this.update,
this),this._isAutoUpdating=!0))}}]);return b}(c["default"]);f["default"]=a;a.fromUrls=a.fromUrl},{"../ticker":115,"../utils":119,"./BaseTexture":109}],114:[function(a,c,f){f.__esModule=!0;var h=function(){function a(a,e){for(var b=0;b<e.length;b++){var d=e[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(d,e,b){e&&a(d.prototype,e);b&&a(d,b);return d}}(),n=(c=a("../settings"))&&c.__esModule?c:{"default":c},m=(a=a("eventemitter3"))&&
a.__esModule?a:{"default":a};a=function(){function a(){var d=this;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this._emitter=new m["default"];this._requestId=null;this._maxElapsedMS=100;this.autoStart=!1;this.deltaTime=1;this.elapsedMS=1/n["default"].TARGET_FPMS;this.lastTime=0;this.speed=1;this.started=!1;this._tick=function(a){d._requestId=null;d.started&&(d.update(a),d.started&&null===d._requestId&&d._emitter.listeners("tick",!0)&&(d._requestId=requestAnimationFrame(d._tick)))}}
a.prototype._requestIfNeeded=function(){null===this._requestId&&this._emitter.listeners("tick",!0)&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))};a.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)};a.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()};a.prototype.add=function(a,e){this._emitter.on("tick",a,e);this._startIfPossible();return this};
a.prototype.addOnce=function(a,e){this._emitter.once("tick",a,e);this._startIfPossible();return this};a.prototype.remove=function(a,e){this._emitter.off("tick",a,e);this._emitter.listeners("tick",!0)||this._cancelIfNeeded();return this};a.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())};a.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())};a.prototype.update=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:performance.now(),
e;a>this.lastTime?(e=this.elapsedMS=a-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),this.deltaTime=e*n["default"].TARGET_FPMS*this.speed,this._emitter.emit("tick",this.deltaTime)):this.deltaTime=this.elapsedMS=0;this.lastTime=a};h(a,[{key:"FPS",get:function(){return 1E3/this.elapsedMS}},{key:"minFPS",get:function(){return 1E3/this._maxElapsedMS},set:function(a){this._maxElapsedMS=1/Math.min(Math.max(0,a)/1E3,n["default"].TARGET_FPMS)}}]);return a}();f["default"]=a},{"../settings":99,
eventemitter3:3}],115:[function(a,c,f){f.__esModule=!0;f.Ticker=f.shared=void 0;a=(a=a("./Ticker"))&&a.__esModule?a:{"default":a};c=new a["default"];c.autoStart=!0;f.shared=c;f.Ticker=a["default"]},{"./Ticker":114}],116:[function(a,c,f){f.__esModule=!0;f["default"]=function(){return!(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))}},{}],117:[function(a,c,f){f.__esModule=!0;f["default"]=function(a){a*=6;for(var c=new Uint16Array(a),f=0,g=0;f<a;f+=6,g+=4)c[f+0]=g+0,c[f+1]=g+1,c[f+2]=
g+2,c[f+3]=g+0,c[f+4]=g+2,c[f+5]=g+3;return c}},{}],118:[function(a,c,f){f.__esModule=!0;f["default"]=function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window.location;if(0===a.indexOf("data:"))return"";c=c||window.location;n||(n=document.createElement("a"));n.href=a;a=h["default"].parse(n.href);var d=!a.port&&""===c.port||a.port===c.port;return a.hostname===c.hostname&&d&&a.protocol===c.protocol?"":"anonymous"};var h=(a=a("url"))&&a.__esModule?a:{"default":a},n=void 0},{url:28}],
119:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}f.__esModule=!0;f.BaseTextureCache=f.TextureCache=f.pluginTarget=f.EventEmitter=f.isMobile=void 0;f.uid=function(){return++d};f.hex2rgb=function(a,d){d=d||[];d[0]=(a>>16&255)/255;d[1]=(a>>8&255)/255;d[2]=(a&255)/255;return d};f.hex2string=function(a){a=a.toString(16);a="000000".substr(0,6-a.length)+a;return"#"+a};f.rgb2hex=function(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]};f.getResolutionOfUrl=function(a,d){var b=m["default"].RETINA_PREFIX.exec(a);
return b?parseFloat(b[1]):void 0!==d?d:1};f.decomposeDataUri=function(a){if(a=n.DATA_URI.exec(a))return{mediaType:a[1]?a[1].toLowerCase():void 0,subType:a[2]?a[2].toLowerCase():void 0,encoding:a[3]?a[3].toLowerCase():void 0,data:a[4]}};f.getUrlFileExtension=function(a){if(a=n.URL_FILE_EXTENSION.exec(a))return a[1].toLowerCase()};f.getSvgSize=function(a){a=n.SVG_SIZE.exec(a);var b={};a&&(b[a[1]]=Math.round(parseFloat(a[3])),b[a[5]]=Math.round(parseFloat(a[7])));return b};f.skipHello=function(){e=!0};
f.sayHello=function(a){e||(-1<navigator.userAgent.toLowerCase().indexOf("chrome")?window.console.log.apply(console,["\n %c %c %c Pixi.js "+n.VERSION+" - \u2730 "+a+" \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;",
"color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"]):window.console&&window.console.log("Pixi.js "+n.VERSION+" - "+a+" - http://www.pixijs.com/"),e=!0)};f.isWebGLSupported=function(){var a={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var d=document.createElement("canvas"),e=d.getContext("webgl",a)||d.getContext("experimental-webgl",a),c=!(!e||!e.getContextAttributes().stencil);if(e){var g=e.getExtension("WEBGL_lose_context");
g&&g.loseContext()}return c}catch(x){return!1}};f.sign=function(a){return 0===a?0:0>a?-1:1};f.removeItems=function(a,d,e){var b=a.length;if(!(d>=b||0===e)){e=d+e>b?b-d:e;for(b-=e;d<b;++d)a[d]=a[d+e];a.length=b}};var n=a("../const");c=a("../settings");var m=h(c);c=a("eventemitter3");c=h(c);var g=a("./pluginTarget"),g=h(g);a=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("ismobilejs"));var d=
0,e=!1;f.isMobile=a;f.EventEmitter=c["default"];f.pluginTarget=g["default"];f.TextureCache={};f.BaseTextureCache={}},{"../const":44,"../settings":99,"./pluginTarget":121,eventemitter3:3,ismobilejs:4}],120:[function(a,c,f){f.__esModule=!0;f["default"]=function(a){return h["default"].tablet||h["default"].phone?4:a};var h=(a=a("ismobilejs"))&&a.__esModule?a:{"default":a}},{ismobilejs:4}],121:[function(a,c,f){function h(a){a.__plugins={};a.registerPlugin=function(c,g){a.__plugins[c]=g};a.prototype.initPlugins=
function(){this.plugins=this.plugins||{};for(var c in a.__plugins)this.plugins[c]=new a.__plugins[c](this)};a.prototype.destroyPlugins=function(){for(var a in this.plugins)this.plugins[a].destroy(),this.plugins[a]=null;this.plugins=null}}f.__esModule=!0;f["default"]={mixin:function(a){h(a)}}},{}],122:[function(a,c,f){function h(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}function n(a){var b=Error().stack;
"undefined"===typeof b?console.warn("Deprecation Warning: ",a):(b=b.split("\n").splice(3).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cDeprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",a),console.warn(b),console.groupEnd()):(console.warn("Deprecation Warning: ",a),console.warn(b)))}c=a("./core");var m=h(c);c=a("./mesh");var g=h(c);c=a("./particles");var d=h(c);c=a("./extras");var e=h(c);c=a("./filters");c=h(c);f=a("./prepare");
f=h(f);a=a("./loaders");var b=h(a);m.SpriteBatch=function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.");};m.AssetLoader=function(){throw new ReferenceError("The loader system was overhauled in pixi v3, please see the new PIXI.loaders.Loader class.");};Object.defineProperties(m,{Stage:{enumerable:!0,get:function(){n("You do not need to use a PIXI Stage any more, you can simply render any container.");return m.Container}},DisplayObjectContainer:{enumerable:!0,
get:function(){n("DisplayObjectContainer has been shortened to Container, please use Container from now on.");return m.Container}},Strip:{enumerable:!0,get:function(){n("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on.");return g.Mesh}},Rope:{enumerable:!0,get:function(){n("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on.");return g.Rope}},ParticleContainer:{enumerable:!0,get:function(){n("The ParticleContainer class has been moved to particles.ParticleContainer, please use particles.ParticleContainer from now on.");
return d.ParticleContainer}},MovieClip:{enumerable:!0,get:function(){n("The MovieClip class has been moved to extras.AnimatedSprite, please use extras.AnimatedSprite.");return e.AnimatedSprite}},TilingSprite:{enumerable:!0,get:function(){n("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on.");return e.TilingSprite}},BitmapText:{enumerable:!0,get:function(){n("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on.");
return e.BitmapText}},blendModes:{enumerable:!0,get:function(){n("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on.");return m.BLEND_MODES}},scaleModes:{enumerable:!0,get:function(){n("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on.");return m.SCALE_MODES}},BaseTextureCache:{enumerable:!0,get:function(){n("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on.");return m.utils.BaseTextureCache}},
TextureCache:{enumerable:!0,get:function(){n("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on.");return m.utils.TextureCache}},math:{enumerable:!0,get:function(){n("The math namespace is deprecated, please access members already accessible on PIXI.");return m}},AbstractFilter:{enumerable:!0,get:function(){n("AstractFilter has been renamed to Filter, please use PIXI.Filter");return m.Filter}},TransformManual:{enumerable:!0,get:function(){n("TransformManual has been renamed to TransformBase, please update your pixi-spine");
return m.TransformBase}},TARGET_FPMS:{enumerable:!0,get:function(){n("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS");return m.settings.TARGET_FPMS},set:function(a){n("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS");m.settings.TARGET_FPMS=a}},FILTER_RESOLUTION:{enumerable:!0,get:function(){n("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION");return m.settings.FILTER_RESOLUTION},set:function(a){n("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION");
m.settings.FILTER_RESOLUTION=a}},RESOLUTION:{enumerable:!0,get:function(){n("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION");return m.settings.RESOLUTION},set:function(a){n("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION");m.settings.RESOLUTION=a}},MIPMAP_TEXTURES:{enumerable:!0,get:function(){n("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES");return m.settings.MIPMAP_TEXTURES},set:function(a){n("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES");
m.settings.MIPMAP_TEXTURES=a}},SPRITE_BATCH_SIZE:{enumerable:!0,get:function(){n("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE");return m.settings.SPRITE_BATCH_SIZE},set:function(a){n("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE");m.settings.SPRITE_BATCH_SIZE=a}},SPRITE_MAX_TEXTURES:{enumerable:!0,get:function(){n("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES");return m.settings.SPRITE_MAX_TEXTURES},
set:function(a){n("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES");m.settings.SPRITE_MAX_TEXTURES=a}},RETINA_PREFIX:{enumerable:!0,get:function(){n("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX");return m.settings.RETINA_PREFIX},set:function(a){n("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX");m.settings.RETINA_PREFIX=a}},DEFAULT_RENDER_OPTIONS:{enumerable:!0,get:function(){n("PIXI.DEFAULT_RENDER_OPTIONS has been deprecated, please use PIXI.settings.DEFAULT_RENDER_OPTIONS");
return m.settings.RENDER_OPTIONS}}});var p=[{parent:"TRANSFORM_MODE",target:"TRANSFORM_MODE"},{parent:"GC_MODES",target:"GC_MODE"},{parent:"WRAP_MODES",target:"WRAP_MODE"},{parent:"SCALE_MODES",target:"SCALE_MODE"},{parent:"PRECISION",target:"PRECISION"}];a=function(a){var b=p[a];Object.defineProperty(m[b.parent],"DEFAULT",{enumerable:!0,get:function(){n("PIXI."+b.parent+".DEFAULT has been deprecated, please use PIXI.settings."+b.target);return m.settings[b.target]},set:function(a){n("PIXI."+b.parent+
".DEFAULT has been deprecated, please use PIXI.settings."+b.target);m.settings[b.target]=a}})};for(var r=0;r<p.length;r++)a(r);Object.defineProperties(e,{MovieClip:{enumerable:!0,get:function(){n("The MovieClip class has been renamed to AnimatedSprite, please use AnimatedSprite from now on.");return e.AnimatedSprite}}});m.DisplayObject.prototype.generateTexture=function(a,b,d){n("generateTexture has moved to the renderer, please use renderer.generateTexture(displayObject)");return a.generateTexture(this,
b,d)};m.Graphics.prototype.generateTexture=function(a,b){n("graphics generate texture has moved to the renderer. Or to render a graphics to a texture using canvas please use generateCanvasTexture");return this.generateCanvasTexture(a,b)};m.RenderTexture.prototype.render=function(a,b,d,e){this.legacyRenderer.render(a,this,d,b,!e);n("RenderTexture.render is now deprecated, please use renderer.render(displayObject, renderTexture)")};m.RenderTexture.prototype.getImage=function(a){n("RenderTexture.getImage is now deprecated, please use renderer.extract.image(target)");
return this.legacyRenderer.extract.image(a)};m.RenderTexture.prototype.getBase64=function(a){n("RenderTexture.getBase64 is now deprecated, please use renderer.extract.base64(target)");return this.legacyRenderer.extract.base64(a)};m.RenderTexture.prototype.getCanvas=function(a){n("RenderTexture.getCanvas is now deprecated, please use renderer.extract.canvas(target)");return this.legacyRenderer.extract.canvas(a)};m.RenderTexture.prototype.getPixels=function(a){n("RenderTexture.getPixels is now deprecated, please use renderer.extract.pixels(target)");
return this.legacyRenderer.pixels(a)};m.Sprite.prototype.setTexture=function(a){this.texture=a;n("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")};e.BitmapText.prototype.setText=function(a){this.text=a;n("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")};m.Text.prototype.setText=function(a){this.text=a;n("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")};m.Text.prototype.setStyle=
function(a){this.style=a;n("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")};m.Text.prototype.determineFontProperties=function(a){n("determineFontProperties is now deprecated, please use the static calculateFontProperties method, e.g : Text.calculateFontProperties(fontStyle);");return Text.calculateFontProperties(a)};Object.defineProperties(m.TextStyle.prototype,{font:{get:function(){n("text style property 'font' is now deprecated, please use the 'fontFamily', 'fontSize', 'fontStyle', 'fontVariant' and 'fontWeight' properties from now on");
return this._fontStyle+" "+this._fontVariant+" "+this._fontWeight+" "+("number"===typeof this._fontSize?this._fontSize+"px":this._fontSize)+" "+this._fontFamily},set:function(a){n("text style property 'font' is now deprecated, please use the 'fontFamily','fontSize',fontStyle','fontVariant' and 'fontWeight' properties from now on");1<a.indexOf("italic")?this._fontStyle="italic":-1<a.indexOf("oblique")?this._fontStyle="oblique":this._fontStyle="normal";-1<a.indexOf("small-caps")?this._fontVariant="small-caps":
this._fontVariant="normal";a=a.split(" ");var b=-1;this._fontSize=26;for(var d=0;d<a.length;++d)if(a[d].match(/(px|pt|em|%)/)){b=d;this._fontSize=a[d];break}this._fontWeight="normal";for(d=0;d<b;++d)if(a[d].match(/(bold|bolder|lighter|100|200|300|400|500|600|700|800|900)/)){this._fontWeight=a[d];break}if(-1<b&&b<a.length-1){this._fontFamily="";for(b+=1;b<a.length;++b)this._fontFamily+=a[b]+" ";this._fontFamily=this._fontFamily.slice(0,-1)}else this._fontFamily="Arial";this.styleID++}}});m.Texture.prototype.setFrame=
function(a){this.frame=a;n("setFrame is now deprecated, please use the frame property, e.g: myTexture.frame = frame;")};Object.defineProperties(c,{AbstractFilter:{get:function(){n("AstractFilter has been renamed to Filter, please use PIXI.Filter");return m.AbstractFilter}},SpriteMaskFilter:{get:function(){n("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on.");return m.SpriteMaskFilter}}});m.utils.uuid=function(){n("utils.uuid() is deprecated, please use utils.uid() from now on.");
return m.utils.uid()};m.utils.canUseNewCanvasBlendModes=function(){n("utils.canUseNewCanvasBlendModes() is deprecated, please use CanvasTinter.canUseMultiply from now on");return m.CanvasTinter.canUseMultiply};var q=!0;Object.defineProperty(m.utils,"_saidHello",{set:function(a){a&&(n("PIXI.utils._saidHello is deprecated, please use PIXI.utils.skipHello()"),this.skipHello());q=a},get:function(){return q}});Object.defineProperty(f.canvas,"UPLOADS_PER_FRAME",{set:function(){n("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},
get:function(){n("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter");return NaN}});Object.defineProperty(f.webgl,"UPLOADS_PER_FRAME",{set:function(){n("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){n("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter");return NaN}});Object.defineProperties(b.Resource.prototype,
{isJson:{get:function(){n("The isJson property is deprecated, please use `resource.type === Resource.TYPE.JSON`.");return this.type===b.Loader.Resource.TYPE.JSON}},isXml:{get:function(){n("The isXml property is deprecated, please use `resource.type === Resource.TYPE.XML`.");return this.type===b.Loader.Resource.TYPE.XML}},isImage:{get:function(){n("The isImage property is deprecated, please use `resource.type === Resource.TYPE.IMAGE`.");return this.type===b.Loader.Resource.TYPE.IMAGE}},isAudio:{get:function(){n("The isAudio property is deprecated, please use `resource.type === Resource.TYPE.AUDIO`.");
return this.type===b.Loader.Resource.TYPE.AUDIO}},isVideo:{get:function(){n("The isVideo property is deprecated, please use `resource.type === Resource.TYPE.VIDEO`.");return this.type===b.Loader.Resource.TYPE.VIDEO}}});Object.defineProperties(b.Loader.prototype,{before:{get:function(){n("The before() method is deprecated, please use pre().");return this.pre}},after:{get:function(){n("The after() method is deprecated, please use use().");return this.use}}})},{"./core":63,"./extras":133,"./filters":144,
"./loaders":153,"./mesh":162,"./particles":165,"./prepare":175}],123:[function(a,c,f){f.__esModule=!0;var h=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=a[d]);c["default"]=a;return c}(a("../../core")),n=new h.Rectangle;a=function(){function a(c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=c;c.extract=this}a.prototype.image=function(a){var d=new Image;d.src=this.base64(a);
return d};a.prototype.base64=function(a){return this.canvas(a).toDataURL()};a.prototype.canvas=function(a){var d=this.renderer,e=void 0,b=void 0;a&&(b=a instanceof h.RenderTexture?a:d.generateTexture(a));b?(a=b.baseTexture._canvasRenderTarget.context,e=b.baseTexture._canvasRenderTarget.resolution,d=b.frame):(a=d.rootContext,d=n,d.width=this.renderer.width,d.height=this.renderer.height);var c=d.width*e,g=d.height*e,b=new h.CanvasRenderTarget(c,g),e=a.getImageData(d.x*e,d.y*e,c,g);b.context.putImageData(e,
0,0);return b.canvas};a.prototype.pixels=function(a){var d=this.renderer,e=void 0,b;b=void 0;a&&(b=a instanceof h.RenderTexture?a:d.generateTexture(a));b?(a=b.baseTexture._canvasRenderTarget.context,e=b.baseTexture._canvasRenderTarget.resolution,b=b.frame):(a=d.rootContext,b=n,b.width=d.width,b.height=d.height);return a.getImageData(0,0,b.width*e,b.height*e).data};a.prototype.destroy=function(){this.renderer=this.renderer.extract=null};return a}();f["default"]=a;h.CanvasRenderer.registerPlugin("extract",
a)},{"../../core":63}],124:[function(a,c,f){f.__esModule=!0;var h=a("./webgl/WebGLExtract");Object.defineProperty(f,"webgl",{enumerable:!0,get:function(){return(h&&h.__esModule?h:{"default":h})["default"]}});var n=a("./canvas/CanvasExtract");Object.defineProperty(f,"canvas",{enumerable:!0,get:function(){return(n&&n.__esModule?n:{"default":n})["default"]}})},{"./canvas/CanvasExtract":123,"./webgl/WebGLExtract":125}],125:[function(a,c,f){f.__esModule=!0;var h=function(a){if(a&&a.__esModule)return a;
var c={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=a[d]);c["default"]=a;return c}(a("../../core")),n=new h.Rectangle;a=function(){function a(c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=c;c.extract=this}a.prototype.image=function(a){var d=new Image;d.src=this.base64(a);return d};a.prototype.base64=function(a){return this.canvas(a).toDataURL()};a.prototype.canvas=function(a){var d=this.renderer,e,b,c;c=void 0;a&&
(c=a instanceof h.RenderTexture?a:this.renderer.generateTexture(a));c?(e=c.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],a=e.resolution,b=c.frame,c=!1):(e=this.renderer.rootRenderTarget,a=e.resolution,c=!0,b=n,b.width=e.size.width,b.height=e.size.height);var g=b.width*a,f=b.height*a,m=new h.CanvasRenderTarget(g,f);e&&(d.bindRenderTarget(e),e=new Uint8Array(4*g*f),d=d.gl,d.readPixels(b.x*a,b.y*a,g,f,d.RGBA,d.UNSIGNED_BYTE,e),d=m.context.getImageData(0,0,g,f),d.data.set(e),m.context.putImageData(d,
0,0),c&&(m.context.scale(1,-1),m.context.drawImage(m.canvas,0,-f)));return m.canvas};a.prototype.pixels=function(a){var d=this.renderer,e,b;b=void 0;a&&(b=a instanceof h.RenderTexture?a:this.renderer.generateTexture(a));b?(e=b.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],a=e.resolution,b=b.frame):(e=this.renderer.rootRenderTarget,a=e.resolution,b=n,b.width=e.size.width,b.height=e.size.height);var c=b.width*a,g=b.height*a,f=new Uint8Array(4*c*g);e&&(d.bindRenderTarget(e),d=d.gl,d.readPixels(b.x*
a,b.y*a,c,g,d.RGBA,d.UNSIGNED_BYTE,f));return f};a.prototype.destroy=function(){this.renderer=this.renderer.extract=null};return a}();f["default"]=a;h.WebGLRenderer.registerPlugin("extract",a)},{"../../core":63}],126:[function(a,c,f){function h(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+typeof d);a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});d&&(Object.setPrototypeOf?
Object.setPrototypeOf(a,d):a.__proto__=d)}f.__esModule=!0;var n=function(){function a(a,e){for(var b=0;b<e.length;b++){var d=e[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(d,e,b){e&&a(d.prototype,e);b&&a(d,b);return d}}(),m=function(a){if(a&&a.__esModule)return a;var d={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(d[e]=a[e]);d["default"]=a;return d}(a("../core"));a=function(a){function d(e,
b){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var c;c=a.call(this,e[0]instanceof m.Texture?e[0]:e[0].texture);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;c._textures=null;c._durations=null;c.textures=e;c._autoUpdate=!1!==b;c.animationSpeed=1;c.loop=!0;c.onComplete=null;c.onFrameChange=null;c._currentTime=0;c.playing=!1;return c}h(d,a);d.prototype.stop=function(){this.playing&&
(this.playing=!1,this._autoUpdate&&m.ticker.shared.remove(this.update,this))};d.prototype.play=function(){this.playing||(this.playing=!0,this._autoUpdate&&m.ticker.shared.add(this.update,this))};d.prototype.gotoAndStop=function(a){this.stop();var b=this.currentFrame;this._currentTime=a;b!==this.currentFrame&&this.updateTexture()};d.prototype.gotoAndPlay=function(a){var b=this.currentFrame;this._currentTime=a;b!==this.currentFrame&&this.updateTexture();this.play()};d.prototype.update=function(a){var b=
this.animationSpeed*a,d=this.currentFrame;if(null!==this._durations){for(var e=this._currentTime%1*this._durations[this.currentFrame],e=e+b/60*1E3;0>e;)this._currentTime--,e+=this._durations[this.currentFrame];a=Math.sign(this.animationSpeed*a);for(this._currentTime=Math.floor(this._currentTime);e>=this._durations[this.currentFrame];)e-=this._durations[this.currentFrame]*a,this._currentTime+=a;this._currentTime+=e/this._durations[this.currentFrame]}else this._currentTime+=b;if(0>this._currentTime&&
!this.loop){if(this.gotoAndStop(0),this.onComplete)this.onComplete()}else if(this._currentTime>=this._textures.length&&!this.loop){if(this.gotoAndStop(this._textures.length-1),this.onComplete)this.onComplete()}else d!==this.currentFrame&&this.updateTexture()};d.prototype.updateTexture=function(){this._texture=this._textures[this.currentFrame];this._textureID=-1;if(this.onFrameChange)this.onFrameChange(this.currentFrame)};d.prototype.destroy=function(){this.stop();a.prototype.destroy.call(this)};d.fromFrames=
function(a){for(var b=[],e=0;e<a.length;++e)b.push(m.Texture.fromFrame(a[e]));return new d(b)};d.fromImages=function(a){for(var b=[],e=0;e<a.length;++e)b.push(m.Texture.fromImage(a[e]));return new d(b)};n(d,[{key:"totalFrames",get:function(){return this._textures.length}},{key:"textures",get:function(){return this._textures},set:function(a){if(a[0]instanceof m.Texture)this._textures=a,this._durations=null;else{this._textures=[];this._durations=[];for(var b=0;b<a.length;b++)this._textures.push(a[b].texture),
this._durations.push(a[b].time)}}},{key:"currentFrame",get:function(){var a=Math.floor(this._currentTime)%this._textures.length;0>a&&(a+=this._textures.length);return a}}]);return d}(m.Sprite);f["default"]=a},{"../core":63}],127:[function(a,c,f){function h(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function n(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;var m=function(){function a(a,d){for(var b=0;b<d.length;b++){var e=d[b];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,d,e){d&&a(b.prototype,d);e&&a(b,e);return b}}(),g=function(a){if(a&&a.__esModule)return a;var b={};
if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../core")),d=(a=a("../core/math/ObservablePoint"))&&a.__esModule?a:{"default":a};a=function(a){function b(e){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var g=h(this,a.call(this));g._textWidth=0;g._textHeight=0;g._glyphs=[];g._font={tint:void 0!==c.tint?c.tint:16777215,align:c.align||"left",
name:null,size:0};g.font=c.font;g._text=e;g.maxWidth=0;g.maxLineHeight=0;g._anchor=new d["default"](function(){g.dirty=!0},g,0,0);g.dirty=!1;g.updateText();return g}n(b,a);b.prototype.updateText=function(){for(var a=b.fonts[this._font.name],d=this._font.size/a.size,e=new g.Point,c=[],f=[],m=null,h=0,n=0,z=0,w=-1,A=0,B=0,F=0;F<this.text.length;F++){var C=this.text.charCodeAt(F);/(\s)/.test(this.text.charAt(F))&&(w=F,A=h);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(F)))f.push(h),n=Math.max(n,h),z++,e.x=
0,e.y+=a.lineHeight,m=null;else if(-1!==w&&0<this.maxWidth&&e.x*d>this.maxWidth)g.utils.removeItems(c,w,F-w),F=w,w=-1,f.push(A),n=Math.max(n,A),z++,e.x=0,e.y+=a.lineHeight,m=null;else{var D=a.chars[C];D&&(m&&D.kerning[m]&&(e.x+=D.kerning[m]),c.push({texture:D.texture,line:z,charCode:C,position:new g.Point(e.x+D.xOffset,e.y+D.yOffset)}),h=e.x+(D.texture.width+D.xOffset),e.x+=D.xAdvance,B=Math.max(B,D.yOffset+D.texture.height),m=C)}}f.push(h);n=Math.max(n,h);m=[];for(h=0;h<=z;h++)w=0,"right"===this._font.align?
w=n-f[h]:"center"===this._font.align&&(w=(n-f[h])/2),m.push(w);f=c.length;z=this.tint;for(h=0;h<f;h++)(w=this._glyphs[h])?w.texture=c[h].texture:(w=new g.Sprite(c[h].texture),this._glyphs.push(w)),w.position.x=(c[h].position.x+m[c[h].line])*d,w.position.y=c[h].position.y*d,w.scale.x=w.scale.y=d,w.tint=z,w.parent||this.addChild(w);for(c=f;c<this._glyphs.length;++c)this.removeChild(this._glyphs[c]);this._textWidth=n*d;this._textHeight=(e.y+a.lineHeight)*d;if(0!==this.anchor.x||0!==this.anchor.y)for(a=
0;a<f;a++)this._glyphs[a].x-=this._textWidth*this.anchor.x,this._glyphs[a].y-=this._textHeight*this.anchor.y;this.maxLineHeight=B*d};b.prototype.updateTransform=function(){this.validate();this.containerUpdateTransform()};b.prototype.getLocalBounds=function(){this.validate();return a.prototype.getLocalBounds.call(this)};b.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)};m(b,[{key:"tint",get:function(){return this._font.tint},set:function(a){this._font.tint="number"===typeof a&&
0<=a?a:16777215;this.dirty=!0}},{key:"align",get:function(){return this._font.align},set:function(a){this._font.align=a||"left";this.dirty=!0}},{key:"anchor",get:function(){return this._anchor},set:function(a){"number"===typeof a?this._anchor.set(a):this._anchor.copy(a)}},{key:"font",get:function(){return this._font},set:function(a){a&&("string"===typeof a?(a=a.split(" "),this._font.name=1===a.length?a[0]:a.slice(1).join(" "),this._font.size=2<=a.length?parseInt(a[0],10):b.fonts[this._font.name].size):
(this._font.name=a.name,this._font.size="number"===typeof a.size?a.size:parseInt(a.size,10)),this.dirty=!0)}},{key:"text",get:function(){return this._text},set:function(a){a=a.toString()||" ";this._text!==a&&(this._text=a,this.dirty=!0)}},{key:"textWidth",get:function(){this.validate();return this._textWidth}},{key:"textHeight",get:function(){this.validate();return this._textHeight}}]);return b}(g.Container);f["default"]=a;a.fonts={}},{"../core":63,"../core/math/ObservablePoint":66}],128:[function(a,
c,f){f.__esModule=!0;var h=function(){function a(a,e){for(var b=0;b<e.length;b++){var d=e[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(d,e,b){e&&a(d.prototype,e);b&&a(d,b);return d}}(),n=(a=a("../core/math/Matrix"))&&a.__esModule?a:{"default":a},m=new n["default"];a=function(){function a(d,e){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this._texture=d;this.mapCoord=new n["default"];
this.uClampFrame=new Float32Array(4);this.uClampOffset=new Float32Array(2);this._lastTextureID=-1;this.clampOffset=0;this.clampMargin="undefined"===typeof e?.5:e}a.prototype.update=function(a){var d=this._texture;if(d&&d.valid&&(a||this._lastTextureID!==d._updateID)){this._lastTextureID=d._updateID;a=d._uvs;this.mapCoord.set(a.x1-a.x0,a.y1-a.y0,a.x3-a.x0,a.y3-a.y0,a.x0,a.y0);a=d.orig;var b=d.trim;b&&(m.set(a.width/b.width,0,0,a.height/b.height,-b.x/b.width,-b.y/b.height),this.mapCoord.append(m));
a=d.baseTexture;var b=this.uClampFrame,c=this.clampMargin/a.resolution,g=this.clampOffset;b[0]=(d._frame.x+c+g)/a.width;b[1]=(d._frame.y+c+g)/a.height;b[2]=(d._frame.x+d._frame.width-c+g)/a.width;b[3]=(d._frame.y+d._frame.height-c+g)/a.height;this.uClampOffset[0]=g/a.realWidth;this.uClampOffset[1]=g/a.realHeight}};h(a,[{key:"texture",get:function(){return this._texture},set:function(a){this._texture=a;this._lastTextureID=-1}}]);return a}();f["default"]=a},{"../core/math/Matrix":65}],129:[function(a,
c,f){function h(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+typeof d);a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});d&&(Object.setPrototypeOf?Object.setPrototypeOf(a,d):a.__proto__=d)}f.__esModule=!0;var n=function(){function a(a,b){for(var d=0;d<b.length;d++){var e=b[d];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,
e.key,e)}}return function(b,d,e){d&&a(b.prototype,d);e&&a(b,e);return b}}(),m=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../core")),g=(c=a("../core/sprites/canvas/CanvasTinter"))&&c.__esModule?c:{"default":c},d=(a=a("./TextureTransform"))&&a.__esModule?a:{"default":a},e=new m.Point;a=function(a){function b(e){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,g=2<arguments.length&&
void 0!==arguments[2]?arguments[2]:100;if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var f;f=a.call(this,e);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");f=!f||"object"!==typeof f&&"function"!==typeof f?this:f;f.tileTransform=new m.TransformStatic;f._width=c;f._height=g;f._canvasPattern=null;f.uvTransform=e.transform||new d["default"](e);f.pluginName="tilingSprite";f.uvRespectAnchor=!1;return f}h(b,a);b.prototype._onTextureUpdate=
function(){this.uvTransform&&(this.uvTransform.texture=this._texture)};b.prototype._renderWebGL=function(a){var b=this._texture;b&&b.valid&&(this.tileTransform.updateLocalTransform(),this.uvTransform.update(),a.setObjectRenderer(a.plugins[this.pluginName]),a.plugins[this.pluginName].render(this))};b.prototype._renderCanvas=function(a){var b=this._texture;if(b.baseTexture.hasLoaded){var d=a.context,e=this.worldTransform,c=a.resolution,f=b.baseTexture,h=b.baseTexture.resolution,p=this.tilePosition.x/
this.tileScale.x%b._frame.width,n=this.tilePosition.y/this.tileScale.y%b._frame.height;if(!this._canvasPattern){var r=new m.CanvasRenderTarget(b._frame.width,b._frame.height,h);16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=g["default"].getTintedTexture(this,this.tint)),r.context.drawImage(this.tintedTexture,0,0)):r.context.drawImage(f.source,-b._frame.x,-b._frame.y);this._canvasPattern=r.context.createPattern(r.canvas,"repeat")}d.globalAlpha=this.worldAlpha;
d.setTransform(e.a*c,e.b*c,e.c*c,e.d*c,e.tx*c,e.ty*c);d.scale(this.tileScale.x/h,this.tileScale.y/h);d.translate(p+this.anchor.x*-this._width,n+this.anchor.y*-this._height);a.setBlendMode(this.blendMode);d.fillStyle=this._canvasPattern;d.fillRect(-p,-n,this._width/this.tileScale.x*h,this._height/this.tileScale.y*h)}};b.prototype._calculateBounds=function(){this._bounds.addFrame(this.transform,this._width*-this._anchor._x,this._height*-this._anchor._y,this._width*(1-this._anchor._x),this._height*(1-
this._anchor._y))};b.prototype.getLocalBounds=function(b){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._x),b||(this._localBoundsRect||(this._localBoundsRect=new m.Rectangle),b=this._localBoundsRect),this._bounds.getRectangle(b)):a.prototype.getLocalBounds.call(this,b)};b.prototype.containsPoint=function(a){this.worldTransform.applyInverse(a,
e);var b=this._width;a=this._height;var d=-b*this.anchor._x;return e.x>d&&e.x<d+b&&(b=-a*this.anchor._y,e.y>b&&e.y<b+a)?!0:!1};b.prototype.destroy=function(){a.prototype.destroy.call(this);this.uvTransform=this.tileTransform=null};b.from=function(a,d,e){return new b(m.Texture.from(a),d,e)};b.fromFrame=function(a,d,e){var c=m.utils.TextureCache[a];if(!c)throw Error('The frameId "'+a+'" does not exist in the texture cache '+this);return new b(c,d,e)};b.fromImage=function(a,d,e,c,g){return new b(m.Texture.fromImage(a,
c,g),d,e)};n(b,[{key:"clampMargin",get:function(){return this.uvTransform.clampMargin},set:function(a){this.uvTransform.clampMargin=a;this.uvTransform.update(!0)}},{key:"tileScale",get:function(){return this.tileTransform.scale},set:function(a){this.tileTransform.scale.copy(a)}},{key:"tilePosition",get:function(){return this.tileTransform.position},set:function(a){this.tileTransform.position.copy(a)}},{key:"width",get:function(){return this._width},set:function(a){this._width=a}},{key:"height",get:function(){return this._height},
set:function(a){this._height=a}}]);return b}(m.Sprite);f["default"]=a},{"../core":63,"../core/sprites/canvas/CanvasTinter":102,"./TextureTransform":128}],130:[function(a,c,f){var h=function(a){if(a&&a.__esModule)return a;var d={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(d[e]=a[e]);d["default"]=a;return d}(a("../core"));a=h.DisplayObject;var n=new h.Matrix;a.prototype._cacheAsBitmap=!1;a.prototype._cacheData=!1;var m=function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");
this.sprite=this.originalFilterArea=this.originalMask=this.originalDestroy=this.originalHitTest=this.originalUpdateTransform=this.originalGetLocalBounds=this.originalCalculateBounds=this.originalRenderCanvas=this.originalRenderWebGL=null};Object.defineProperties(a.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(a){this._cacheAsBitmap!==a&&((this._cacheAsBitmap=a)?(this._cacheData||(this._cacheData=new m),a=this._cacheData,a.originalRenderWebGL=this.renderWebGL,a.originalRenderCanvas=
this.renderCanvas,a.originalUpdateTransform=this.updateTransform,a.originalCalculateBounds=this._calculateBounds,a.originalGetLocalBounds=this.getLocalBounds,a.originalDestroy=this.destroy,a.originalContainsPoint=this.containsPoint,a.originalMask=this._mask,a.originalFilterArea=this.filterArea,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(a=this._cacheData,a.sprite&&this._destroyCachedDisplayObject(),this.renderWebGL=
a.originalRenderWebGL,this.renderCanvas=a.originalRenderCanvas,this._calculateBounds=a.originalCalculateBounds,this.getLocalBounds=a.originalGetLocalBounds,this.destroy=a.originalDestroy,this.updateTransform=a.originalUpdateTransform,this.containsPoint=a.originalContainsPoint,this._mask=a.originalMask,this.filterArea=a.originalFilterArea))}}});a.prototype._renderCachedWebGL=function(a){!this.visible||0>=this.worldAlpha||!this.renderable||(this._initCachedDisplayObject(a),this._cacheData.sprite._transformID=
-1,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderWebGL(a))};a.prototype._initCachedDisplayObject=function(a){if(!this._cacheData||!this._cacheData.sprite){var d=this.alpha;this.alpha=1;a.currentRenderer.flush();var b=this.getLocalBounds().clone();this._filters&&b.pad(this._filters[0].padding);var c=a._activeRenderTarget,f=a.filterManager.filterStack,m=h.RenderTexture.create(b.width|0,b.height|0);n.tx=-b.x;n.ty=-b.y;this.transform.worldTransform.identity();this.renderWebGL=
this._cacheData.originalRenderWebGL;a.render(this,m,!0,n,!0);a.bindRenderTarget(c);a.filterManager.filterStack=f;this.renderWebGL=this._renderCachedWebGL;this.updateTransform=this.displayObjectUpdateTransform;this.filterArea=this._mask=null;a=new h.Sprite(m);a.transform.worldTransform=this.transform.worldTransform;a.anchor.x=-(b.x/b.width);a.anchor.y=-(b.y/b.height);a.alpha=d;a._bounds=this._bounds;this._calculateBounds=this._calculateCachedBounds;this.getLocalBounds=this._getCachedLocalBounds;this._cacheData.sprite=
a;this.transform._parentID=-1;this.updateTransform();this.containsPoint=a.containsPoint.bind(a)}};a.prototype._renderCachedCanvas=function(a){!this.visible||0>=this.worldAlpha||!this.renderable||(this._initCachedDisplayObjectCanvas(a),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite.renderCanvas(a))};a.prototype._initCachedDisplayObjectCanvas=function(a){if(!this._cacheData||!this._cacheData.sprite){var d=this.getLocalBounds(),b=this.alpha;this.alpha=1;var c=a.context,f=h.RenderTexture.create(d.width|
0,d.height|0);this.transform.localTransform.copy(n);n.invert();n.tx-=d.x;n.ty-=d.y;this.renderCanvas=this._cacheData.originalRenderCanvas;a.render(this,f,!0,n,!1);a.context=c;this.renderCanvas=this._renderCachedCanvas;this._calculateBounds=this._calculateCachedBounds;this.filterArea=this._mask=null;a=new h.Sprite(f);a.transform.worldTransform=this.transform.worldTransform;a.anchor.x=-(d.x/d.width);a.anchor.y=-(d.y/d.height);a._bounds=this._bounds;a.alpha=b;this.updateTransform();this.updateTransform=
this.displayObjectUpdateTransform;this._cacheData.sprite=a;this.containsPoint=a.containsPoint.bind(a)}};a.prototype._calculateCachedBounds=function(){this._cacheData.sprite._calculateBounds()};a.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()};a.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0);this._cacheData.sprite=null};a.prototype._cacheAsBitmapDestroy=function(){this.cacheAsBitmap=!1;this.destroy()}},{"../core":63}],
131:[function(a,c,f){a=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(c[f]=a[f]);c["default"]=a;return c}(a("../core"));a.DisplayObject.prototype.name=null;a.Container.prototype.getChildByName=function(a){for(var c=0;c<this.children.length;c++)if(this.children[c].name===a)return this.children[c];return null}},{"../core":63}],132:[function(a,c,f){var h=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var g in a)Object.prototype.hasOwnProperty.call(a,
g)&&(c[g]=a[g]);c["default"]=a;return c}(a("../core"));h.DisplayObject.prototype.getGlobalPosition=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new h.Point,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;this.parent?this.parent.toGlobal(this.position,a,c):(a.x=this.position.x,a.y=this.position.y);return a}},{"../core":63}],133:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}f.__esModule=!0;f.BitmapText=f.TilingSpriteRenderer=f.TilingSprite=
f.AnimatedSprite=f.TextureTransform=void 0;var n=a("./TextureTransform");Object.defineProperty(f,"TextureTransform",{enumerable:!0,get:function(){return h(n)["default"]}});var m=a("./AnimatedSprite");Object.defineProperty(f,"AnimatedSprite",{enumerable:!0,get:function(){return h(m)["default"]}});var g=a("./TilingSprite");Object.defineProperty(f,"TilingSprite",{enumerable:!0,get:function(){return h(g)["default"]}});var d=a("./webgl/TilingSpriteRenderer");Object.defineProperty(f,"TilingSpriteRenderer",
{enumerable:!0,get:function(){return h(d)["default"]}});var e=a("./BitmapText");Object.defineProperty(f,"BitmapText",{enumerable:!0,get:function(){return h(e)["default"]}});a("./cacheAsBitmap");a("./getChildByName");a("./getGlobalPosition")},{"./AnimatedSprite":126,"./BitmapText":127,"./TextureTransform":128,"./TilingSprite":129,"./cacheAsBitmap":130,"./getChildByName":131,"./getGlobalPosition":132,"./webgl/TilingSpriteRenderer":134}],134:[function(a,c,f){function h(a,b){if("function"!==typeof b&&
null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;var n=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../../core")),m=a("../../core/const");a("path");
var g=new n.Matrix,d=new Float32Array(4);a=function(a){function b(d){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");d=a.call(this,d);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");d=!d||"object"!==typeof d&&"function"!==typeof d?this:d;d.shader=null;d.simpleShader=null;d.quad=null;return d}h(b,a);b.prototype.onContextChange=function(){var a=this.renderer.gl;this.shader=new n.Shader(a,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",
"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    vec4 color = vec4(uColor.rgb * uColor.a, uColor.a);\n\n    gl_FragColor = sample * color ;\n}\n");
this.simpleShader=new n.Shader(a,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    vec4 color = vec4(uColor.rgb * uColor.a, uColor.a);\n    gl_FragColor = sample * color;\n}\n");
this.renderer.bindVao(null);this.quad=new n.Quad(a,this.renderer.state.attribState);this.quad.initVao(this.shader)};b.prototype.render=function(a){var b=this.renderer,e=this.quad;b.bindVao(e.vao);var c=e.vertices;c[0]=c[6]=a._width*-a.anchor.x;c[1]=c[3]=a._height*-a.anchor.y;c[2]=c[4]=a._width*(1-a.anchor.x);c[5]=c[7]=a._height*(1-a.anchor.y);a.uvRespectAnchor&&(c=e.uvs,c[0]=c[6]=-a.anchor.x,c[1]=c[3]=-a.anchor.y,c[2]=c[4]=1-a.anchor.x,c[5]=c[7]=1-a.anchor.y);e.upload();var c=a._texture,f=c.baseTexture,
h=a.tileTransform.localTransform,p=a.uvTransform,t=f.isPowerOfTwo&&c.frame.width===f.width&&c.frame.height===f.height;t&&(f._glTextures[b.CONTEXT_UID]?t=f.wrapMode!==m.WRAP_MODES.CLAMP:f.wrapMode===m.WRAP_MODES.CLAMP&&(f.wrapMode=m.WRAP_MODES.REPEAT));f=t?this.simpleShader:this.shader;b.bindShader(f);var z=c.width,w=c.height,A=a._width,B=a._height;g.set(h.a*z/A,h.b*z/B,h.c*w/A,h.d*w/B,h.tx/A,h.ty/B);g.invert();t?g.append(p.mapCoord):(f.uniforms.uMapCoord=p.mapCoord.toArray(!0),f.uniforms.uClampFrame=
p.uClampFrame,f.uniforms.uClampOffset=p.uClampOffset);f.uniforms.uTransform=g.toArray(!0);n.utils.hex2rgb(a.tint,d);d[3]=a.worldAlpha;f.uniforms.uColor=d;f.uniforms.translationMatrix=a.transform.worldTransform.toArray(!0);f.uniforms.uSampler=b.bindTexture(c);b.setBlendMode(a.blendMode);e.vao.draw(this.renderer.gl.TRIANGLES,6,0)};return b}(n.ObjectRenderer);f["default"]=a;n.WebGLRenderer.registerPlugin("tilingSprite",a)},{"../../core":63,"../../core/const":44,path:22}],135:[function(a,c,f){function h(a,
b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;var n=function(){function a(a,d){for(var b=0;b<d.length;b++){var c=d[b];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}
return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}();c=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../../core"));var m=a("./BlurXFilter"),g=m&&m.__esModule?m:{"default":m},d=(a=a("./BlurYFilter"))&&a.__esModule?a:{"default":a};a=function(a){function b(c,e,f,m){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var h;h=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
h=!h||"object"!==typeof h&&"function"!==typeof h?this:h;h.blurXFilter=new g["default"](c,e,f,m);h.blurYFilter=new d["default"](c,e,f,m);h.resolution=1;h.padding=0;h.resolution=f||1;h.quality=e||4;h.blur=c||8;return h}h(b,a);b.prototype.apply=function(a,b,d){var c=a.getRenderTarget(!0);this.blurXFilter.apply(a,b,c,!0);this.blurYFilter.apply(a,c,d,!1);a.returnRenderTarget(c)};n(b,[{key:"blur",get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=this.blurYFilter.blur=a;
this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"quality",get:function(){return this.blurXFilter.quality},set:function(a){this.blurXFilter.quality=this.blurYFilter.quality=a}},{key:"blurX",get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=a;this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blurY",get:function(){return this.blurYFilter.blur},set:function(a){this.blurYFilter.blur=
a;this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}}]);return b}(c.Filter);f["default"]=a},{"../../core":63,"./BlurXFilter":136,"./BlurYFilter":137}],136:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}function n(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,
configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;var m=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}();c=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../../core"));
var g=a("./generateBlurVertSource"),d=h(g),g=a("./generateBlurFragSource"),e=h(g);a=a("./getMaxBlurKernelSize");var b=h(a);a=function(a){function c(b,g,f,m){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");m=m||5;var h=(0,d["default"])(m,!0);m=(0,e["default"])(m);h=a.call(this,h,m);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");h=!h||"object"!==typeof h&&"function"!==typeof h?this:h;h.resolution=f||1;h._quality=0;h.quality=
g||4;h.strength=b||8;h.firstRun=!0;return h}n(c,a);c.prototype.apply=function(a,c,g,f){if(this.firstRun){var m=a.renderer.gl,m=(0,b["default"])(m);this.vertexSrc=(0,d["default"])(m,!0);this.fragmentSrc=(0,e["default"])(m);this.firstRun=!1}this.uniforms.strength=1/g.size.width*(g.size.width/c.size.width);this.uniforms.strength*=this.strength;this.uniforms.strength/=this.passes;if(1===this.passes)a.applyFilter(this,c,g,f);else{for(var h=m=a.getRenderTarget(!0),p=0;p<this.passes-1;p++){a.applyFilter(this,
c,h,!0);var n=h,h=c;c=n}a.applyFilter(this,c,g,f);a.returnRenderTarget(m)}};m(c,[{key:"blur",get:function(){return this.strength},set:function(a){this.padding=2*Math.abs(a);this.strength=a}},{key:"quality",get:function(){return this._quality},set:function(a){this.passes=this._quality=a}}]);return c}(c.Filter);f["default"]=a},{"../../core":63,"./generateBlurFragSource":138,"./generateBlurVertSource":139,"./getMaxBlurKernelSize":140}],137:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}
function n(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;var m=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,
c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}();c=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../../core"));var g=a("./generateBlurVertSource"),d=h(g),g=a("./generateBlurFragSource"),e=h(g);a=a("./getMaxBlurKernelSize");var b=h(a);a=function(a){function c(b,g,f,m){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");m=m||5;var h=
(0,d["default"])(m,!1);m=(0,e["default"])(m);h=a.call(this,h,m);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");h=!h||"object"!==typeof h&&"function"!==typeof h?this:h;h.resolution=f||1;h._quality=0;h.quality=g||4;h.strength=b||8;h.firstRun=!0;return h}n(c,a);c.prototype.apply=function(a,c,g,f){if(this.firstRun){var m=a.renderer.gl,m=(0,b["default"])(m);this.vertexSrc=(0,d["default"])(m,!1);this.fragmentSrc=(0,e["default"])(m);this.firstRun=!1}this.uniforms.strength=
1/g.size.height*(g.size.height/c.size.height);this.uniforms.strength*=this.strength;this.uniforms.strength/=this.passes;if(1===this.passes)a.applyFilter(this,c,g,f);else{for(var h=m=a.getRenderTarget(!0),p=0;p<this.passes-1;p++){a.applyFilter(this,c,h,!0);var n=h,h=c;c=n}a.applyFilter(this,c,g,f);a.returnRenderTarget(m)}};m(c,[{key:"blur",get:function(){return this.strength},set:function(a){this.padding=2*Math.abs(a);this.strength=a}},{key:"quality",get:function(){return this._quality},set:function(a){this.passes=
this._quality=a}}]);return c}(c.Filter);f["default"]=a},{"../../core":63,"./generateBlurFragSource":138,"./generateBlurVertSource":139,"./getMaxBlurKernelSize":140}],138:[function(a,c,f){f.__esModule=!0;f["default"]=function(a){for(var c=h[a],d=c.length,e=n,b="",f,m=0;m<a;m++){var q="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",m);f=m;m>=d&&(f=a-m-1);q=q.replace("%value%",c[f]);b+=q;b+="\n"}e=e.replace("%blur%",b);return e=e.replace("%size%",a)};var h=
{5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[4.89E-4,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},n="varying vec2 vBlurTexCoords[%size%];\nuniform sampler2D uSampler;\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n    %blur%\n}"},{}],139:[function(a,c,f){f.__esModule=!0;f["default"]=function(a,c){var g=Math.ceil(a/
2),d=h,e="",b;b=c?"vBlurTexCoords[%index%] = aTextureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] = aTextureCoord + vec2(0.0, %sampleIndex% * strength);";for(var f=0;f<a;f++)var m=b.replace("%index%",f),m=m.replace("%sampleIndex%",f-(g-1)+".0"),e=e+m,e=e+"\n";d=d.replace("%blur%",e);return d=d.replace("%size%",a)};var h="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform float strength;\nuniform mat3 projectionMatrix;\nvarying vec2 vBlurTexCoords[%size%];\nvoid main(void)\n{\ngl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n%blur%\n}"},
{}],140:[function(a,c,f){f.__esModule=!0;f["default"]=function(a){a=a.getParameter(a.MAX_VARYING_VECTORS);for(var c=15;c>a;)c-=2;return c}},{}],141:[function(a,c,f){function h(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}f.__esModule=!0;var n=
function(){function a(a,d){for(var c=0;c<d.length;c++){var b=d[c];b.enumerable=b.enumerable||!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(a,b.key,b)}}return function(c,d,e){d&&a(c.prototype,d);e&&a(c,e);return c}}();c=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=a[d]);c["default"]=a;return c}(a("../../core"));a("path");a=function(a){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");
var d;d=a.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\n\nvoid main(void)\n{\n\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.r = (m[0] * c.r);\n        gl_FragColor.r += (m[1] * c.g);\n        gl_FragColor.r += (m[2] * c.b);\n        gl_FragColor.r += (m[3] * c.a);\n        gl_FragColor.r += m[4] * c.a;\n\n    gl_FragColor.g = (m[5] * c.r);\n        gl_FragColor.g += (m[6] * c.g);\n        gl_FragColor.g += (m[7] * c.b);\n        gl_FragColor.g += (m[8] * c.a);\n        gl_FragColor.g += m[9] * c.a;\n\n     gl_FragColor.b = (m[10] * c.r);\n        gl_FragColor.b += (m[11] * c.g);\n        gl_FragColor.b += (m[12] * c.b);\n        gl_FragColor.b += (m[13] * c.a);\n        gl_FragColor.b += m[14] * c.a;\n\n     gl_FragColor.a = (m[15] * c.r);\n        gl_FragColor.a += (m[16] * c.g);\n        gl_FragColor.a += (m[17] * c.b);\n        gl_FragColor.a += (m[18] * c.a);\n        gl_FragColor.a += m[19] * c.a;\n\n//    gl_FragColor = vec4(m[0]);\n}\n");
if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");d=!d||"object"!==typeof d&&"function"!==typeof d?this:d;d.uniforms.m=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];return d}h(c,a);c.prototype._loadMatrix=function(a){var d=a;1<arguments.length&&void 0!==arguments[1]&&arguments[1]&&(this._multiply(d,this.uniforms.m,a),d=this._colorMatrix(d));this.uniforms.m=d};c.prototype._multiply=function(a,c,b){a[0]=c[0]*b[0]+c[1]*b[5]+c[2]*b[10]+c[3]*b[15];a[1]=c[0]*b[1]+
c[1]*b[6]+c[2]*b[11]+c[3]*b[16];a[2]=c[0]*b[2]+c[1]*b[7]+c[2]*b[12]+c[3]*b[17];a[3]=c[0]*b[3]+c[1]*b[8]+c[2]*b[13]+c[3]*b[18];a[4]=c[0]*b[4]+c[1]*b[9]+c[2]*b[14]+c[3]*b[19];a[5]=c[5]*b[0]+c[6]*b[5]+c[7]*b[10]+c[8]*b[15];a[6]=c[5]*b[1]+c[6]*b[6]+c[7]*b[11]+c[8]*b[16];a[7]=c[5]*b[2]+c[6]*b[7]+c[7]*b[12]+c[8]*b[17];a[8]=c[5]*b[3]+c[6]*b[8]+c[7]*b[13]+c[8]*b[18];a[9]=c[5]*b[4]+c[6]*b[9]+c[7]*b[14]+c[8]*b[19];a[10]=c[10]*b[0]+c[11]*b[5]+c[12]*b[10]+c[13]*b[15];a[11]=c[10]*b[1]+c[11]*b[6]+c[12]*b[11]+c[13]*
b[16];a[12]=c[10]*b[2]+c[11]*b[7]+c[12]*b[12]+c[13]*b[17];a[13]=c[10]*b[3]+c[11]*b[8]+c[12]*b[13]+c[13]*b[18];a[14]=c[10]*b[4]+c[11]*b[9]+c[12]*b[14]+c[13]*b[19];a[15]=c[15]*b[0]+c[16]*b[5]+c[17]*b[10]+c[18]*b[15];a[16]=c[15]*b[1]+c[16]*b[6]+c[17]*b[11]+c[18]*b[16];a[17]=c[15]*b[2]+c[16]*b[7]+c[17]*b[12]+c[18]*b[17];a[18]=c[15]*b[3]+c[16]*b[8]+c[17]*b[13]+c[18]*b[18];a[19]=c[15]*b[4]+c[16]*b[9]+c[17]*b[14]+c[18]*b[19];return a};c.prototype._colorMatrix=function(a){a=new Float32Array(a);a[4]/=255;
a[9]/=255;a[14]/=255;a[19]/=255;return a};c.prototype.brightness=function(a,c){this._loadMatrix([a,0,0,0,0,0,a,0,0,0,0,0,a,0,0,0,0,0,1,0],c)};c.prototype.greyscale=function(a,c){this._loadMatrix([a,a,a,0,0,a,a,a,0,0,a,a,a,0,0,0,0,0,1,0],c)};c.prototype.blackAndWhite=function(a){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],a)};c.prototype.hue=function(a,c){a=(a||0)/180*Math.PI;var b=Math.cos(a),d=Math.sin(a),e=Math.sqrt,f=1/3,e=e(f);this._loadMatrix([b+(1-b)*f,f*(1-b)-e*d,f*
(1-b)+e*d,0,0,f*(1-b)+e*d,b+f*(1-b),f*(1-b)-e*d,0,0,f*(1-b)-e*d,f*(1-b)+e*d,b+f*(1-b),0,0,0,0,0,1,0],c)};c.prototype.contrast=function(a,c){var b=(a||0)+1,d=-128*(b-1);this._loadMatrix([b,0,0,0,d,0,b,0,0,d,0,0,b,0,d,0,0,0,1,0],c)};c.prototype.saturate=function(){var a=2*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0)/3+1,c=-.5*(a-1);this._loadMatrix([a,c,c,0,0,c,a,c,0,0,c,c,a,0,0,0,0,0,1,0],arguments[1])};c.prototype.desaturate=function(){this.saturate(-1)};c.prototype.negative=function(a){this._loadMatrix([0,
1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0],a)};c.prototype.sepia=function(a){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],a)};c.prototype.technicolor=function(a){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],a)};c.prototype.polaroid=
function(a){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],a)};c.prototype.toBGR=function(a){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],a)};c.prototype.kodachrome=function(a){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,
0],a)};c.prototype.browni=function(a){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],a)};c.prototype.vintage=function(a){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,
.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],a)};c.prototype.colorTone=function(a,c,b,f,g){b=b||16770432;f=f||3375104;var d=(b>>16&255)/255,e=(b>>8&255)/255;b=(b&255)/255;var m=(f>>16&255)/255,h=(f>>8&255)/255;f=(f&255)/255;this._loadMatrix([.3,.59,.11,0,0,d,e,b,a||.2,0,m,h,f,c||.15,0,d-m,e-h,b-f,0,0],g)};c.prototype.night=function(a,c){a=a||.1;this._loadMatrix([-2*a,-a,0,0,0,-a,0,a,0,0,0,a,2*a,0,0,0,0,0,1,0],c)};c.prototype.predator=function(a,c){this._loadMatrix([11.224130630493164*
a,-4.794486999511719*a,-2.8746118545532227*a,0*a,.40342438220977783*a,-3.6330697536468506*a,9.193157196044922*a,-2.951810836791992*a,0*a,-1.316135048866272*a,-3.2184197902679443*a,-4.2375030517578125*a,7.476448059082031*a,0*a,.8044459223747253*a,0,0,0,1,0],c)};c.prototype.lsd=function(a){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],a)};c.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)};n(c,[{key:"matrix",get:function(){return this.uniforms.m},
set:function(a){this.uniforms.m=a}}]);return c}(c.Filter);f["default"]=a;a.prototype.grayscale=a.prototype.greyscale},{"../../core":63,path:22}],142:[function(a,c,f){function h(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+typeof d);a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});d&&(Object.setPrototypeOf?Object.setPrototypeOf(a,d):a.__proto__=d)}f.__esModule=!0;var n=
function(){function a(a,c){for(var b=0;b<c.length;b++){var d=c[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(d,c,b){c&&a(d.prototype,c);b&&a(d,b);return d}}(),m=function(a){if(a&&a.__esModule)return a;var d={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);d["default"]=a;return d}(a("../../core"));a("path");a=function(a){function d(c,b){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");
var e=new m.Matrix;c.renderable=!1;var f;f=a.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord;\n}","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n   vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n   map -= 0.5;\n   map.xy *= scale;\n\n   gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), filterClamp.xy, filterClamp.zw));\n}\n");
if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");f=!f||"object"!==typeof f&&"function"!==typeof f?this:f;f.maskSprite=c;f.maskMatrix=e;f.uniforms.mapSampler=c.texture;f.uniforms.filterMatrix=e.toArray(!0);f.uniforms.scale={x:1,y:1};if(null===b||void 0===b)b=20;f.scale=new m.Point(b,b);return f}h(d,a);d.prototype.apply=function(a,b,d){var c=1/d.destinationFrame.width*(d.size.width/b.size.width);this.uniforms.filterMatrix=a.calculateSpriteMatrix(this.maskMatrix,
this.maskSprite);this.uniforms.scale.x=this.scale.x*c;this.uniforms.scale.y=this.scale.y*c;a.applyFilter(this,b,d)};n(d,[{key:"map",get:function(){return this.uniforms.mapSampler},set:function(a){this.uniforms.mapSampler=a}}]);return d}(m.Filter);f["default"]=a},{"../../core":63,path:22}],143:[function(a,c,f){function h(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,
enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}f.__esModule=!0;c=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(c[f]=a[f]);c["default"]=a;return c}(a("../../core"));a("path");a=function(a){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var f=a.call(this,"\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec4 filterArea;\n\nvarying vec2 vTextureCoord;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n   vTextureCoord = aTextureCoord;\n\n   vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n   texcoords(fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}",
'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n \n --\n \n From:\n https://github.com/mitsuhiko/webgl-meincraft\n \n Copyright (c) 2011 by Armin Ronacher.\n \n Some rights reserved.\n \n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n \n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n \n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n \n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n \n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n    \n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n      vec4 color;\n\n    color = fxaa(uSampler, fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n');
if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!f||"object"!==typeof f&&"function"!==typeof f?this:f}h(c,a);return c}(c.Filter);f["default"]=a},{"../../core":63,path:22}],144:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}f.__esModule=!0;var n=a("./fxaa/FXAAFilter");Object.defineProperty(f,"FXAAFilter",{enumerable:!0,get:function(){return h(n)["default"]}});var m=a("./noise/NoiseFilter");Object.defineProperty(f,"NoiseFilter",
{enumerable:!0,get:function(){return h(m)["default"]}});var g=a("./displacement/DisplacementFilter");Object.defineProperty(f,"DisplacementFilter",{enumerable:!0,get:function(){return h(g)["default"]}});var d=a("./blur/BlurFilter");Object.defineProperty(f,"BlurFilter",{enumerable:!0,get:function(){return h(d)["default"]}});var e=a("./blur/BlurXFilter");Object.defineProperty(f,"BlurXFilter",{enumerable:!0,get:function(){return h(e)["default"]}});var b=a("./blur/BlurYFilter");Object.defineProperty(f,
"BlurYFilter",{enumerable:!0,get:function(){return h(b)["default"]}});var p=a("./colormatrix/ColorMatrixFilter");Object.defineProperty(f,"ColorMatrixFilter",{enumerable:!0,get:function(){return h(p)["default"]}});var r=a("./void/VoidFilter");Object.defineProperty(f,"VoidFilter",{enumerable:!0,get:function(){return h(r)["default"]}})},{"./blur/BlurFilter":135,"./blur/BlurXFilter":136,"./blur/BlurYFilter":137,"./colormatrix/ColorMatrixFilter":141,"./displacement/DisplacementFilter":142,"./fxaa/FXAAFilter":143,
"./noise/NoiseFilter":145,"./void/VoidFilter":146}],145:[function(a,c,f){function h(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}f.__esModule=!0;var n=function(){function a(a,d){for(var c=0;c<d.length;c++){var b=d[c];b.enumerable=b.enumerable||
!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(a,b.key,b)}}return function(c,d,e){d&&a(c.prototype,d);e&&a(c,e);return c}}();c=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=a[d]);c["default"]=a;return c}(a("../../core"));a("path");a=function(a){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var d;d=a.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",
"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float noise;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    float diff = (rand(gl_FragCoord.xy) - 0.5) * noise;\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    gl_FragColor = color;\n}\n");if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
d=!d||"object"!==typeof d&&"function"!==typeof d?this:d;d.noise=.5;return d}h(c,a);n(c,[{key:"noise",get:function(){return this.uniforms.noise},set:function(a){this.uniforms.noise=a}}]);return c}(c.Filter);f["default"]=a},{"../../core":63,path:22}],146:[function(a,c,f){function h(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});
c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}f.__esModule=!0;c=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(c[f]=a[f]);c["default"]=a;return c}(a("../../core"));a("path");a=function(a){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var f;f=a.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",
"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n");if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");f=!f||"object"!==typeof f&&"function"!==typeof f?this:f;f.glShaderKey="void";return f}h(c,a);return c}(c.Filter);f["default"]=a},{"../../core":63,path:22}],147:[function(a,c,f){f.__esModule=!0;var h=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var f in a)Object.prototype.hasOwnProperty.call(a,
f)&&(c[f]=a[f]);c["default"]=a;return c}(a("../core"));a=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.global=new h.Point;this.originalEvent=this.target=null}a.prototype.getLocalPosition=function(a,c,d){return a.worldTransform.applyInverse(d||this.global,c)};return a}();f["default"]=a},{"../core":63}],148:[function(a,c,f){f.__esModule=!0;a=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");
this.stopped=!1;this.data=this.type=this.currentTarget=this.target=null}a.prototype.stopPropagation=function(){this.stopped=!0};a.prototype._reset=function(){this.stopped=!1;this.target=this.currentTarget=null};return a}();f["default"]=a},{}],149:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}function n(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,
enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;var m=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../core"));c=a("./InteractionData");var g=h(c);c=a("./InteractionEvent");var d=h(c);c=a("eventemitter3");c=h(c);var e=a("./interactiveTarget"),e=h(e);a=a("ismobilejs");var b=h(a);Object.assign(m.DisplayObject.prototype,
e["default"]);a=function(a){function c(e,f){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var h;h=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");h=!h||"object"!==typeof h&&"function"!==typeof h?this:h;f=f||{};h.renderer=e;h.autoPreventDefault=void 0!==f.autoPreventDefault?f.autoPreventDefault:!0;h.interactionFrequency=f.interactionFrequency||10;h.mouse=new g["default"];h.mouse.global.set(-999999);h.pointer=
new g["default"];h.pointer.global.set(-999999);h.eventData=new d["default"];h.interactiveDataPool=[];h.interactionDOMElement=null;h.moveWhenInside=!1;h.eventsAdded=!1;h.mouseOverRenderer=!1;h.supportsTouchEvents="ontouchstart"in window;h.supportsPointerEvents=!!window.PointerEvent;h.normalizeTouchEvents=!h.supportsPointerEvents&&h.supportsTouchEvents;h.normalizeMouseEvents=!h.supportsPointerEvents&&!b["default"].any;h.onMouseUp=h.onMouseUp.bind(h);h.processMouseUp=h.processMouseUp.bind(h);h.onMouseDown=
h.onMouseDown.bind(h);h.processMouseDown=h.processMouseDown.bind(h);h.onMouseMove=h.onMouseMove.bind(h);h.processMouseMove=h.processMouseMove.bind(h);h.onMouseOut=h.onMouseOut.bind(h);h.processMouseOverOut=h.processMouseOverOut.bind(h);h.onMouseOver=h.onMouseOver.bind(h);h.onPointerUp=h.onPointerUp.bind(h);h.processPointerUp=h.processPointerUp.bind(h);h.onPointerDown=h.onPointerDown.bind(h);h.processPointerDown=h.processPointerDown.bind(h);h.onPointerMove=h.onPointerMove.bind(h);h.processPointerMove=
h.processPointerMove.bind(h);h.onPointerOut=h.onPointerOut.bind(h);h.processPointerOverOut=h.processPointerOverOut.bind(h);h.onPointerOver=h.onPointerOver.bind(h);h.onTouchStart=h.onTouchStart.bind(h);h.processTouchStart=h.processTouchStart.bind(h);h.onTouchEnd=h.onTouchEnd.bind(h);h.processTouchEnd=h.processTouchEnd.bind(h);h.onTouchMove=h.onTouchMove.bind(h);h.processTouchMove=h.processTouchMove.bind(h);h.defaultCursorStyle="inherit";h.currentCursorStyle="inherit";h._tempPoint=new m.Point;h.resolution=
1;h.setTargetElement(h.renderer.view,h.renderer.resolution);return h}n(c,a);c.prototype.setTargetElement=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;this.removeEvents();this.interactionDOMElement=a;this.resolution=b;this.addEvents()};c.prototype.addEvents=function(){this.interactionDOMElement&&(m.ticker.shared.add(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]=
"none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(this.normalizeTouchEvents&&
(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.normalizeMouseEvents&&(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",
this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0))),window.document.addEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onMouseOver,!0),window.addEventListener("mouseup",this.onMouseUp,!0),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",
this.onTouchStart,!0),this.interactionDOMElement.addEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.addEventListener("touchmove",this.onTouchMove,!0)),this.eventsAdded=!0)};c.prototype.removeEvents=function(){this.interactionDOMElement&&(m.ticker.shared.remove(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=
""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(this.normalizeTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",
this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.normalizeMouseEvents&&(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",
this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0))),window.document.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onMouseOver,!0),window.removeEventListener("mouseup",this.onMouseUp,!0),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",
this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)};c.prototype.update=function(a){this._deltaTime+=a;this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.interactionDOMElement&&(this.didMove?this.didMove=!1:(this.cursor=this.defaultCursorStyle,this.eventData._reset(),this.processInteractive(this.mouse.global,
this.renderer._lastObjectRendered,this.processMouseOverOut,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor))))};c.prototype.dispatchEvent=function(a,b,d){if(!d.stopped&&(d.currentTarget=a,d.type=b,a.emit(b,d),a[b]))a[b](d)};c.prototype.mapPositionToPoint=function(a,b,d){var c;c=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var e=navigator.isCocoonJS?
this.resolution:1/this.resolution;a.x=this.interactionDOMElement.width/c.width*(b-c.left)*e;a.y=this.interactionDOMElement.height/c.height*(d-c.top)*e};c.prototype.processInteractive=function(a,b,d,c,e){if(!b||!b.visible)return!1;e=b.interactive||e;var f=!1,g=e;b.hitArea&&(g=!1);c&&b._mask&&(b._mask.containsPoint(a)||(c=!1));c&&b.filterArea&&(b.filterArea.contains(a.x,a.y)||(c=!1));if(b.interactiveChildren&&b.children)for(var h=b.children,m=h.length-1;0<=m;m--){var p=h[m];this.processInteractive(a,
p,d,c,g)&&p.parent&&(f=!0,c=g=!1)}e&&(c&&!f&&(b.hitArea?(b.worldTransform.applyInverse(a,this._tempPoint),f=b.hitArea.contains(this._tempPoint.x,this._tempPoint.y)):b.containsPoint&&(f=b.containsPoint(a))),b.interactive&&(f&&!this.eventData.target&&(this.eventData.target=b,this.mouse.target=b,this.pointer.target=b),d(b,f)));return f};c.prototype.onMouseDown=function(a){this.mouse.originalEvent=a;this.eventData.data=this.mouse;this.eventData._reset();this.mapPositionToPoint(this.mouse.global,a.clientX,
a.clientY);this.autoPreventDefault&&this.mouse.originalEvent.preventDefault();this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseDown,!0);this.emit(2===a.button||3===a.which?"rightdown":"mousedown",this.eventData)};c.prototype.processMouseDown=function(a,b){var d=this.mouse.originalEvent,d=2===d.button||3===d.which;b&&(a[d?"_isRightDown":"_isLeftDown"]=!0,this.dispatchEvent(a,d?"rightdown":"mousedown",this.eventData))};c.prototype.onMouseUp=function(a){this.mouse.originalEvent=
a;this.eventData.data=this.mouse;this.eventData._reset();this.mapPositionToPoint(this.mouse.global,a.clientX,a.clientY);this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseUp,!0);this.emit(2===a.button||3===a.which?"rightup":"mouseup",this.eventData)};c.prototype.processMouseUp=function(a,b){var d=this.mouse.originalEvent,c=(d=2===d.button||3===d.which)?"_isRightDown":"_isLeftDown";b?(this.dispatchEvent(a,d?"rightup":"mouseup",this.eventData),a[c]&&(a[c]=!1,
this.dispatchEvent(a,d?"rightclick":"click",this.eventData))):a[c]&&(a[c]=!1,this.dispatchEvent(a,d?"rightupoutside":"mouseupoutside",this.eventData))};c.prototype.onMouseMove=function(a){this.mouse.originalEvent=a;this.eventData.data=this.mouse;this.eventData._reset();this.mapPositionToPoint(this.mouse.global,a.clientX,a.clientY);this.didMove=!0;this.cursor=this.defaultCursorStyle;this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseMove,!0);this.emit("mousemove",
this.eventData);this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)};c.prototype.processMouseMove=function(a,b){this.processMouseOverOut(a,b);this.moveWhenInside&&!b||this.dispatchEvent(a,"mousemove",this.eventData)};c.prototype.onMouseOut=function(a){this.mouseOverRenderer=!1;this.mouse.originalEvent=a;this.eventData.data=this.mouse;this.eventData._reset();this.mapPositionToPoint(this.mouse.global,a.clientX,a.clientY);this.interactionDOMElement.style.cursor=
this.defaultCursorStyle;this.mapPositionToPoint(this.mouse.global,a.clientX,a.clientY);this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!1);this.emit("mouseout",this.eventData)};c.prototype.processMouseOverOut=function(a,b){b&&this.mouseOverRenderer?(a._mouseOver||(a._mouseOver=!0,this.dispatchEvent(a,"mouseover",this.eventData)),a.buttonMode&&(this.cursor=a.defaultCursor)):a._mouseOver&&(a._mouseOver=!1,this.dispatchEvent(a,"mouseout",this.eventData))};
c.prototype.onMouseOver=function(a){this.mouseOverRenderer=!0;this.mouse.originalEvent=a;this.eventData.data=this.mouse;this.eventData._reset();this.emit("mouseover",this.eventData)};c.prototype.onPointerDown=function(a){this.normalizeToPointerData(a);this.pointer.originalEvent=a;this.eventData.data=this.pointer;this.eventData._reset();this.mapPositionToPoint(this.pointer.global,a.clientX,a.clientY);this.autoPreventDefault&&(this.normalizeMouseEvents||this.normalizeTouchEvents)&&this.pointer.originalEvent.preventDefault();
this.processInteractive(this.pointer.global,this.renderer._lastObjectRendered,this.processPointerDown,!0);this.emit("pointerdown",this.eventData)};c.prototype.processPointerDown=function(a,b){b&&(a._pointerDown=!0,this.dispatchEvent(a,"pointerdown",this.eventData))};c.prototype.onPointerUp=function(a){this.normalizeToPointerData(a);this.pointer.originalEvent=a;this.eventData.data=this.pointer;this.eventData._reset();this.mapPositionToPoint(this.pointer.global,a.clientX,a.clientY);this.processInteractive(this.pointer.global,
this.renderer._lastObjectRendered,this.processPointerUp,!0);this.emit("pointerup",this.eventData)};c.prototype.processPointerUp=function(a,b){b?(this.dispatchEvent(a,"pointerup",this.eventData),a._pointerDown&&(a._pointerDown=!1,this.dispatchEvent(a,"pointertap",this.eventData))):a._pointerDown&&(a._pointerDown=!1,this.dispatchEvent(a,"pointerupoutside",this.eventData))};c.prototype.onPointerMove=function(a){this.normalizeToPointerData(a);this.pointer.originalEvent=a;this.eventData.data=this.pointer;
this.eventData._reset();this.mapPositionToPoint(this.pointer.global,a.clientX,a.clientY);this.processInteractive(this.pointer.global,this.renderer._lastObjectRendered,this.processPointerMove,!0);this.emit("pointermove",this.eventData)};c.prototype.processPointerMove=function(a,b){this.pointer.originalEvent.changedTouches||this.processPointerOverOut(a,b);this.moveWhenInside&&!b||this.dispatchEvent(a,"pointermove",this.eventData)};c.prototype.onPointerOut=function(a){this.normalizeToPointerData(a);
this.pointer.originalEvent=a;this.eventData.data=this.pointer;this.eventData._reset();this.mapPositionToPoint(this.pointer.global,a.clientX,a.clientY);this.processInteractive(this.pointer.global,this.renderer._lastObjectRendered,this.processPointerOverOut,!1);this.emit("pointerout",this.eventData)};c.prototype.processPointerOverOut=function(a,b){b&&this.mouseOverRenderer?a._pointerOver||(a._pointerOver=!0,this.dispatchEvent(a,"pointerover",this.eventData)):a._pointerOver&&(a._pointerOver=!1,this.dispatchEvent(a,
"pointerout",this.eventData))};c.prototype.onPointerOver=function(a){this.pointer.originalEvent=a;this.eventData.data=this.pointer;this.eventData._reset();this.emit("pointerover",this.eventData)};c.prototype.onTouchStart=function(a){this.autoPreventDefault&&a.preventDefault();for(var b=a.changedTouches,d=b.length,c=0;c<d;c++){var e=this.getTouchData(b[c]);e.originalEvent=a;this.eventData.data=e;this.eventData._reset();this.processInteractive(e.global,this.renderer._lastObjectRendered,this.processTouchStart,
!0);this.emit("touchstart",this.eventData);this.returnTouchData(e)}};c.prototype.processTouchStart=function(a,b){b&&(a._touchDown=!0,this.dispatchEvent(a,"touchstart",this.eventData))};c.prototype.onTouchEnd=function(a){this.autoPreventDefault&&a.preventDefault();for(var b=a.changedTouches,d=b.length,c=0;c<d;c++){var e=this.getTouchData(b[c]);e.originalEvent=a;this.eventData.data=e;this.eventData._reset();this.processInteractive(e.global,this.renderer._lastObjectRendered,this.processTouchEnd,!0);
this.emit("touchend",this.eventData);this.returnTouchData(e)}};c.prototype.processTouchEnd=function(a,b){b?(this.dispatchEvent(a,"touchend",this.eventData),a._touchDown&&(a._touchDown=!1,this.dispatchEvent(a,"tap",this.eventData))):a._touchDown&&(a._touchDown=!1,this.dispatchEvent(a,"touchendoutside",this.eventData))};c.prototype.onTouchMove=function(a){this.autoPreventDefault&&a.preventDefault();for(var b=a.changedTouches,d=b.length,c=0;c<d;c++){var e=this.getTouchData(b[c]);e.originalEvent=a;this.eventData.data=
e;this.eventData._reset();this.processInteractive(e.global,this.renderer._lastObjectRendered,this.processTouchMove,this.moveWhenInside);this.emit("touchmove",this.eventData);this.returnTouchData(e)}};c.prototype.processTouchMove=function(a,b){this.moveWhenInside&&!b||this.dispatchEvent(a,"touchmove",this.eventData)};c.prototype.getTouchData=function(a){var b=this.interactiveDataPool.pop()||new g["default"];b.identifier=a.identifier;this.mapPositionToPoint(b.global,a.clientX,a.clientY);navigator.isCocoonJS&&
(b.global.x/=this.resolution,b.global.y/=this.resolution);a.globalX=b.global.x;a.globalY=b.global.y;return b};c.prototype.returnTouchData=function(a){this.interactiveDataPool.push(a)};c.prototype.normalizeToPointerData=function(a){this.normalizeTouchEvents&&a.changedTouches?("undefined"===typeof a.button&&(a.button=a.touches.length?1:0),"undefined"===typeof a.buttons&&(a.buttons=a.touches.length?1:0),"undefined"===typeof a.isPrimary&&(a.isPrimary=1===a.touches.length),"undefined"===typeof a.width&&
(a.width=a.changedTouches[0].radiusX||1),"undefined"===typeof a.height&&(a.height=a.changedTouches[0].radiusY||1),"undefined"===typeof a.tiltX&&(a.tiltX=0),"undefined"===typeof a.tiltY&&(a.tiltY=0),"undefined"===typeof a.pointerType&&(a.pointerType="touch"),"undefined"===typeof a.pointerId&&(a.pointerId=a.changedTouches[0].identifier||0),"undefined"===typeof a.pressure&&(a.pressure=a.changedTouches[0].force||.5),"undefined"===typeof a.rotation&&(a.rotation=a.changedTouches[0].rotationAngle||0),"undefined"===
typeof a.clientX&&(a.clientX=a.changedTouches[0].clientX),"undefined"===typeof a.clientY&&(a.clientY=a.changedTouches[0].clientY),"undefined"===typeof a.pageX&&(a.pageX=a.changedTouches[0].pageX),"undefined"===typeof a.pageY&&(a.pageY=a.changedTouches[0].pageY),"undefined"===typeof a.screenX&&(a.screenX=a.changedTouches[0].screenX),"undefined"===typeof a.screenY&&(a.screenY=a.changedTouches[0].screenY),"undefined"===typeof a.layerX&&(a.layerX=a.offsetX=a.clientX),"undefined"===typeof a.layerY&&(a.layerY=
a.offsetY=a.clientY)):this.normalizeMouseEvents&&("undefined"===typeof a.isPrimary&&(a.isPrimary=!0),"undefined"===typeof a.width&&(a.width=1),"undefined"===typeof a.height&&(a.height=1),"undefined"===typeof a.tiltX&&(a.tiltX=0),"undefined"===typeof a.tiltY&&(a.tiltY=0),"undefined"===typeof a.pointerType&&(a.pointerType="mouse"),"undefined"===typeof a.pointerId&&(a.pointerId=1),"undefined"===typeof a.pressure&&(a.pressure=.5),"undefined"===typeof a.rotation&&(a.rotation=0))};c.prototype.destroy=function(){this.removeEvents();
this.removeAllListeners();this._tempPoint=this.processTouchMove=this.onTouchMove=this.processTouchEnd=this.onTouchEnd=this.processTouchStart=this.onTouchStart=this.onPointerOver=this.processPointerOverOut=this.onPointerOut=this.processPointerMove=this.onPointerMove=this.processPointerUp=this.onPointerUp=this.processPointerDown=this.onPointerDown=this.onMouseOver=this.processMouseOverOut=this.onMouseOut=this.processMouseMove=this.onMouseMove=this.processMouseUp=this.onMouseUp=this.processMouseDown=
this.onMouseDown=this.interactionDOMElement=this.interactiveDataPool=this.eventData=this.mouse=this.renderer=null};return c}(c["default"]);f["default"]=a;m.WebGLRenderer.registerPlugin("interaction",a);m.CanvasRenderer.registerPlugin("interaction",a)},{"../core":63,"./InteractionData":147,"./InteractionEvent":148,"./interactiveTarget":151,eventemitter3:3,ismobilejs:4}],150:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}f.__esModule=!0;var n=a("./InteractionData");Object.defineProperty(f,
"InteractionData",{enumerable:!0,get:function(){return h(n)["default"]}});var m=a("./InteractionManager");Object.defineProperty(f,"InteractionManager",{enumerable:!0,get:function(){return h(m)["default"]}});var g=a("./interactiveTarget");Object.defineProperty(f,"interactiveTarget",{enumerable:!0,get:function(){return h(g)["default"]}})},{"./InteractionData":147,"./InteractionManager":149,"./interactiveTarget":151}],151:[function(a,c,f){f.__esModule=!0;f["default"]={interactive:!1,interactiveChildren:!0,
hitArea:null,buttonMode:!1,defaultCursor:"pointer",_over:!1,_isLeftDown:!1,_isRightDown:!1,_pointerOver:!1,_pointerDown:!1,_touchDown:!1}},{}],152:[function(a,c,f){function h(a,b){var c={},e=a.data.getElementsByTagName("info")[0],f=a.data.getElementsByTagName("common")[0];c.font=e.getAttribute("face");c.size=parseInt(e.getAttribute("size"),10);c.lineHeight=parseInt(f.getAttribute("lineHeight"),10);c.chars={};e=a.data.getElementsByTagName("char");for(f=0;f<e.length;f++){var g=parseInt(e[f].getAttribute("id"),
10),h=new m.Rectangle(parseInt(e[f].getAttribute("x"),10)+b.frame.x,parseInt(e[f].getAttribute("y"),10)+b.frame.y,parseInt(e[f].getAttribute("width"),10),parseInt(e[f].getAttribute("height"),10));c.chars[g]={xOffset:parseInt(e[f].getAttribute("xoffset"),10),yOffset:parseInt(e[f].getAttribute("yoffset"),10),xAdvance:parseInt(e[f].getAttribute("xadvance"),10),kerning:{},texture:new m.Texture(b.baseTexture,h)}}e=a.data.getElementsByTagName("kerning");for(f=0;f<e.length;f++){var g=parseInt(e[f].getAttribute("first"),
10),h=parseInt(e[f].getAttribute("second"),10),n=parseInt(e[f].getAttribute("amount"),10);c.chars[h]&&(c.chars[h].kerning[g]=n)}a.bitmapFont=c;d.BitmapText.fonts[c.font]=c}f.__esModule=!0;f.parse=h;f["default"]=function(){return function(a,b){if(a.data&&a.type===g.Resource.TYPE.XML)if(0===a.data.getElementsByTagName("page").length||0===a.data.getElementsByTagName("info").length||null===a.data.getElementsByTagName("info")[0].getAttribute("face"))b();else{var d=a.isDataUrl?"":n.dirname(a.url);a.isDataUrl&&
("."===d&&(d=""),this.baseUrl&&d&&("/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(d+="/"),d=d.replace(this.baseUrl,"")));d&&"/"!==d.charAt(d.length-1)&&(d+="/");d+=a.data.getElementsByTagName("page")[0].getAttribute("file");m.utils.TextureCache[d]?(h(a,m.utils.TextureCache[d]),b()):this.add(a.name+"_image",d,{crossOrigin:a.crossOrigin,loadType:g.Resource.LOAD_TYPE.IMAGE,metadata:a.metadata.imageMetadata,parentResource:a},function(d){h(a,d.texture);b()})}else b()}};var n=function(a){if(a&&a.__esModule)return a;
var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("path")),m=a("../core"),g=a("resource-loader"),d=a("../extras")},{"../core":63,"../extras":133,path:22,"resource-loader":34}],153:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}f.__esModule=!0;var n=a("./loader");Object.defineProperty(f,"Loader",{enumerable:!0,get:function(){return h(n)["default"]}});var m=a("./bitmapFontParser");Object.defineProperty(f,"bitmapFontParser",
{enumerable:!0,get:function(){return h(m)["default"]}});Object.defineProperty(f,"parseBitmapFontData",{enumerable:!0,get:function(){return m.parse}});var g=a("./spritesheetParser");Object.defineProperty(f,"spritesheetParser",{enumerable:!0,get:function(){return h(g)["default"]}});var d=a("./textureParser");Object.defineProperty(f,"textureParser",{enumerable:!0,get:function(){return h(d)["default"]}});var e=a("resource-loader");Object.defineProperty(f,"Resource",{enumerable:!0,get:function(){return e.Resource}})},
{"./bitmapFontParser":152,"./loader":154,"./spritesheetParser":155,"./textureParser":156,"resource-loader":34}],154:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}function n(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=
Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;c=a("resource-loader");c=h(c);var g=a("resource-loader/lib/middlewares/parsing/blob"),d=a("eventemitter3"),e=h(d),d=a("./textureParser"),d=h(d),b=a("./spritesheetParser"),b=h(b);a=a("./bitmapFontParser");a=h(a);var p=function(a){function b(d,c){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");
var f=n(this,a.call(this,d,c));e["default"].call(f);for(var g=0;g<b._pixiMiddleware.length;++g)f.use(b._pixiMiddleware[g]());f.onStart.add(function(a){return f.emit("start",a)});f.onProgress.add(function(a,b){return f.emit("progress",a,b)});f.onError.add(function(a,b,d){return f.emit("error",a,b,d)});f.onLoad.add(function(a,b){return f.emit("load",a,b)});f.onComplete.add(function(a,b){return f.emit("complete",a,b)});return f}m(b,a);b.addPixiMiddleware=function(a){b._pixiMiddleware.push(a)};return b}(c["default"]);
f["default"]=p;for(var r in e["default"].prototype)p.prototype[r]=e["default"].prototype[r];p._pixiMiddleware=[g.blobMiddlewareFactory,d["default"],b["default"],a["default"]];f=c["default"].Resource;f.setExtensionXhrType("fnt",f.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":152,"./spritesheetParser":155,"./textureParser":156,eventemitter3:3,"resource-loader":34,"resource-loader/lib/middlewares/parsing/blob":35}],155:[function(a,c,f){f.__esModule=!0;f["default"]=function(){return function(a,c){var b=
void 0,d=a.name+"_image";if(a.data&&a.type===h.Resource.TYPE.JSON&&a.data.frames&&!this.resources[d]){var e={crossOrigin:a.crossOrigin,loadType:h.Resource.LOAD_TYPE.IMAGE,metadata:a.metadata.imageMetadata,parentResource:a},b=a.isDataUrl?a.data.meta.image:n["default"].dirname(a.url.replace(this.baseUrl,""))+"/"+a.data.meta.image;this.add(d,b,e,function(b){function d(b,d){for(var c=b;c-b<d&&c<p.length;){var e=p[c],f=h[e].frame;if(f){var g,q=null,y=new m.Rectangle(0,0,h[e].sourceSize.w/r,h[e].sourceSize.h/
r);g=h[e].rotated?new m.Rectangle(f.x/r,f.y/r,f.h/r,f.w/r):new m.Rectangle(f.x/r,f.y/r,f.w/r,f.h/r);h[e].trimmed&&(q=new m.Rectangle(h[e].spriteSourceSize.x/r,h[e].spriteSourceSize.y/r,f.w/r,f.h/r));a.textures[e]=new m.Texture(n,g,y,q,h[e].rotated?2:0);m.utils.TextureCache[e]=a.textures[e]}c++}}function e(a){d(q*g,g);q++;setTimeout(a,0)}function f(){e(function(){q*g<p.length?f():c()})}a.textures={};var h=a.data.frames,p=Object.keys(h),n=b.texture.baseTexture;b=a.data.meta.scale;var r=m.utils.getResolutionOfUrl(a.url,
null);null===r&&(r=void 0!==b?b:1);1!==r&&(n.resolution=r,n.update());var q=0;p.length<=g?(d(0,g),c()):f()})}else c()}};var h=a("resource-loader"),n=(c=a("path"))&&c.__esModule?c:{"default":c},m=function(a){if(a&&a.__esModule)return a;var d={};if(null!=a)for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(d[b]=a[b]);d["default"]=a;return d}(a("../core")),g=1E3},{"../core":63,path:22,"resource-loader":34}],156:[function(a,c,f){f.__esModule=!0;f["default"]=function(){return function(a,c){if(a.data&&
a.type===n.Resource.TYPE.IMAGE){var d=new h.BaseTexture(a.data,null,h.utils.getResolutionOfUrl(a.url));d.imageUrl=a.url;a.texture=new h.Texture(d);h.utils.BaseTextureCache[a.name]=d;h.utils.TextureCache[a.name]=a.texture;a.name!==a.url&&(h.utils.BaseTextureCache[a.url]=d,h.utils.TextureCache[a.url]=a.texture)}c()}};var h=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=a[d]);c["default"]=a;return c}(a("../core")),n=a("resource-loader")},
{"../core":63,"resource-loader":34}],157:[function(a,c,f){function h(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}f.__esModule=!0;var n=function(){function a(a,d){for(var b=0;b<d.length;b++){var c=d[b];c.enumerable=c.enumerable||!1;c.configurable=
!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),m=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../core")),g=new m.Point,d=new m.Polygon;a=function(a){function b(d,c,e,f,g){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var h;h=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
h=!h||"object"!==typeof h&&"function"!==typeof h?this:h;h._texture=null;h.uvs=e||new Float32Array([0,0,1,0,1,1,0,1]);h.vertices=c||new Float32Array([0,0,100,0,100,100,0,100]);h.indices=f||new Uint16Array([0,1,3,2]);h.dirty=0;h.indexDirty=0;h.blendMode=m.BLEND_MODES.NORMAL;h.canvasPadding=0;h.drawMode=g||b.DRAW_MODES.TRIANGLE_MESH;h.texture=d;h.shader=null;h.tintRgb=new Float32Array([1,1,1]);h._glDatas={};h.pluginName="mesh";return h}h(b,a);b.prototype._renderWebGL=function(a){a.setObjectRenderer(a.plugins[this.pluginName]);
a.plugins[this.pluginName].render(this)};b.prototype._renderCanvas=function(a){a.plugins[this.pluginName].render(this)};b.prototype._onTextureUpdate=function(){};b.prototype._calculateBounds=function(){this._bounds.addVertices(this.transform,this.vertices,0,this.vertices.length)};b.prototype.containsPoint=function(a){if(!this.getBounds().contains(a.x,a.y))return!1;this.worldTransform.applyInverse(a,g);a=this.vertices;for(var c=d.points,e=this.indices,f=this.indices.length,h=this.drawMode===b.DRAW_MODES.TRIANGLES?
3:1,m=0;m+2<f;m+=h){var p=2*e[m],n=2*e[m+1],z=2*e[m+2];c[0]=a[p];c[1]=a[p+1];c[2]=a[n];c[3]=a[n+1];c[4]=a[z];c[5]=a[z+1];if(d.contains(g.x,g.y))return!0}return!1};n(b,[{key:"texture",get:function(){return this._texture},set:function(a){if(this._texture!==a&&(this._texture=a))if(a.baseTexture.hasLoaded)this._onTextureUpdate();else a.once("update",this._onTextureUpdate,this)}},{key:"tint",get:function(){return m.utils.rgb2hex(this.tintRgb)},set:function(a){this.tintRgb=m.utils.hex2rgb(a,this.tintRgb)}}]);
return b}(m.Container);f["default"]=a;a.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":63}],158:[function(a,c,f){function h(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}f.__esModule=!0;var n=function(){function a(a,d){for(var c=0;c<d.length;c++){var b=
d[c];b.enumerable=b.enumerable||!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(a,b.key,b)}}return function(c,d,e){d&&a(c.prototype,d);e&&a(c,e);return c}}();a=a("./Plane");a=function(a){function c(d,e,b,f,g){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var h;h=a.call(this,d,4,4);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");h=!h||"object"!==typeof h&&"function"!==typeof h?this:h;var m=h.uvs;
m[6]=m[14]=m[22]=m[30]=1;m[25]=m[27]=m[29]=m[31]=1;h._origWidth=d.width;h._origHeight=d.height;h._uvw=1/h._origWidth;h._uvh=1/h._origHeight;h.width=d.width;h.height=d.height;m[2]=m[10]=m[18]=m[26]=h._uvw*e;m[4]=m[12]=m[20]=m[28]=1-h._uvw*f;m[9]=m[11]=m[13]=m[15]=h._uvh*b;m[17]=m[19]=m[21]=m[23]=1-h._uvh*g;h.leftWidth="undefined"!==typeof e?e:10;h.rightWidth="undefined"!==typeof f?f:10;h.topHeight="undefined"!==typeof b?b:10;h.bottomHeight="undefined"!==typeof g?g:10;return h}h(c,a);c.prototype.updateHorizontalVertices=
function(){var a=this.vertices;a[9]=a[11]=a[13]=a[15]=this._topHeight;a[17]=a[19]=a[21]=a[23]=this._height-this._bottomHeight;a[25]=a[27]=a[29]=a[31]=this._height};c.prototype.updateVerticalVertices=function(){var a=this.vertices;a[2]=a[10]=a[18]=a[26]=this._leftWidth;a[4]=a[12]=a[20]=a[28]=this._width-this._rightWidth;a[6]=a[14]=a[22]=a[30]=this._width};c.prototype._renderCanvas=function(a){var d=a.context;d.globalAlpha=this.worldAlpha;var b=this.worldTransform,c=a.resolution;a.roundPixels?d.setTransform(b.a*
c,b.b*c,b.c*c,b.d*c,b.tx*c|0,b.ty*c|0):d.setTransform(b.a*c,b.b*c,b.c*c,b.d*c,b.tx*c,b.ty*c);c=this._texture.baseTexture;a=c.source;b=c.width;c=c.height;this.drawSegment(d,a,b,c,0,1,10,11);this.drawSegment(d,a,b,c,2,3,12,13);this.drawSegment(d,a,b,c,4,5,14,15);this.drawSegment(d,a,b,c,8,9,18,19);this.drawSegment(d,a,b,c,10,11,20,21);this.drawSegment(d,a,b,c,12,13,22,23);this.drawSegment(d,a,b,c,16,17,26,27);this.drawSegment(d,a,b,c,18,19,28,29);this.drawSegment(d,a,b,c,20,21,30,31)};c.prototype.drawSegment=
function(a,c,b,f,g,h,m,n){var d=this.uvs,e=this.vertices,p=(d[m]-d[g])*b,r=(d[n]-d[h])*f;m=e[m]-e[g];n=e[n]-e[h];1>p&&(p=1);1>r&&(r=1);1>m&&(m=1);1>n&&(n=1);a.drawImage(c,d[g]*b,d[h]*f,p,r,e[g],e[h],m,n)};n(c,[{key:"width",get:function(){return this._width},set:function(a){this._width=a;this.updateVerticalVertices()}},{key:"height",get:function(){return this._height},set:function(a){this._height=a;this.updateHorizontalVertices()}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(a){this._leftWidth=
a;var d=this.uvs,b=this.vertices;d[2]=d[10]=d[18]=d[26]=this._uvw*a;b[2]=b[10]=b[18]=b[26]=a;this.dirty=!0}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(a){this._rightWidth=a;var d=this.uvs,b=this.vertices;d[4]=d[12]=d[20]=d[28]=1-this._uvw*a;b[4]=b[12]=b[20]=b[28]=this._width-a;this.dirty=!0}},{key:"topHeight",get:function(){return this._topHeight},set:function(a){this._topHeight=a;var d=this.uvs,b=this.vertices;d[9]=d[11]=d[13]=d[15]=this._uvh*a;b[9]=b[11]=b[13]=b[15]=
a;this.dirty=!0}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(a){this._bottomHeight=a;var d=this.uvs,b=this.vertices;d[17]=d[19]=d[21]=d[23]=1-this._uvh*a;b[17]=b[19]=b[21]=b[23]=this._height-a;this.dirty=!0}}]);return c}((a&&a.__esModule?a:{"default":a})["default"]);f["default"]=a},{"./Plane":159}],159:[function(a,c,f){function h(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=
Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}f.__esModule=!0;var n=(a=a("./Mesh"))&&a.__esModule?a:{"default":a};a=function(a){function c(d,e,b){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");d=a.call(this,d);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");d=!d||"object"!==typeof d&&"function"!==typeof d?
this:d;d._ready=!0;d.verticesX=e||10;d.verticesY=b||10;d.drawMode=n["default"].DRAW_MODES.TRIANGLES;d.refresh();return d}h(c,a);c.prototype.refresh=function(){for(var a=this.verticesX*this.verticesY,c=[],b=[],f=[],g=this.texture,h=this.verticesX-1,m=this.verticesY-1,n=g.width/h,v=g.height/m,u=0;u<a;u++)if(g._uvs){var t=u%this.verticesX,z=u/this.verticesX|0;c.push(t*n,z*v);b.push(g._uvs.x0+t/(this.verticesX-1)*(g._uvs.x1-g._uvs.x0),g._uvs.y0+z/(this.verticesY-1)*(g._uvs.y3-g._uvs.y0))}else b.push(0);
a=h*m;for(g=0;g<a;g++)m=g%h,n=g/h|0,v=n*this.verticesX+m+1,u=(n+1)*this.verticesX+m,t=(n+1)*this.verticesX+m+1,f.push(n*this.verticesX+m,v,u),f.push(v,t,u);this.vertices=new Float32Array(c);this.uvs=new Float32Array(b);this.colors=new Float32Array([]);this.indices=new Uint16Array(f);this.indexDirty=!0};c.prototype._onTextureUpdate=function(){n["default"].prototype._onTextureUpdate.call(this);this._ready&&this.refresh()};return c}(n["default"]);f["default"]=a},{"./Mesh":157}],160:[function(a,c,f){function h(a,
c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}f.__esModule=!0;c=(c=a("./Mesh"))&&c.__esModule?c:{"default":c};var n=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=a[d]);
c["default"]=a;return c}(a("../core"));a=function(a){function c(d,e){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this,d);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==typeof b&&"function"!==typeof b?this:b;b.points=e;b.vertices=new Float32Array(4*e.length);b.uvs=new Float32Array(4*e.length);b.colors=new Float32Array(2*e.length);b.indices=new Uint16Array(2*e.length);b._ready=!0;b.refresh();
return b}h(c,a);c.prototype.refresh=function(){var a=this.points;if(!(1>a.length)&&this._texture._uvs){this.vertices.length/4!==a.length&&(this.vertices=new Float32Array(4*a.length),this.uvs=new Float32Array(4*a.length),this.colors=new Float32Array(2*a.length),this.indices=new Uint16Array(2*a.length));var c=this.uvs,b=this.indices,f=this.colors,g=this._texture._uvs,h=new n.Point(g.x0,g.y0),g=new n.Point(g.x2-g.x0,Number(g.y2-g.y0));c[0]=0+h.x;c[1]=0+h.y;c[2]=0+h.x;c[3]=g.y+h.y;f[0]=1;f[1]=1;b[0]=
0;b[1]=1;for(var a=a.length,m=1;m<a;m++){var x=4*m,v=m/(a-1);c[x]=v*g.x+h.x;c[x+1]=0+h.y;c[x+2]=v*g.x+h.x;c[x+3]=g.y+h.y;x=2*m;f[x]=1;f[x+1]=1;x=2*m;b[x]=x;b[x+1]=x+1}this.dirty++;this.indexDirty++}};c.prototype._onTextureUpdate=function(){a.prototype._onTextureUpdate.call(this);this._ready&&this.refresh()};c.prototype.updateTransform=function(){var a=this.points;if(!(1>a.length)){for(var c=a[0],b,f,g=this.vertices,h=a.length,m=0;m<h;m++){var n=a[m],v=4*m;b=m<a.length-1?a[m+1]:n;f=-(b.x-c.x);c=b.y-
c.y;b=Math.sqrt(c*c+f*f);var u=this._texture.height/2,c=c/b;f/=b;c*=u;f*=u;g[v]=n.x+c;g[v+1]=n.y+f;g[v+2]=n.x-c;g[v+3]=n.y-f;c=n}this.containerUpdateTransform()}};return c}(c["default"]);f["default"]=a},{"../core":63,"./Mesh":157}],161:[function(a,c,f){f.__esModule=!0;c=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(c[f]=a[f]);c["default"]=a;return c}(a("../../core"));var h=(a=a("../Mesh"))&&a.__esModule?a:{"default":a};a=function(){function a(c){if(!(this instanceof
a))throw new TypeError("Cannot call a class as a function");this.renderer=c}a.prototype.render=function(a){var c=this.renderer,d=c.context,e=a.worldTransform,b=c.resolution;c.roundPixels?d.setTransform(e.a*b,e.b*b,e.c*b,e.d*b,e.tx*b|0,e.ty*b|0):d.setTransform(e.a*b,e.b*b,e.c*b,e.d*b,e.tx*b,e.ty*b);c.setBlendMode(a.blendMode);a.drawMode===h["default"].DRAW_MODES.TRIANGLE_MESH?this._renderTriangleMesh(a):this._renderTriangles(a)};a.prototype._renderTriangleMesh=function(a){for(var c=a.vertices.length/
2,d=0;d<c-2;d++){var e=2*d;this._renderDrawTriangle(a,e,e+2,e+4)}};a.prototype._renderTriangles=function(a){for(var c=a.indices,d=c.length,e=0;e<d;e+=3)this._renderDrawTriangle(a,2*c[e],2*c[e+1],2*c[e+2])};a.prototype._renderDrawTriangle=function(a,c,d,e){var b=this.renderer.context,f=a.uvs,h=a.vertices,g=a._texture;if(g.valid){var g=g.baseTexture,m=g.source,n=g.width,v=g.height,u=f[c]*g.width,t=f[d]*g.width,z=f[e]*g.width,w=f[c+1]*g.height,A=f[d+1]*g.height,f=f[e+1]*g.height,B=h[c],F=h[d],C=h[e];
c=h[c+1];d=h[d+1];e=h[e+1];if(0<a.canvasPadding){h=a.canvasPadding/a.worldTransform.a;a=a.canvasPadding/a.worldTransform.d;var D=(B+F+C)/3,E=(c+d+e)/3,G=B-D,I=c-E,H=Math.sqrt(G*G+I*I),B=D+G/H*(H+h);c=E+I/H*(H+a);G=F-D;I=d-E;H=Math.sqrt(G*G+I*I);F=D+G/H*(H+h);d=E+I/H*(H+a);G=C-D;I=e-E;H=Math.sqrt(G*G+I*I);C=D+G/H*(H+h);e=E+I/H*(H+a)}b.save();b.beginPath();b.moveTo(B,c);b.lineTo(F,d);b.lineTo(C,e);b.closePath();b.clip();a=u*A+w*z+t*f-A*z-w*t-u*f;b.transform((B*A+w*C+F*f-A*C-w*F-B*f)/a,(c*A+w*e+d*f-
A*e-w*d-c*f)/a,(u*F+B*z+t*C-F*z-B*t-u*C)/a,(u*d+c*z+t*e-d*z-c*t-u*e)/a,(u*A*C+w*F*z+B*t*f-B*A*z-w*t*C-u*F*f)/a,(u*A*e+w*d*z+c*t*f-c*A*z-w*t*e-u*d*f)/a);b.drawImage(m,0,0,n*g.resolution,v*g.resolution,0,0,n,v);b.restore()}};a.prototype.renderMeshFlat=function(a){var c=this.renderer.context;a=a.vertices;var d=a.length/2;c.beginPath();for(var e=1;e<d-2;++e){var b=2*e,f=a[b+2],h=a[b+3],m=a[b+4],n=a[b+5];c.moveTo(a[b],a[b+1]);c.lineTo(f,h);c.lineTo(m,n)}c.fillStyle="#FF0000";c.fill();c.closePath()};a.prototype.destroy=
function(){this.renderer=null};return a}();f["default"]=a;c.CanvasRenderer.registerPlugin("mesh",a)},{"../../core":63,"../Mesh":157}],162:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}f.__esModule=!0;var n=a("./Mesh");Object.defineProperty(f,"Mesh",{enumerable:!0,get:function(){return h(n)["default"]}});var m=a("./webgl/MeshRenderer");Object.defineProperty(f,"MeshRenderer",{enumerable:!0,get:function(){return h(m)["default"]}});var g=a("./canvas/CanvasMeshRenderer");Object.defineProperty(f,
"CanvasMeshRenderer",{enumerable:!0,get:function(){return h(g)["default"]}});var d=a("./Plane");Object.defineProperty(f,"Plane",{enumerable:!0,get:function(){return h(d)["default"]}});var e=a("./NineSlicePlane");Object.defineProperty(f,"NineSlicePlane",{enumerable:!0,get:function(){return h(e)["default"]}});var b=a("./Rope");Object.defineProperty(f,"Rope",{enumerable:!0,get:function(){return h(b)["default"]}})},{"./Mesh":157,"./NineSlicePlane":158,"./Plane":159,"./Rope":160,"./canvas/CanvasMeshRenderer":161,
"./webgl/MeshRenderer":163}],163:[function(a,c,f){function h(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}f.__esModule=!0;var n=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var b in a)Object.prototype.hasOwnProperty.call(a,
b)&&(c[b]=a[b]);c["default"]=a;return c}(a("../../core")),m=(c=a("pixi-gl-core"))&&c.__esModule?c:{"default":c},g=(c=a("../Mesh"))&&c.__esModule?c:{"default":c};a("path");a=function(a){function c(b){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");b=a.call(this,b);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==typeof b&&"function"!==typeof b?this:b;b.shader=null;return b}h(c,a);c.prototype.onContextChange=
function(){this.shader=new n.Shader(this.renderer.gl,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 translationMatrix;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n}\n","varying vec2 vTextureCoord;\nuniform float alpha;\nuniform vec3 tint;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * vec4(tint * alpha, alpha);\n}\n")};
c.prototype.render=function(a){var b=this.renderer,c=b.gl,d=a._texture;if(d.valid){var e=a._glDatas[b.CONTEXT_UID];e||(b.bindVao(null),e={shader:this.shader,vertexBuffer:m["default"].GLBuffer.createVertexBuffer(c,a.vertices,c.STREAM_DRAW),uvBuffer:m["default"].GLBuffer.createVertexBuffer(c,a.uvs,c.STREAM_DRAW),indexBuffer:m["default"].GLBuffer.createIndexBuffer(c,a.indices,c.STATIC_DRAW),vao:null,dirty:a.dirty,indexDirty:a.indexDirty},e.vao=(new m["default"].VertexArrayObject(c)).addIndex(e.indexBuffer).addAttribute(e.vertexBuffer,
e.shader.attributes.aVertexPosition,c.FLOAT,!1,8,0).addAttribute(e.uvBuffer,e.shader.attributes.aTextureCoord,c.FLOAT,!1,8,0),a._glDatas[b.CONTEXT_UID]=e);b.bindVao(e.vao);a.dirty!==e.dirty&&(e.dirty=a.dirty,e.uvBuffer.upload(a.uvs));a.indexDirty!==e.indexDirty&&(e.indexDirty=a.indexDirty,e.indexBuffer.upload(a.indices));e.vertexBuffer.upload(a.vertices);b.bindShader(e.shader);e.shader.uniforms.uSampler=b.bindTexture(d);b.state.setBlendMode(a.blendMode);e.shader.uniforms.translationMatrix=a.worldTransform.toArray(!0);
e.shader.uniforms.alpha=a.worldAlpha;e.shader.uniforms.tint=a.tintRgb;e.vao.draw(a.drawMode===g["default"].DRAW_MODES.TRIANGLE_MESH?c.TRIANGLE_STRIP:c.TRIANGLES,a.indices.length,0)}};return c}(n.ObjectRenderer);f["default"]=a;n.WebGLRenderer.registerPlugin("mesh",a)},{"../../core":63,"../Mesh":157,path:22,"pixi-gl-core":12}],164:[function(a,c,f){function h(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&
c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}f.__esModule=!0;var n=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=a[d]);c["default"]=a;return c}(a("../core"));a=function(a){function c(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1500,e=arguments[1],b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:
16384;if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var f;f=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");f=!f||"object"!==typeof f&&"function"!==typeof f?this:f;16384<b&&(b=16384);b>d&&(b=d);f._properties=[!1,!0,!1,!1,!1];f._maxSize=d;f._batchSize=b;f._glBuffers={};f._bufferToUpdate=0;f.interactiveChildren=!1;f.blendMode=n.BLEND_MODES.NORMAL;f.roundPixels=!0;f.baseTexture=null;f.setProperties(e);return f}
h(c,a);c.prototype.setProperties=function(a){a&&(this._properties[0]="scale"in a?!!a.scale:this._properties[0],this._properties[1]="position"in a?!!a.position:this._properties[1],this._properties[2]="rotation"in a?!!a.rotation:this._properties[2],this._properties[3]="uvs"in a?!!a.uvs:this._properties[3],this._properties[4]="alpha"in a?!!a.alpha:this._properties[4])};c.prototype.updateTransform=function(){this.displayObjectUpdateTransform()};c.prototype.renderWebGL=function(a){var c=this;if(this.visible&&
!(0>=this.worldAlpha)&&this.children.length&&this.renderable){if(!this.baseTexture&&(this.baseTexture=this.children[0]._texture.baseTexture,!this.baseTexture.hasLoaded))this.baseTexture.once("update",function(){return c.onChildrenChange(0)});a.setObjectRenderer(a.plugins.particle);a.plugins.particle.render(this)}};c.prototype.onChildrenChange=function(a){a=Math.floor(a/this._batchSize);a<this._bufferToUpdate&&(this._bufferToUpdate=a)};c.prototype.renderCanvas=function(a){if(this.visible&&!(0>=this.worldAlpha)&&
this.children.length&&this.renderable){var c=a.context,b=this.worldTransform,d=!0,f,h,g,m,n=a.blendModes[this.blendMode];n!==c.globalCompositeOperation&&(c.globalCompositeOperation=n);c.globalAlpha=this.worldAlpha;this.displayObjectUpdateTransform();for(n=0;n<this.children.length;++n){var u=this.children[n];if(u.visible){var t=u._texture.frame;c.globalAlpha=this.worldAlpha*u.alpha;0===u.rotation%(2*Math.PI)?(d&&(c.setTransform(b.a,b.b,b.c,b.d,b.tx*a.resolution,b.ty*a.resolution),d=!1),f=u.anchor.x*
-t.width*u.scale.x+u.position.x+.5,h=u.anchor.y*-t.height*u.scale.y+u.position.y+.5,g=t.width*u.scale.x,m=t.height*u.scale.y):(d||(d=!0),u.displayObjectUpdateTransform(),f=u.worldTransform,a.roundPixels?c.setTransform(f.a,f.b,f.c,f.d,f.tx*a.resolution|0,f.ty*a.resolution|0):c.setTransform(f.a,f.b,f.c,f.d,f.tx*a.resolution,f.ty*a.resolution),f=u.anchor.x*-t.width+.5,h=u.anchor.y*-t.height+.5,g=t.width,m=t.height);var z=u._texture.baseTexture.resolution;c.drawImage(u._texture.baseTexture.source,t.x*
z,t.y*z,t.width*z,t.height*z,f*z,h*z,g*z,m*z)}}}};c.prototype.destroy=function(c){a.prototype.destroy.call(this,c);if(this._buffers)for(c=0;c<this._buffers.length;++c)this._buffers[c].destroy();this._buffers=this._properties=null};return c}(n.Container);f["default"]=a},{"../core":63}],165:[function(a,c,f){f.__esModule=!0;var h=a("./ParticleContainer");Object.defineProperty(f,"ParticleContainer",{enumerable:!0,get:function(){return(h&&h.__esModule?h:{"default":h})["default"]}});var n=a("./webgl/ParticleRenderer");
Object.defineProperty(f,"ParticleRenderer",{enumerable:!0,get:function(){return(n&&n.__esModule?n:{"default":n})["default"]}})},{"./ParticleContainer":164,"./webgl/ParticleRenderer":167}],166:[function(a,c,f){f.__esModule=!0;var h=(c=a("pixi-gl-core"))&&c.__esModule?c:{"default":c},n=(a=a("../../core/utils/createIndicesForQuads"))&&a.__esModule?a:{"default":a};a=function(){function a(c,d,e,b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.gl=c;this.vertSize=
2;this.vertByteSize=4*this.vertSize;this.size=b;this.dynamicProperties=[];this.staticProperties=[];for(c=0;c<d.length;++c)b=d[c],b={attribute:b.attribute,size:b.size,uploadFunction:b.uploadFunction,offset:b.offset},e[c]?this.dynamicProperties.push(b):this.staticProperties.push(b);this.staticStride=0;this.staticData=this.staticBuffer=null;this.dynamicStride=0;this.dynamicData=this.dynamicBuffer=null;this.initBuffers()}a.prototype.initBuffers=function(){var a=this.gl,c=0;this.indices=(0,n["default"])(this.size);
this.indexBuffer=h["default"].GLBuffer.createIndexBuffer(a,this.indices,a.STATIC_DRAW);for(var e=this.dynamicStride=0;e<this.dynamicProperties.length;++e){var b=this.dynamicProperties[e];b.offset=c;c+=b.size;this.dynamicStride+=b.size}this.dynamicData=new Float32Array(this.size*this.dynamicStride*4);this.dynamicBuffer=h["default"].GLBuffer.createVertexBuffer(a,this.dynamicData,a.STREAM_DRAW);for(e=this.staticStride=c=0;e<this.staticProperties.length;++e)b=this.staticProperties[e],b.offset=c,c+=b.size,
this.staticStride+=b.size;this.staticData=new Float32Array(this.size*this.staticStride*4);this.staticBuffer=h["default"].GLBuffer.createVertexBuffer(a,this.staticData,a.STATIC_DRAW);this.vao=(new h["default"].VertexArrayObject(a)).addIndex(this.indexBuffer);for(c=0;c<this.dynamicProperties.length;++c)e=this.dynamicProperties[c],this.vao.addAttribute(this.dynamicBuffer,e.attribute,a.FLOAT,!1,4*this.dynamicStride,4*e.offset);for(c=0;c<this.staticProperties.length;++c)e=this.staticProperties[c],this.vao.addAttribute(this.staticBuffer,
e.attribute,a.FLOAT,!1,4*this.staticStride,4*e.offset)};a.prototype.uploadDynamic=function(a,c,e){for(var b=0;b<this.dynamicProperties.length;b++){var d=this.dynamicProperties[b];d.uploadFunction(a,c,e,this.dynamicData,this.dynamicStride,d.offset)}this.dynamicBuffer.upload()};a.prototype.uploadStatic=function(a,c,e){for(var b=0;b<this.staticProperties.length;b++){var d=this.staticProperties[b];d.uploadFunction(a,c,e,this.staticData,this.staticStride,d.offset)}this.staticBuffer.upload()};a.prototype.destroy=
function(){this.dynamicData=this.dynamicProperties=null;this.dynamicBuffer.destroy();this.staticData=this.staticProperties=null;this.staticBuffer.destroy()};return a}();f["default"]=a},{"../../core/utils/createIndicesForQuads":117,"pixi-gl-core":12}],167:[function(a,c,f){function h(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,
configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}f.__esModule=!0;var n=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(c[b]=a[b]);c["default"]=a;return c}(a("../../core")),m=(c=a("./ParticleShader"))&&c.__esModule?c:{"default":c},g=(a=a("./ParticleBuffer"))&&a.__esModule?a:{"default":a};a=function(a){function c(b){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");
b=a.call(this,b);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==typeof b&&"function"!==typeof b?this:b;b.shader=null;b.indexBuffer=null;b.properties=null;b.tempMatrix=new n.Matrix;b.CONTEXT_UID=0;return b}h(c,a);c.prototype.onContextChange=function(){var a=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID;this.shader=new m["default"](a);this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,
offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,uploadFunction:this.uploadAlpha,offset:0}]};c.prototype.start=function(){this.renderer.bindShader(this.shader)};c.prototype.render=function(a){var b=a.children,
c=a._maxSize,d=a._batchSize,e=this.renderer,f=b.length;if(0!==f){f>c&&(f=c);(c=a._glBuffers[e.CONTEXT_UID])||(c=a._glBuffers[e.CONTEXT_UID]=this.generateBuffers(a));this.renderer.setBlendMode(a.blendMode);var h=e.gl,g=a.worldTransform.copy(this.tempMatrix);g.prepend(e._activeRenderTarget.projectionMatrix);this.shader.uniforms.projectionMatrix=g.toArray(!0);this.shader.uniforms.uAlpha=a.worldAlpha;this.shader.uniforms.uSampler=e.bindTexture(b[0]._texture.baseTexture);for(var m=g=0;g<f;g+=d,m+=1){var n=
f-g;n>d&&(n=d);var w=c[m];w.uploadDynamic(b,g,n);a._bufferToUpdate===m&&(w.uploadStatic(b,g,n),a._bufferToUpdate=m+1);e.bindVao(w.vao);w.vao.draw(h.TRIANGLES,6*n)}}};c.prototype.generateBuffers=function(a){var b=this.renderer.gl,c=[],d=a._maxSize,e=a._batchSize;a=a._properties;for(var f=0;f<d;f+=e)c.push(new g["default"](b,this.properties,a,e));return c};c.prototype.uploadVertices=function(a,c,d,e,f,h){for(var b,g,m,n,p=0;p<d;++p){n=a[c+p];b=n._texture;var r=n.scale.x,q=n.scale.y;m=b.trim;var x=b.orig;
m?(g=m.x-n.anchor.x*x.width,b=g+m.width,n=m.y-n.anchor.y*x.height,m=n+m.height):(b=x.width*(1-n.anchor.x),g=x.width*-n.anchor.x,m=x.height*(1-n.anchor.y),n=x.height*-n.anchor.y);e[h]=g*r;e[h+1]=n*q;e[h+f]=b*r;e[h+f+1]=n*q;e[h+2*f]=b*r;e[h+2*f+1]=m*q;e[h+3*f]=g*r;e[h+3*f+1]=m*q;h+=4*f}};c.prototype.uploadPosition=function(a,c,d,e,f,h){for(var b=0;b<d;b++){var g=a[c+b].position;e[h]=g.x;e[h+1]=g.y;e[h+f]=g.x;e[h+f+1]=g.y;e[h+2*f]=g.x;e[h+2*f+1]=g.y;e[h+3*f]=g.x;e[h+3*f+1]=g.y;h+=4*f}};c.prototype.uploadRotation=
function(a,c,d,e,f,h){for(var b=0;b<d;b++){var g=a[c+b].rotation;e[h]=g;e[h+f]=g;e[h+2*f]=g;e[h+3*f]=g;h+=4*f}};c.prototype.uploadUvs=function(a,c,d,e,f,h){for(var b=0;b<d;++b){var g=a[c+b]._texture._uvs;g?(e[h]=g.x0,e[h+1]=g.y0,e[h+f]=g.x1,e[h+f+1]=g.y1,e[h+2*f]=g.x2,e[h+2*f+1]=g.y2,e[h+3*f]=g.x3,e[h+3*f+1]=g.y3):(e[h]=0,e[h+1]=0,e[h+f]=0,e[h+f+1]=0,e[h+2*f]=0,e[h+2*f+1]=0,e[h+3*f]=0,e[h+3*f+1]=0);h+=4*f}};c.prototype.uploadAlpha=function(a,c,d,e,f,h){for(var b=0;b<d;b++){var g=a[c+b].alpha;e[h]=
g;e[h+f]=g;e[h+2*f]=g;e[h+3*f]=g;h+=4*f}};c.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer);a.prototype.destroy.call(this);this.shader.destroy();this.tempMatrix=this.indices=null};return c}(n.ObjectRenderer);f["default"]=a;n.WebGLRenderer.registerPlugin("particle",a)},{"../../core":63,"./ParticleBuffer":166,"./ParticleShader":168}],168:[function(a,c,f){function h(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+
typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}f.__esModule=!0;a=a("../../core/Shader");a=function(a){function c(f){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");f=a.call(this,f,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute float aColor;\nattribute vec2 aPositionCoord;\nattribute vec2 aScale;\nattribute float aRotation;\nuniform mat3 projectionMatrix;\nvarying vec2 vTextureCoord;\nvarying float vColor;\nvoid main(void){\n   vec2 v = aVertexPosition;\n   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n   v = v + aPositionCoord;\n   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = aColor;\n}",
"varying vec2 vTextureCoord;\nvarying float vColor;\nuniform sampler2D uSampler;\nuniform float uAlpha;\nvoid main(void){\n  vec4 color = texture2D(uSampler, vTextureCoord) * vColor * uAlpha;\n  if (color.a == 0.0) discard;\n  gl_FragColor = color;\n}");if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!f||"object"!==typeof f&&"function"!==typeof f?this:f}h(c,a);return c}((a&&a.__esModule?a:{"default":a})["default"]);f["default"]=a},{"../../core/Shader":42}],
169:[function(a,c,f){Math.sign||(Math.sign=function(a){a=Number(a);return 0===a||isNaN(a)?a:0<a?1:-1})},{}],170:[function(a,c,f){a=(a=a("object-assign"))&&a.__esModule?a:{"default":a};Object.assign||(Object.assign=a["default"])},{"object-assign":5}],171:[function(a,c,f){a("./Object.assign");a("./requestAnimationFrame");a("./Math.sign");window.ArrayBuffer||(window.ArrayBuffer=Array);window.Float32Array||(window.Float32Array=Array);window.Uint32Array||(window.Uint32Array=Array);window.Uint16Array||
(window.Uint16Array=Array)},{"./Math.sign":169,"./Object.assign":170,"./requestAnimationFrame":172}],172:[function(a,c,f){(function(a){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()});a.performance&&a.performance.now||function(){var c=Date.now();a.performance||(a.performance={});a.performance.now=function(){return Date.now()-c}}();for(var c=Date.now(),f=["ms","moz","webkit","o"],h=0;h<f.length&&!a.requestAnimationFrame;++h){var d=f[h];a.requestAnimationFrame=a[d+
"RequestAnimationFrame"];a.cancelAnimationFrame=a[d+"CancelAnimationFrame"]||a[d+"CancelRequestAnimationFrame"]}a.requestAnimationFrame||(a.requestAnimationFrame=function(a){if("function"!==typeof a)throw new TypeError(a+"is not a function");var b=Date.now(),d=16+c-b;0>d&&(d=0);c=b;return setTimeout(function(){c=Date.now();a(performance.now())},d)});a.cancelAnimationFrame||(a.cancelAnimationFrame=function(a){return clearTimeout(a)})}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?
self:"undefined"!==typeof window?window:{})},{}],173:[function(a,c,f){function h(a,b){return b instanceof d.Text?(b.updateText(!0),!0):!1}function n(a,b){if(b instanceof d.TextStyle){var c=d.Text.getFontStyle(b);d.Text.fontPropertiesCache[c]||d.Text.calculateFontProperties(c);return!0}return!1}function m(a,b){if(a instanceof d.Text){-1===b.indexOf(a.style)&&b.push(a.style);-1===b.indexOf(a)&&b.push(a);var c=a._texture.baseTexture;-1===b.indexOf(c)&&b.push(c);return!0}return!1}function g(a,b){return a instanceof
d.TextStyle?(-1===b.indexOf(a)&&b.push(a),!0):!1}f.__esModule=!0;var d=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}(a("../core")),e=(a=a("./limiters/CountLimiter"))&&a.__esModule?a:{"default":a},b=d.ticker.shared;d.settings.UPLOADS_PER_FRAME=4;a=function(){function a(b){var c=this;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.limiter=new e["default"](d.settings.UPLOADS_PER_FRAME);
this.renderer=b;this.uploadHookHelper=null;this.queue=[];this.addHooks=[];this.uploadHooks=[];this.completes=[];this.ticking=!1;this.delayedTick=function(){c.queue&&c.prepareItems()};this.register(m,h);this.register(g,n)}a.prototype.upload=function(a,c){"function"===typeof a&&(c=a,a=null);a&&this.add(a);this.queue.length?(c&&this.completes.push(c),this.ticking||(this.ticking=!0,b.addOnce(this.tick,this))):c&&c()};a.prototype.tick=function(){setTimeout(this.delayedTick,0)};a.prototype.prepareItems=
function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){for(var a=this.queue[0],c=!1,d=0,e=this.uploadHooks.length;d<e;d++)if(this.uploadHooks[d](this.uploadHookHelper,a)){this.queue.shift();c=!0;break}c||this.queue.shift()}if(this.queue.length)b.addOnce(this.tick,this);else for(this.ticking=!1,a=this.completes.slice(0),c=this.completes.length=0,d=a.length;c<d;c++)a[c]()};a.prototype.register=function(a,b){a&&this.addHooks.push(a);b&&this.uploadHooks.push(b);return this};
a.prototype.add=function(a){for(var b=0,c=this.addHooks.length;b<c&&!this.addHooks[b](a,this.queue);b++);if(a instanceof d.Container)for(b=a.children.length-1;0<=b;b--)this.add(a.children[b]);return this};a.prototype.destroy=function(){this.ticking&&b.remove(this.tick,this);this.ticking=!1;this.uploadHookHelper=this.limiter=this.queue=this.completes=this.renderer=this.uploadHooks=this.addHooks=null};return a}();f["default"]=a},{"../core":63,"./limiters/CountLimiter":176}],174:[function(a,c,f){function h(a,
c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}function n(a,c){if(c instanceof g.BaseTexture){var b=c.source;a.ctx.drawImage(b,0,0,0===b.width?a.canvas.width:Math.min(a.canvas.width,b.width),0===b.height?a.canvas.height:Math.min(a.canvas.height,
b.height),0,0,a.canvas.width,a.canvas.height);return!0}return!1}function m(a,c){if(a instanceof g.BaseTexture)return-1===c.indexOf(a)&&c.push(a),!0;if(a._texture&&a._texture instanceof g.Texture){var b=a._texture.baseTexture;-1===c.indexOf(b)&&c.push(b);return!0}return!1}f.__esModule=!0;var g=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(c[b]=a[b]);c["default"]=a;return c}(a("../../core"));a=a("../BasePrepare");a=function(a){function c(b){if(!(this instanceof
c))throw new TypeError("Cannot call a class as a function");b=a.call(this,b);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==typeof b&&"function"!==typeof b?this:b;b.uploadHookHelper=b;b.canvas=document.createElement("canvas");b.canvas.width=16;b.canvas.height=16;b.ctx=b.canvas.getContext("2d");b.register(m,n);return b}h(c,a);c.prototype.destroy=function(){a.prototype.destroy.call(this);this.canvas=this.ctx=null};return c}((a&&a.__esModule?
a:{"default":a})["default"]);f["default"]=a;g.CanvasRenderer.registerPlugin("prepare",a)},{"../../core":63,"../BasePrepare":173}],175:[function(a,c,f){function h(a){return a&&a.__esModule?a:{"default":a}}f.__esModule=!0;var n=a("./webgl/WebGLPrepare");Object.defineProperty(f,"webgl",{enumerable:!0,get:function(){return h(n)["default"]}});var m=a("./canvas/CanvasPrepare");Object.defineProperty(f,"canvas",{enumerable:!0,get:function(){return h(m)["default"]}});var g=a("./BasePrepare");Object.defineProperty(f,
"BasePrepare",{enumerable:!0,get:function(){return h(g)["default"]}});var d=a("./limiters/CountLimiter");Object.defineProperty(f,"CountLimiter",{enumerable:!0,get:function(){return h(d)["default"]}});var e=a("./limiters/TimeLimiter");Object.defineProperty(f,"TimeLimiter",{enumerable:!0,get:function(){return h(e)["default"]}})},{"./BasePrepare":173,"./canvas/CanvasPrepare":174,"./limiters/CountLimiter":176,"./limiters/TimeLimiter":177,"./webgl/WebGLPrepare":178}],176:[function(a,c,f){f.__esModule=
!0;a=function(){function a(c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.maxItemsPerFrame=c;this.itemsLeft=0}a.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame};a.prototype.allowedToUpload=function(){return 0<this.itemsLeft--};return a}();f["default"]=a},{}],177:[function(a,c,f){f.__esModule=!0;a=function(){function a(c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.maxMilliseconds=c;this.frameStart=
0}a.prototype.beginFrame=function(){this.frameStart=Date.now()};a.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds};return a}();f["default"]=a},{}],178:[function(a,c,f){function h(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,
c):a.__proto__=c)}function n(a,c){return c instanceof e.BaseTexture?(c._glTextures[a.CONTEXT_UID]||a.textureManager.updateTexture(c),!0):!1}function m(a,c){return c instanceof e.Graphics?((c.dirty||c.clearDirty||!c._webGL[a.plugins.graphics.CONTEXT_UID])&&a.plugins.graphics.updateGraphics(c),!0):!1}function g(a,c){if(a instanceof e.BaseTexture)return-1===c.indexOf(a)&&c.push(a),!0;if(a._texture&&a._texture instanceof e.Texture){var b=a._texture.baseTexture;-1===c.indexOf(b)&&c.push(b);return!0}return!1}
function d(a,c){return a instanceof e.Graphics?(c.push(a),!0):!1}f.__esModule=!0;var e=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}(a("../../core"));a=a("../BasePrepare");a=function(a){function b(c){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");c=a.call(this,c);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;c.uploadHookHelper=c.renderer;c.register(g,n).register(d,m);return c}h(b,a);return b}((a&&a.__esModule?a:{"default":a})["default"]);f["default"]=a;e.WebGLRenderer.registerPlugin("prepare",a)},{"../../core":63,"../BasePrepare":173}],179:[function(a,c,f){(function(c){function h(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}f.__esModule=!0;f.loader=
f.prepare=f.particles=f.mesh=f.loaders=f.interaction=f.filters=f.extras=f.extract=f.accessibility=void 0;var m=a("./polyfill");Object.keys(m).forEach(function(a){"default"!==a&&"__esModule"!==a&&Object.defineProperty(f,a,{enumerable:!0,get:function(){return m[a]}})});var g=a("./deprecation");Object.keys(g).forEach(function(a){"default"!==a&&"__esModule"!==a&&Object.defineProperty(f,a,{enumerable:!0,get:function(){return g[a]}})});var d=a("./core");Object.keys(d).forEach(function(a){"default"!==a&&
"__esModule"!==a&&Object.defineProperty(f,a,{enumerable:!0,get:function(){return d[a]}})});var e=a("./accessibility"),e=h(e),b=a("./extract"),b=h(b),p=a("./extras"),p=h(p),r=a("./filters"),r=h(r),q=a("./interaction"),q=h(q),y=a("./loaders"),y=h(y),x=a("./mesh"),x=h(x),v=a("./particles"),v=h(v),u=a("./prepare"),u=h(u);f.accessibility=e;f.extract=b;f.extras=p;f.filters=r;f.interaction=q;f.loaders=y;f.mesh=x;f.particles=v;f.prepare=u;e=y&&y.Loader?new y.Loader:null;f.loader=e;c.PIXI=f}).call(this,"undefined"!==
typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./accessibility":40,"./core":63,"./deprecation":122,"./extract":124,"./extras":133,"./filters":144,"./interaction":150,"./loaders":153,"./mesh":162,"./particles":165,"./polyfill":171,"./prepare":175}]},{},[179])(179)});PIXI.TransparencyHitArea=function(k){this.sprite=k};PIXI.TransparencyHitArea.create=function(k,a){var c;c=a?new PIXI.WebGLTransparencyHitArea(k):new PIXI.CanvasTransparencyHitArea(k);c.init();return c};PIXI.TransparencyHitArea.prototype.init=function(){};
PIXI.TransparencyHitArea.prototype.contains=function(k,a){if(0===Math.abs(this.sprite.width)||0===Math.abs(this.sprite.height))return!1;var c=this.sprite.texture.frame.width,f=this.sprite.texture.frame.height;k+=this.sprite.anchor.x*c;a+=this.sprite.anchor.y*f;return 0<=k&&k<=c&&0<=a&&a<=f?!this.isTextureTransparentAt(Math.round(k+this.sprite.texture.frame.x),Math.round(a+this.sprite.texture.frame.y)):!1};PIXI.TransparencyHitArea.prototype.getTexture=function(){return this.sprite.texture};
PIXI.TransparencyHitArea.prototype.isTextureTransparentAt=function(k,a){void(k,a);throw Error("Has to be implemented in subclasses");};PIXI.CanvasTransparencyHitArea=function(k){PIXI.TransparencyHitArea.call(this,k);this.textureWidth=this.textureData=null};PIXI.CanvasTransparencyHitArea.prototype=Object.create(PIXI.TransparencyHitArea.prototype);PIXI.CanvasTransparencyHitArea.constructor=PIXI.CanvasTransparencyHitArea;PIXI.CanvasTransparencyHitArea.prototype.clone=function(){return new PIXI.CanvasTransparencyHitArea(this.sprite)};
PIXI.CanvasTransparencyHitArea.prototype.init=function(){PIXI.TransparencyHitArea.prototype.init.call(this);null===PIXI.CanvasTransparencyHitArea.cachedRenderer&&(PIXI.CanvasTransparencyHitArea.cachedRenderer=new PIXI.CanvasRenderer(1,1));this.initTextureData()};
PIXI.CanvasTransparencyHitArea.prototype.initTextureData=function(){if(!this.textureData){var k=this.getTexture(),a=k.baseTexture.source;this.textureWidth=a.width;a=a.src;void 0===PIXI.CanvasTransparencyHitArea.TextureData[a]&&(k=this.createTextureData(k),PIXI.CanvasTransparencyHitArea.TextureData[a]=k);this.textureData=PIXI.CanvasTransparencyHitArea.TextureData[a]}};
PIXI.CanvasTransparencyHitArea.prototype.createTextureData=function(k){k=k.baseTexture.source;var a=PIXI.CanvasTransparencyHitArea.cachedRenderer,c=a.view;c.width=k.width;c.height=k.height;a=a.view.getContext("2d");a.clearRect(0,0,k.width,k.height);a.drawImage(k,0,0);return a.getImageData(0,0,k.width,k.height).data};
PIXI.CanvasTransparencyHitArea.prototype.isTextureTransparentAt=function(k,a){if(!this.textureData)throw Error("CanvasTransparencyHitArea#init() not called.");return 1>this.textureData[4*(k+a*this.textureWidth)+3]};PIXI.CanvasTransparencyHitArea.TextureData=[];PIXI.CanvasTransparencyHitArea.cachedRenderer=null;PIXI.WebGLTransparencyHitArea=function(k){PIXI.TransparencyHitArea.call(this,k);this.textureWidth=this.textureData=null};PIXI.WebGLTransparencyHitArea.prototype=Object.create(PIXI.TransparencyHitArea.prototype);
PIXI.WebGLTransparencyHitArea.constructor=PIXI.WebGLTransparencyHitArea;PIXI.WebGLTransparencyHitArea.prototype.clone=function(){return new PIXI.WebGLTransparencyHitArea(this.sprite)};PIXI.WebGLTransparencyHitArea.prototype.init=function(){PIXI.TransparencyHitArea.prototype.init.call(this);null===PIXI.WebGLTransparencyHitArea.cachedRenderer&&(PIXI.WebGLTransparencyHitArea.cachedRenderer=new PIXI.WebGLRenderer(1,1));this.initTextureData()};
PIXI.WebGLTransparencyHitArea.prototype.initTextureData=function(){if(!this.textureData){var k=this.getTexture(),a=k.baseTexture.source;this.textureWidth=a.width;a=a.src;void 0===PIXI.WebGLTransparencyHitArea.TextureData[a]&&(k=this.createTextureData(k),PIXI.WebGLTransparencyHitArea.TextureData[a]=k);this.textureData=PIXI.WebGLTransparencyHitArea.TextureData[a]}};
PIXI.WebGLTransparencyHitArea.prototype.createTextureData=function(k){var a=k.baseTexture.source,c=PIXI.WebGLTransparencyHitArea.cachedRenderer.view;c.width=a.width;c.height=a.height;var c=PIXI.WebGLTransparencyHitArea.cachedRenderer.gl,f=c.createFramebuffer();c.bindFramebuffer(c.FRAMEBUFFER,f);void 0===k.baseTexture._glTextures[c.id]&&PIXI.WebGLTransparencyHitArea.cachedRenderer.updateTexture(k.baseTexture);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,k.baseTexture._glTextures[c.id],
0);k=new Uint8Array(a.width*a.height*4);try{c.readPixels(0,0,a.width,a.height,c.RGBA,c.UNSIGNED_BYTE,k)}catch(h){console.log(error)}c.bindFramebuffer(c.FRAMEBUFFER,null);return k};PIXI.WebGLTransparencyHitArea.prototype.isTextureTransparentAt=function(k,a){if(!this.textureData)throw Error("WebGLTransparencyHitArea#init() not called.");return 255>this.textureData[4*(k+a*this.textureWidth)+3]};PIXI.WebGLTransparencyHitArea.TextureData=[];PIXI.WebGLTransparencyHitArea.cachedRenderer=null;function getCurvePoints(k,a,c,f){function h(a,b,f,h){for(var g=2,k;g<f;g+=2){var m=a[g],n=a[g+1],p=a[g+2],r=a[g+3],q=(p-a[g-2])*h,t=(r-a[g-1])*h,x=(a[g+4]-m)*h,u=(a[g+5]-n)*h,y=0,v,w,z,J;for(k=0;k<c;k++)v=b[y++],w=b[y++],z=b[y++],J=b[y++],e[d++]=v*m+w*p+z*q+J*x,e[d++]=v*n+w*r+z*t+J*u}}a="number"===typeof a?a:.5;c="number"===typeof c?c:25;var n,m=1,g=k.length,d=0,e=new Float32Array((g-2)*c+2+(f?2*c:0)),b=new Float32Array(4*(c+2)),p=4;n=k.slice(0);f?(n.unshift(k[g-1]),n.unshift(k[g-2]),n.push(k[0],
k[1])):(n.unshift(k[1]),n.unshift(k[0]),n.push(k[g-2],k[g-1]));for(b[0]=1;m<c;m++){var r=m/c,q=r*r,y=q*r,x=2*y,v=3*q;b[p++]=x-v+1;b[p++]=v-x;b[p++]=y-2*q+r;b[p++]=y-q}b[++p]=1;h(n,b,g,a);f&&(n=[],n.push(k[g-4],k[g-3],k[g-2],k[g-1],k[0],k[1],k[2],k[3]),h(n,b,4,a));g=f?0:k.length-2;e[d++]=k[g++];e[d]=k[g];return e}"undefined"!==typeof exports&&(exports.getCurvePoints=getCurvePoints);var servers=$("#socket_io_servers").attr("data-socket_io_servers").split(","),game=$("meta[name=game]").attr("content"),is_video_replay=!1;-1!=location.pathname.indexOf(game+"3")&&(is_video_replay=!0);var image_host;function is_safari(){return navigator.vendor&&-1<navigator.vendor.indexOf("Apple")}var static_host=$("#static_host").attr("data-static_host");image_host=is_safari()?"http://"+location.host+"/icons/":static_host+"/icons/";var asset_host=static_host+"/",loader=PIXI.loader,assets=[];
"wows"==game?(assets.push(image_host+"rotate.png"),assets.push(image_host+"bb.png",image_host+"cv.png",image_host+"ca.png",image_host+"dd.png"),assets.push(image_host+"circle.png",image_host+"recticle.png",image_host+"dot.png",image_host+"note.png",image_host+"cursor.png",image_host+"grid.png")):"blitz"==game?(assets.push(image_host+"rotate.png"),assets.push(image_host+"light.png",image_host+"medium.png",image_host+"heavy.png",image_host+"td.png",image_host+"arty.png"),assets.push(image_host+"circle.png",
image_host+"recticle.png",image_host+"dot.png",image_host+"note.png",image_host+"cursor.png",image_host+"grid.png")):"aw"==game?(assets.push(image_host+"rotate.png"),loader.add("aw_assets.png",asset_host+"aw_assets.png"),loader.add("aw_assets.json",asset_host+"aw_assets.json")):"lol"==game?(assets.push(image_host+"rotate.png"),assets.push(image_host+"circle.png",image_host+"recticle.png",image_host+"dot.png",image_host+"note.png",image_host+"cursor.png",image_host+"grid.png")):"hots"==game?(assets.push(image_host+
"rotate.png"),loader.add("hots_assets.png",asset_host+"hots_assets.png"),loader.add("hots_assets.json",asset_host+"hots_assets.json")):(assets.push(image_host+"rotate.png"),loader.add("wot_assets.png",asset_host+"wot_assets.png"),loader.add("wot_assets.json",asset_host+"wot_assets.json"));for(var i in assets)loader.add(assets[i],assets[i]);var textures_loaded=!1;loader.on("complete",function(k){textures_loaded=!0});loader.load();var texture_atlas;
function setup_assets(){texture_atlas={};for(var k in loader.resources)if("json"==k.slice(-4))for(var a in loader.resources[k].data.tiles)texture_atlas[a]=loader.resources[k].data.tiles[a]}var room=location.search.split("room=")[1].split("&")[0],nowebgl=-1!=location.search.indexOf("nowebgl"),wot_live=-1!=location.search.indexOf("wot_live"),adjust_all_zoom=-1!=location.search.indexOf("adjust_zoom");function hashstring(k){var a=0;for(i=0;i<k.length;i++)a+=k.charCodeAt(i);return a}
var server=servers[hashstring(room)%servers.length];console.log("connecting to server: ",server);function parse_domain(k){k=k.split(".");2<k.length&&(k=k.slice(1));return"."+k.join(".")}var sid=$("#sid").attr("data-sid"),socket;try{socket=io.connect(server,{reconnectionDelay:100,reconnectionDelayMax:500,"reconnection limit":1E3,"max reconnection attempts":Infinity,query:"connect_sid="+sid+"&host="+parse_domain(location.hostname)})}catch(k){console.log(k)}var valid_chars="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
function newUid(){for(var k="",a=0;14>a;a++)k+=valid_chars.charAt(Math.floor(Math.random()*valid_chars.length));return k}function is_chrome(){return-1<navigator.userAgent.toLowerCase().indexOf("chrome")}function is_firefox(){return-1<navigator.userAgent.toLowerCase().indexOf("firefox")}function is_ie(){return-1<navigator.userAgent.toLowerCase().indexOf("msie")||-1<navigator.userAgent.toLowerCase().indexOf("trident")}function is_edge(){return-1<navigator.userAgent.toLowerCase().indexOf("edge")}
var last=function(k){return k[k.length-1]};function random_darkish_color(){var k=Math.round(127*Math.random()).toString(16),a=Math.round(127*Math.random()).toString(16),c=Math.round(127*Math.random()).toString(16);return"#"+k+a+c}function random_color(){var k=Math.round(256*Math.random()).toString(16),a=Math.round(256*Math.random()).toString(16),c=Math.round(256*Math.random()).toString(16);return"#"+("00"+k.toString(16)).slice(-2)+("00"+a.toString(16)).slice(-2)+("00"+c.toString(16)).slice(-2)}
var ARROW_LOOKBACK=4,MOUSE_DRAW_SMOOTHING=.5,LEFT_BAR_MIN_WIDTH=340,RIGHT_BAR_MIN_WIDTH=302,SINGLE_SIDE_BAR_MIN_WIDTH;SINGLE_SIDE_BAR_MIN_WIDTH="blitz"==game?350:630;
var MIN_POLYGON_END_DISTANCE=.01,MIN_POLYGON_END_DISTANCE_TOUCH=.025,MIN_TRACK_MOVE_DISTANCE_SQ=1E-4,ICON_SCALE=.00125,NOTE_SCALE=.03,THICKNESS_SCALE=1,FONT_SCALE=.002,TEXT_QUALITY=8,DRAW_QUALITY=2,ARROW_SCALE=.008,ARROW_SCALE2=1.7,TEND_SCALE=.008,TEND_SCALE2=1.5,MAGIC_NUMBER=25,EPSILON=1E-9,ROTATE_ARROW_SCALE=.05,ROTATE_ARROW_MARGIN=.02,TEXT_BOX_QUALITY=4,VIDEO_EXTENSIONS=["mp4","webgl","avi"],VIDEO_SYNC_DELAY=1E4,MOUSE_IDLE_HIDE_TIME=5E3,MAX_CANVAS_SIZE=4096,ICON_LABEL_SCALE=1,TEXT_SCALE=.8,BACKGROUND_TEXT_SCALE=
.8,PING_TIME=500,dpi,chat_color=random_darkish_color(),room_data,active_slide=0,active_context="ping_context",active_menu="ping_context",userlist={},selected_icon,selected_icon_no_color=!1,label_position="pos_bottom",icon_extra_scale=1,icon_color=16711680,draw_color=16711680,ping_color=16711680,track_color=16711680,line_color=16711680,curve_color=16711680,text_color=16777215,background_text_color=0,rectangle_outline_color=16711680,rectangle_fill_color=16711680,circle_outline_color=16711680,circle_fill_color=
16711680,polygon_outline_color=16711680,polygon_fill_color=16711680,area_outline_color=16711680,area_fill_color=16711680,background,draw_thickness,curve_thickness,line_thickness,icon_size,ping_size,track_size,draw_end_size,line_end_size,curve_end_size,rectangle_outline_thickness,rectangle_outline_transparancy,rectangle_fill_transparancy,circle_outline_thickness,circle_outline_transparancy,circle_fill_transparancy,polygon_outline_thickness,polygon_outline_transparancy,polygon_fill_transparancy,area_outline_thickness,
area_outline_transparancy,area_fill_transparancy,my_user,undo_list=[],redo_list=[],is_room_locked,tactic_name="",graphics,new_drawing,left_click_origin,selected_entities=[],previously_selected_entities=[],label_font_size=30,last_ping_time,trackers={},my_tracker,last_track_position,tracker_width=.05,tracker_height=.05,my_user_id,clipboard=[],slide_name,assets_loaded=!1,select_alpha=.6,resources_loading=0,circle_draw_style="edge",drag_delay_running=!1,current_text_element,last_mouse_location,ping_texture,
just_activated,select_box,rotate_arrow0,rotate_arrow1,rotate_arrow2,rotate_arrow3,select_box_dirty=!1,select_center,objectContainer,fast_container,background_sprite,renderer,size,size_x,size_y,useWebGL,last_pan_loc,panning,last_move_func,last_end_func,draw_canvas,temp_draw_canvas,draw_context,temp_draw_context,grid_layer,zoom_level=1,control_camera=!1,dragging_enabled=!0,temp_canvas=document.createElement("canvas"),dragging_mode={},offset=0,sync_start_time,progress=0,progress_update=Date.now(),video_layer,
manual_pause=!1,sync_seek=!1,sync_event,clock_sync_event,last_video_sync=null,timeline,timeline_entities={},video_ready=!1,video_paused=!0,initiated_play=!1,im_syncing=!1,idleMouseTimer,playback_rate=1,base_playback_rate=1,mouse_down_interrupted;document.body.onmouseup=function(){mouse_down_interrupted=!0};var shifted;
$(document).on("keyup keydown",function(k){can_edit()&&(shifted=k.shiftKey,"input"!=document.activeElement.localName&&("keydown"==k.type?k.ctrlKey?90==k.keyCode?undo():89==k.keyCode?redo():65==k.keyCode?(select_all(),k.preventDefault()):83==k.keyCode?my_user.logged_in&&tactic_name&&""!=tactic_name&&socket&&(socket.emit("store",room,tactic_name),alert('Tactic stored as: "'+tactic_name+'"'),k.preventDefault()):67==k.keyCode?copy():88==k.keyCode?cut():86==k.keyCode&&paste():32==k.keyCode&&video_layer&&
can_edit()&&(toggle_play(),k.preventDefault()):"keyup"==k.type&&(46==k.keyCode?clear_selected():16==k.keyCode?"line_context"==active_context&&new_drawing&&on_line_end(k):34===k.keyCode?next_slide():33===k.keyCode&&prev_slide())))});function cut(){copy();clear_selected()}
function copy(){clipboard=[];for(var k in selected_entities){var a=selected_entities[k].container;selected_entities[k].container=null;clipboard.push(JSON.parse(JSON.stringify(selected_entities[k])));selected_entities[k].container=a}}
function paste(){if(0!=clipboard.length){deselect_all();var k=mouse_loc(),a=from_x_local(k.x),k=from_y_local(k.y);if(1<Math.abs(a)||1<Math.abs(k))a=k=0;var c=1,f=1,h;for(h in clipboard)c=Math.min(c,clipboard[h].y),f=Math.min(f,clipboard[h].x);var n=[];for(h in clipboard){var m=JSON.parse(JSON.stringify(clipboard[h]));m.uid=newUid();m.x=a+(m.x-f);m.y=k+(m.y-c);n.push(m);create_entity(m);snap_and_emit_entity(m);selected_entities.push(m);render_scene()}select_entities();undo_list.push(clone_action(["add",
n]))}}
function adjust_zoom(k){if(k.draw_zoom_level&&(adjust_all_zoom||"icon"==k.type)){var a=zoom_level/k.draw_zoom_level;switch(k.type){case "icon":case "note":k.container.scale.x=k.container.orig_scale[0]*a;k.container.scale.y=k.container.orig_scale[1]*a;break;case "text":case "background_text":set_anchor(k.container,0,0);k.container.scale.x=k.container.orig_scale[0]*a;k.container.scale.y=k.container.orig_scale[1]*a;set_anchor(k.container,.5,.5);break;case "drawing":remove(k.uid);create_drawing2(k,1*
DRAW_QUALITY/a,a);break;case "curve":remove(k.uid);create_curve2(k,1*DRAW_QUALITY/a,a);break;case "line":remove(k.uid);create_line2(k,1*DRAW_QUALITY/a,a);break;case "rectangle":remove(k.uid);create_rectangle2(k,1*DRAW_QUALITY/a,a);break;case "circle":remove(k.uid);create_circle2(k,1*DRAW_QUALITY/a,a);break;case "polygon":remove(k.uid);create_polygon2(k,1*DRAW_QUALITY/a,a);break;case "area":remove(k.uid),create_area2(k,1*DRAW_QUALITY/a,a)}}}
function zoom(k,a,c,f){k=1+k*(a?1:-1);objectContainer.scale.x*=k;objectContainer.scale.y*=k;objectContainer.x-=x_abs(c[0]*(1-1/k)*objectContainer.scale.x);objectContainer.y-=y_abs(c[1]*(1-1/k)*objectContainer.scale.y);correct();zoom_level=size_y/(background_sprite.height*objectContainer.scale.y);if(room_data)for(var h in room_data.slides[active_slide].entities)c=room_data.slides[active_slide].entities[h],c.container&&c.draw_zoom_level&&adjust_zoom(c)}
function emit_pan_zoom(){socket.emit("pan_zoom",room,zoom_level,from_x_local_vect(objectContainer.x),from_y_local_vect(objectContainer.y))}function pan_zoom(k,a,c){k=zoom_level/k;objectContainer.scale.x*=k;objectContainer.scale.y*=k;objectContainer.x=to_x_local_vect(a);objectContainer.y=to_y_local_vect(c);zoom_level=size_y/(background_sprite.height*objectContainer.scale.y);$("#zoom_level").text((1/zoom_level).toFixed(2));render_scene()}
function correct(){objectContainer.x=Math.min(0,objectContainer.x);objectContainer.y=Math.min(0,objectContainer.y);background_sprite.width*objectContainer.scale.x+objectContainer.x<renderer.view.width&&(objectContainer.x=Math.min(0,renderer.view.width-background_sprite.width*objectContainer.scale.x),0==objectContainer.x&&(objectContainer.scale.x=renderer.view.width/background_sprite.width));background_sprite.height*objectContainer.scale.y+objectContainer.y<renderer.view.height&&(objectContainer.y=
Math.min(0,renderer.view.height-background_sprite.height*objectContainer.scale.y),0==objectContainer.y&&(objectContainer.scale.y=renderer.view.height/background_sprite.height));objectContainer.scale.y!=objectContainer.scale.x&&(objectContainer.scale.x=Math.max(objectContainer.scale.x,objectContainer.scale.y),objectContainer.scale.y=Math.max(objectContainer.scale.x,objectContainer.scale.y));if(room_data)for(var k in room_data.slides[active_slide].entities)room_data.slides[active_slide].entities[k]&&
"note"==room_data.slides[active_slide].entities[k].type&&align_note_text(room_data.slides[active_slide].entities[k]);my_tracker&&on_track_move();render_scene()}var pan_state={};function on_pan(k){limit_rate(15,pan_state,function(){var a=mouse_loc(),c=a.x-last_pan_loc[0],f=a.y-last_pan_loc[1];last_pan_loc=[a.x,a.y];objectContainer.x+=c;objectContainer.y+=f;correct()})}
function resize_renderer(k,a){if(video_layer){var c=k*(1-(0<video_layer[0].videoWidth?video_layer[0].videoWidth/video_layer[0].videoHeight:16/9)/(k/a))/2;$("#edit_window").css("left",""+c+"px");k-=2*c;video_layer.width(k);video_layer.height(a)}else $("#edit_window").css("left","0px");c=size_y;size_x=k;size_y=a;draw_canvas.width=k*DRAW_QUALITY;draw_canvas.height=a*DRAW_QUALITY;temp_draw_canvas.width=k*DRAW_QUALITY;temp_draw_canvas.height=a*DRAW_QUALITY;$(draw_canvas).css("width",""+k+"px");$(draw_canvas).css("height",
""+a+"px");$(temp_draw_canvas).css("width",""+k+"px");$(temp_draw_canvas).css("height",""+a+"px");objectContainer.scale.x*=size_y/c;objectContainer.scale.y*=size_y/c;$("#edit_window").css("width",""+k+"px");$("#edit_window").css("height",""+a+"px");renderer.resize(k,a);grid_layer.width=background_sprite.width;grid_layer.height=background_sprite.height;renderer.plugins.interaction.eventData.data&&(c=mouse_loc(),zoom(0,!0,[from_x_local(c.x),from_y_local(c.y)]))}
window.onresize=function(){change_background_dim(renderer.view.height);if(is_video_replay)resize_renderer($(window).width(),$(window).height());else{var k=1;background_sprite.texture&&(k=background_sprite.texture.width/background_sprite.texture.height);var a;a=$("#single_side_bar").length?SINGLE_SIDE_BAR_MIN_WIDTH:LEFT_BAR_MIN_WIDTH+RIGHT_BAR_MIN_WIDTH;if(a<window.innerWidth/2){var c;$("#left_side_bar").length&&($("#left_side_bar").detach().prependTo($("body")),$("#map_select_box").prependTo($("#map_select_section")));
c=window.innerHeight-5;var f=c*k;f+a+MAGIC_NUMBER>window.innerWidth&&(f=window.innerWidth-a-MAGIC_NUMBER,c=f/k)}else $("#left_side_bar").length&&($("#left_side_bar").detach().appendTo($("body")),$("#map_select_box").prependTo($(".left_column")),a=RIGHT_BAR_MIN_WIDTH),f=window.innerWidth-a,c=f/k,f<RIGHT_BAR_MIN_WIDTH&&(f=window.innerWidth,c=f/k),c>window.innerHeight&&(c=window.innerHeight,f=c*k);resize_renderer(f,c);render_scene()}};
function mouse_loc(){return JSON.parse(JSON.stringify(renderer.plugins.interaction.eventData.data.global))}function x_rel(k){return k/background_sprite.height}function x_abs(k){return k*background_sprite.height}function y_rel(k){return k/background_sprite.height}function y_abs(k){return k*background_sprite.height}function to_x_local(k){return objectContainer.x+k*background_sprite.height*objectContainer.scale.x}function to_x_local_vect(k){return k*background_sprite.height*objectContainer.scale.x}
function from_x_local(k){return(k-objectContainer.x)/objectContainer.scale.x/background_sprite.height}function from_x_local_vect(k){return k/objectContainer.scale.x/background_sprite.height}function to_y_local(k){return objectContainer.y+k*background_sprite.height*objectContainer.scale.y}function to_y_local_vect(k){return k*background_sprite.height*objectContainer.scale.y}function from_y_local(k){return(k-objectContainer.y)/objectContainer.scale.y/background_sprite.height}
function from_y_local_vect(k){return k/objectContainer.scale.y/background_sprite.height}function mouse_x_abs(k){return k}function mouse_y_abs(k){return k}function mouse_x_rel(k){return k/(background_sprite.height/background_sprite.scale.x)}function mouse_y_rel(k){return k/(background_sprite.height/background_sprite.scale.y)}function is_video(k){return""!=get_video_type(k)}
function get_video_type(k){for(var a=k.split(".").pop(),c=0;c<VIDEO_EXTENSIONS.length;c++)if(a.startsWith(VIDEO_EXTENSIONS[c]))return"video/"+VIDEO_EXTENSIONS[c];return-1!=k.toUpperCase().indexOf("YOUTUBE")?"video/youtube":-1!=k.toUpperCase().indexOf("VIMEO")?"video/vimeo":""}
function reset_background(){background_sprite.alpha=1;video_ready=!1;video_media&&video_media.setCurrentTime(0);video_player&&(video_player.pause(),video_player.remove());$("#video_player")&&$("#video_player").remove();video_layer=null;$("#left_detect").unbind("mouseenter");$("#right_detect").unbind("mouseenter");$("#left_side_bar").unbind("mouseleave");$("#right_side_bar").unbind("mouseleave");$("#left_side_bar").show();$("#right_side_bar").show();clearTimeout(idleMouseTimer)}var video_player,video_media;
function init_video_controls(){$("#left_detect").mouseenter(function(){$("#left_side_bar").show()});$("#right_detect").mouseenter(function(){$("#right_side_bar").show()});$("#left_side_bar").mouseleave(function(){$("#left_side_bar").hide()});$("#right_side_bar").mouseleave(function(){$("#right_side_bar").hide()});$("#left_side_bar").hide();$("#right_side_bar").hide()}
function start_syncing(){clearInterval(sync_event);im_syncing=!0;for(var k=0;5>k;k++)setTimeout(function(){var a=video_progress();socket.emit("sync_video",room,a,get_server_time())},2E3*k);sync_event=setInterval(function(){var a=video_progress();socket.emit("sync_video",room,a,get_server_time())},1E4)}
function play_video_controls(){$(".mejs-controls").mouseenter(function(){$(".mejs-controls").css("opacity",1)});$(".mejs-controls").mouseleave(function(){$(".mejs-controls").css("opacity",0)});$(".mejs-controls").css("opacity",0);can_edit()?$(".mejs-controls").show():$(".mejs-controls").hide()}function pause_video_controls(){$(".mejs-controls").unbind("mouseenter");$(".mejs-controls").unbind("mouseleave");$(".mejs-controls").css("opacity",1)}
function toggle_play(){if(background.is_video)if(video_paused){var k=video_progress();socket.emit("play_video",room,k,base_playback_rate);initiated_play=!0;play_video_controls();start_syncing()}else manual_pause=!0,video_player.pause(),pause_video_controls()}var ignore_jump=!1;
function init_video_triggers(){video_media.addEventListener("pause",function(k){manual_pause&&(clearInterval(sync_event),im_syncing=!1,video_paused=!0,socket.emit("pause_video",room,video_progress()),manual_pause=!1)});video_media.addEventListener("play",function(k){window.onresize();initiated_play?(start_syncing(),initiated_play=!1):stop_syncing();video_paused&&(video_player.pause(),video_media.currentTime=last_video_sync?last_video_sync[0]:0,video_player.pause())});video_media.addEventListener("ended",
function(k){im_syncing&&socket.emit("pause_video",room,0)});video_media.addEventListener("canplay",function(k){window.onresize()});video_media.addEventListener("timeupdate",function(k){progress=video_media.currentTime;progress_update=Date.now()});$(".mejs-playpause-button").unbind("click");$(".mejs-playpause-button").click(function(k){toggle_play();k.preventDefault();return!1});$(".mejs-time-rail").on("mousedown",function(){wait_for_seek(function(){socket.emit("seek_video",room,video_progress(),get_server_time());
video_paused||start_syncing();rebuild_timeline()})})}function wait_for_seek(k){var a=Date.now(),c=video_progress(),f=setInterval(function(){video_progress();.05<Math.abs(video_progress()-(c+(Date.now()-a)/1E3))&&(k(),clearInterval(f));1E4<Date.now()-a&&clearInterval(f)},5)}
function change_background_dim(k){var a=zoom_level,c=background_sprite.texture.width/background_sprite.texture.height,f=background_sprite.height;background_sprite.width=k*c;background_sprite.height=k;grid_layer.width=background_sprite.width;grid_layer.height=background_sprite.height;c=k/f;if(1!=c&&room_data)for(var h in room_data.slides[active_slide].entities)k=room_data.slides[active_slide].entities[h],k.container&&(k.container.x*=c,k.container.y*=c,k.container.width*=c,k.container.height*=c);zoom_level=
size_y/(background_sprite.height*objectContainer.scale.y);pan_zoom(a,from_x_local_vect(objectContainer.x),from_y_local_vect(objectContainer.y))}
function set_background(k,a){if(""!=k.path)if(k.is_video){reset_background();background_sprite.alpha=0;background=k;history[background.uid]=background;add_custom_map(background.path);$("#wotbase_map_select_container").hide();$("#map_select_container").show();var c=get_video_type(k.path);video_layer=$("<video />",{id:"video_player",autoplay:!1,controls:!0});$("<source />",{type:c,src:k.path}).appendTo(video_layer);video_layer.appendTo($("#video_div"));video_layer.mediaelementplayer({videoHeight:"100%",
loop:!1,autoPlay:!1,enableAutosize:!0,alwaysShowControls:!0,speeds:"0.25 0.50 1.00 1.25 1.50 2.00".split(" "),defaultSpeed:"1.00",speedChar:"x",features:"playpause speed progress current duration tracks volume".split(" "),success:function(f,h,d){video_media=f;video_paused=!room_data.playing;video_player=d;"video/youtube"==c&&video_media.pluginApi.pauseVideo();init_video_controls();$(".mejs-controls").css("z-index",9);$(".mejs-controls").css("position","fixed");$(".mejs-controls").css("left","0px");
$(".mejs-controls").css("bottom","0px");$(".mejs-controls").css("height","3%");init_video_triggers();timeline=new FastPriorityQueue;video_ready=!0;room_data.playing?room_data.last_sync?handle_play(room_data.last_sync[0],Date.now()):handle_play(0,Date.now()):room_data.last_sync&&(video_media.setCurrentTime(room_data.last_sync[0]),video_player.pause());"youtube"==video_media.pluginType&&(f=video_media.pluginType,video_player.options.speeds=video_media.pluginApi.getAvailablePlaybackRates().map(function(a){return a.toFixed(2)}),
video_player.options.defaultSpeed="1.00",video_media.pluginType="native",video_player.buildspeed(d,d.controls,d.layers,d.media),$(".mejs-playpause-button").after($(".mejs-speed-button")),video_media.pluginType=f);playback_rate=base_playback_rate=1;$(".mejs-speed-button").find(".mejs-speed-selector").on("click",'input[type="radio"]',function(){var a=parseFloat($(this).attr("value"));socket.emit("change_rate",room,a);set_playback_rate(a,a);start_syncing()});var e=!1;$(renderer.view).css("cursor","none");
$(renderer.view).mousemove(function(a){e||($(renderer.view).css("cursor","default"),clearTimeout(idleMouseTimer),idleMouseTimer=setTimeout(function(){$(renderer.view).css("cursor","none");e=!0;setTimeout(function(){e=!1},200)},MOUSE_IDLE_HIDE_TIME))});socket.emit("request_sync",room);window.onresize();render_scene();a&&a(!0)}})}else{resources_loading++;var f=PIXI.Texture.fromImage(k.path),h=function(){reset_background();background=k;history[background.uid]=background;background_sprite.texture=f;room_data.slides[active_slide].entities[k.uid]=
k;resources_loading--;0<$("#map_select option[value='"+background.path+"']").length?($("#map_select").val(background.path).change(),$("#select_hd").prop("checked",!0),$("#map_select_container").show(),$("#wotbase_select_container").hide(),$("#new_minimap_select_container").hide()):0<$("#wotbase_select option[value='"+background.path+"']").length?($("#wotbase_select").val(background.path).change(),$("#select_wotbase").prop("checked",!0),$("#map_select_container").hide(),$("#wotbase_select_container").show(),
$("#new_minimap_select_container").hide()):0<$("#new_minimap_select option[value='"+background.path+"']").length?($("#new_minimap_select").val(background.path).change(),$("#select_new_minimap").prop("checked",!0),$("#map_select_container").hide(),$("#wotbase_select_container").hide(),$("#new_minimap_select_container").show()):(add_custom_map(background.path),$("#select_hd").prop("checked",!0),$("#map_select_container").show(),$("#wotbase_select_container").hide(),$("#new_minimap_select_container").hide());
background.size_x&&background.size_y&&0<background.size_x&&0<background.size_y?$("#map_size").text("("+background.size_x+" x "+background.size_y+")"):$("#map_size").text("");window.onresize();render_scene();a&&a(!0)};f.baseTexture.hasLoaded?h():(f.baseTexture.on("loaded",function(){h()}),f.baseTexture.on("error",function(c){alert("Image exists, but the host does not allow embedding. Try uploading your map to a service such as http://imgur.com.");resources_loading--;a&&a(!1)}))}else{reset_background();
background=k;history[background.uid]=background;$("#map_select").val(background.path).change();$("#select_hd").prop("checked",!0);$("#map_select_container").show();$("#wotbase_select_container").hide();$("#new_minimap_select_container").hide();var n=new PIXI.Graphics;n.beginFill(16777215,1);n.moveTo(0,0);is_video_replay?(n.lineTo($(window).width(),0),n.lineTo($(window).width(),$(window).height()),n.lineTo(0,$(window).height())):(n.lineTo(renderer.width,0),n.lineTo(renderer.width,renderer.height),
n.lineTo(0,renderer.height));n.lineTo(0,0);n.endFill();background_sprite.texture=renderer.generateTexture(n);$("#map_size").text("");window.onresize();render_scene();a&&a(!0)}}var context_before_drag,move_selected,drag_timeout,last_drag_position,last_drag_update,dragged_entity;
function on_drag_start(k){this==select_box&&(limit_rate(15,select_box_move_state,function(){}),select_box.mousemove=void 0,select_box.mouseover=void 0,select_box.mouseout=void 0);drag_delay_running=!0;drag_timeout&&clearTimeout(drag_timeout);_this=this;var a=k.data.getLocalPosition(background_sprite);last_mouse_location=[mouse_x_rel(a.x),mouse_y_rel(a.y)];mouse_down_interrupted=!1;a=0;if("ping_context"!=active_context||_this.entity&&"note"==_this.entity.type){if("remove_context"==active_context||
"eraser_context"==active_context){_this.entity&&(deselect_all(),remove(_this.entity.uid),undo_list.push(clone_action(["remove",[_this.entity]])),socket.emit("remove",room,_this.entity.uid,active_slide),"eraser_context"==active_context&&on_left_click(k));_this==select_box&&clear_selected();k.stopPropagation();return}"drag_context"!=active_context&&(context_before_drag=active_context);active_context="drag_context";k.stopPropagation()}else a=300;drag_timeout=setTimeout(function(){if(mouse_down_interrupted)drag_delay_running=
!1,deselect_all();else if(is_room_locked&&!my_user.role)_this.entity&&"note"==_this.entity.type&&(_this.mouseup=toggle_note,_this.touchend=toggle_note,_this.mouseupoutside=toggle_note,_this.touchendoutside=toggle_note);else{var a=mouse_loc();last_drag_update=Date.now();last_drag_position=[from_x_local(a.x),from_y_local(a.y)];dragged_entity=_this;objectContainer.buttonMode=!0;"drag_context"!=active_context&&(context_before_drag=active_context);active_context="drag_context";_this.mouseup=on_drag_end;
_this.touchend=on_drag_end;_this.mouseupoutside=on_drag_end;_this.touchendoutside=on_drag_end;_this.mousemove=on_drag_move;_this.touchmove=on_drag_move;$("html,body").css("cursor","pointer");move_selected=!1;if(_this.entity)for(var f in selected_entities){if(selected_entities[f].uid==_this.entity.uid){move_selected=!0;break}}else move_selected=!0;move_selected||deselect_all();for(f in selected_entities)selected_entities[f].origin_x=selected_entities[f].x,selected_entities[f].origin_y=selected_entities[f].y,
objectContainer.removeChild(selected_entities[f].container),objectContainer.addChild(selected_entities[f].container);_this.entity&&(_this.entity.origin_x=_this.entity.x,_this.entity.origin_y=_this.entity.y);drag_delay_running=!1;select_box&&(objectContainer.removeChild(select_box),objectContainer.addChild(select_box));render_scene()}},a)}function toggle_note(k){this.entity.is_open=this.entity.is_open?!1:!0;align_note_text(this.entity)}
function move_entity(k,a,c){k.container&&(a=k.container.x+x_abs(a),c=k.container.y+y_abs(c),drag_entity(k,k.x+x_rel(a-k.container.x),k.y+y_rel(c-k.container.y)))}function limit_rate(k,a,c){clearTimeout(a.timeout);a.last_trigger||(a.last_trigger=Date.now());Date.now()-a.last_trigger>k?(c(),a.last_trigger=Date.now()):a.timeout=setTimeout(function(){c();a.last_trigger=Date.now()},k+5)}var drag_state={};
function on_drag_move(k){_this=this;limit_rate(15,drag_state,function(){var a=k.data.getLocalPosition(background_sprite),a=[mouse_x_rel(a.x),mouse_y_rel(a.y)],c=a[0]-last_mouse_location[0],f=a[1]-last_mouse_location[1];if(move_selected)for(var h in selected_entities)move_entity(selected_entities[h],c,f);else move_entity(_this.entity,c,f);select_box&&(select_box.x+=x_abs(c),select_box.y+=y_abs(f));select_box&&(objectContainer.removeChild(select_box),objectContainer.addChild(select_box));last_mouse_location=
a;render_scene()})}
function on_drag_end(k){limit_rate(15,drag_state,function(){});if(this.entity&&Math.abs(this.entity.origin_x-this.entity.x)<EPSILON&&Math.abs(this.entity.origin_y-this.entity.y)<EPSILON)"remove_context"==context_before_drag?(remove(this.entity.uid),undo_list.push(clone_action(["remove",[this.entity]])),socket.emit("remove",room,this.entity.uid,active_slide)):"note"==this.entity.type&&(toggle_note.call(this,k),deselect_all());else{k=["drag",[]];if(0<selected_entities.length)for(var a in selected_entities){var c=[selected_entities[a].origin_x,
selected_entities[a].origin_y];k[1].push([c,selected_entities[a].uid]);delete selected_entities[a].origin_x;delete selected_entities[a].origin_y;socket.emit("drag",room,selected_entities[a].uid,active_slide,selected_entities[a].x,selected_entities[a].y)}else c=[this.entity.origin_x,this.entity.origin_y],k[1].push([c,this.entity.uid]),delete this.entity.origin_x,delete this.entity.origin_y,socket.emit("drag",room,this.entity.uid,active_slide,this.entity.x,this.entity.y);undo_list.push(clone_action(k))}cancel_drag();
render_scene()}
function remove(k,a){var c=room_data.slides[active_slide].entities[k];if(c&&c.container&&(dragged_entity&&dragged_entity.entity&&dragged_entity.entity.uid==k&&cancel_drag(!0),"note"==c.type&&c.container.menu.remove(),objectContainer.removeChild(c.container),delete c.container,"icon"==c.type))try{var f=$('button[id*="'+room_data.slides[active_slide].entities[k].tank+'"]').find("span");f[0].innerHTML=parseInt(f[0].innerHTML)-1;f=$("#icon_context").find("span").first();f.text((parseInt(f.text())-1).toString())}catch(h){}for(c=
selected_entities.length;c--;)if(selected_entities[c].uid==k){selected_entities.splice(c,1);"drag_context"==active_context&&move_selected&&cancel_drag(!0);break}a||delete room_data.slides[active_slide].entities[k];select_box_dirty=!0;render_scene()}function move_tracker(k,a,c){var f=.1*a,h=.1*c,n=10,m=setInterval(function(){trackers[k]&&(trackers[k].x+=f,trackers[k].y+=h,trackers[k].container.x+=x_abs(f),trackers[k].container.y+=y_abs(h),render_scene());n--;0==n&&clearInterval(m)},15)}
var scene_dirty=!1;function render_scene(){scene_dirty=!0}function get_offset(){return offset}function get_server_time(){return Date.now()+offset}function get_local_time(k){return k-offset}var ping_container_atlas={},ping_texture_atlas={},active_pings=[];
function ping(k,a,c,f){var h;if(ping_container_atlas[c])h=ping_container_atlas[c];else{h=new PIXI.particles.ParticleContainer(500,{scale:!0,alpha:!0});ping_container_atlas[c]=h;var n=new PIXI.Sprite(ping_texture),n=PIXI.CanvasTinter.getTintedTexture(n,c);ping_texture_atlas[c]=new PIXI.Texture.fromCanvas(n);objectContainer.addChild(h)}c=new PIXI.Sprite(ping_texture_atlas[c]);c.anchor.set(.5);c.start_size=y_abs(.01)*(f/10)*zoom_level;c.height=c.start_size;c.width=c.start_size;c.x=x_abs(k);c.y=y_abs(a);
c.container=h;h.addChild(c);c.stop_time=Date.now()+PING_TIME;c.growth=5*c.height;render_scene();active_pings.push(c)}function update_pings(){var k=Date.now();active_pings=active_pings.filter(function(a){var c=a.stop_time-k,f=1-c/PING_TIME,h=a.start_size+f*a.growth;a.height=h;a.width=h;a.alpha=.5+.5*(1-f);if(0>=c)return a.container.removeChild(a),render_scene(),!1;render_scene();return!0})}
function setup_mouse_events(k,a){objectContainer.mouseup=a;objectContainer.touchend=a;objectContainer.mouseupoutside=a;objectContainer.touchendoutside=a;objectContainer.mousemove=k;objectContainer.touchmove=k}
function align_note_text(k){if(k.container)if(k.is_open){var a=$("#edit_window")[0].getBoundingClientRect(),c=a.left+to_x_local(k.x)+k.container.width*objectContainer.scale.x,a=a.top+to_y_local(k.y);k.container.menu.attr("style","top:"+a+"px; left:"+c+"px; display:block; z-index:20")}else k.container.menu.css("visibility","hidden")}
var drawArrow=function(k,a,c,f,h,n,m,g,d,e){a*=e;c*=e;f*=e;h*=e;d*=1.2;n=[f-a,h-c];var b=Math.atan2(n[1],n[0]);m=Math.abs(d*e/Math.cos(g));var p=b+Math.PI+g;e=f+Math.cos(p)*m;p=h+Math.sin(p)*m;g=b+Math.PI-g;f+=Math.cos(g)*m;h+=Math.sin(g)*m;k.beginPath();k.moveTo(e,p);k.lineTo(a+d/3*n[0],c+d/3*n[1]);k.lineTo(f,h);k.quadraticCurveTo((e+a+f)/3,(p+c+h)/3,e,p);k.fill()};
function hexToRGBA(k,a){var c=parseInt(k.slice(1,3),16),f=parseInt(k.slice(3,5),16),h=parseInt(k.slice(5,7),16);return"rgba("+c+", "+f+", "+h+", "+a+")"}
function init_canvas_simple(k,a,c,f,h){h||(h=[10,10]);c="#"+("00000"+(c|0).toString(16)).substr(-6);k.lineWidth=size_y/1E3*a*THICKNESS_SCALE;k.strokeStyle=c;k.fillStyle=c;k.shadowBlur=k.lineWidth/2;k.shadowColor="#000000";"setLineDash"in k&&("dashed"==f?(k.setLineDash(h),k.lineJoin=k.lineCap="round"):"dotted"==f?(k.setLineDash([a,a]),k.lineJoin=k.lineCap="butt"):k.lineJoin=k.lineCap="round")}
function init_canvas(k,a,c,f,h,n,m,g){init_canvas_simple(k,a,c,f,g);c="#"+("00000"+(c|0).toString(16)).substr(-6);"undefined"!==typeof h&&(n="#"+("00000"+(n|0).toString(16)).substr(-6),a=hexToRGBA(n,h),k.fillStyle=a,("00000"+(n|0).toString(16)).substr(-6),c=hexToRGBA(c,m),k.strokeStyle=c)}
function init_canvases(k,a,c,f,h,n){start_drawing();init_canvas(draw_context,k*DRAW_QUALITY,a,c,f,h,n,[10*DRAW_QUALITY,10*DRAW_QUALITY]);init_canvas(temp_draw_context,k*DRAW_QUALITY,a,c,f,h,n,[10*DRAW_QUALITY,10*DRAW_QUALITY]);draw_context.beginPath();temp_draw_context.beginPath()}function can_edit(){return!is_room_locked||my_user.role}function t2o(k){return 1-k/100}var last_point;
function on_left_click(k){"drag_context"==active_context&&cancel_drag(!0);var a=mouse_loc();if(can_edit()){try{document.activeElement.blur()}catch(f){}if("drag_context"!=active_context)if("ping_context"!=active_context&&deselect_all(),"draw_context"==active_context){setup_mouse_events(on_draw_move,on_draw_end);k=from_x_local(a.x);var c=from_y_local(a.y);new_drawing={uid:newUid(),type:"drawing",x:k,y:c,scale:[1,1],color:draw_color,alpha:1,thickness:parseFloat(draw_thickness)*zoom_level,end:$("#draw_end_type").find(".active").attr("data-end"),
style:$("#draw_type").find(".active").attr("data-style"),path:[[0,0]],end_size:draw_end_size*zoom_level,draw_zoom_level:zoom_level};init_canvases(parseFloat(draw_thickness),new_drawing.color,new_drawing.style);point_buffer=[a.x,a.y];last_point=[a.x,a.y]}else"ruler_context"==active_context?(setup_mouse_events(on_ruler_move,on_ruler_end),init_canvases(.1,16777215,"full"),left_click_origin=[from_x_local(a.x),from_y_local(a.y)]):"line_context"==active_context?new_drawing||(setup_mouse_events(on_line_move,
on_line_end),new_drawing={uid:newUid(),type:"line",x:from_x_local(a.x),y:from_y_local(a.y),scale:[1,1],color:line_color,alpha:1,thickness:parseFloat(line_thickness)*zoom_level,path:[[0,0]],end:$("#line_end_type").find(".active").attr("data-end"),style:$("#line_type").find(".active").attr("data-style"),end_size:line_end_size*zoom_level,draw_zoom_level:zoom_level},init_canvases(parseFloat(line_thickness),new_drawing.color,new_drawing.style),draw_context.moveTo(a.x*DRAW_QUALITY,a.y*DRAW_QUALITY),just_activated=
!0):"polygon_context"==active_context?new_drawing||(setup_mouse_events(on_line_move,on_polygon_end),new_drawing={uid:newUid(),type:"polygon",x:from_x_local(a.x),y:from_y_local(a.y),scale:[1,1],outline_thickness:polygon_outline_thickness*zoom_level,outline_color:polygon_outline_color,outline_opacity:t2o(polygon_outline_transparancy),fill_color:polygon_fill_color,fill_opacity:t2o(polygon_fill_transparancy),alpha:1,path:[[0,0]],style:$("#polygon_type").find(".active").attr("data-style"),draw_zoom_level:zoom_level},
init_canvases(polygon_outline_thickness,new_drawing.outline_color,new_drawing.style,new_drawing.fill_opacity,new_drawing.fill_color,new_drawing.outline_opacity),draw_context.moveTo(a.x*DRAW_QUALITY,a.y*DRAW_QUALITY),k="touchstart"==k.type?MIN_POLYGON_END_DISTANCE_TOUCH:MIN_POLYGON_END_DISTANCE,graphics=new PIXI.Graphics,graphics.lineStyle(new_drawing.outline_thickness*THICKNESS_SCALE,new_drawing.outline_color,new_drawing.outline_opacity),graphics.moveTo(x_abs(from_x_local(a.x)),y_abs(from_y_local(a.y))),
graphics.drawShape(new PIXI.Circle(x_abs(from_x_local(a.x)),y_abs(from_y_local(a.y)),size_y*k*zoom_level)),objectContainer.addChild(graphics),just_activated=!0,render_scene()):"curve_context"==active_context?new_drawing||(new_drawing={uid:newUid(),type:"curve",x:from_x_local(a.x),y:from_y_local(a.y),scale:[1,1],color:curve_color,alpha:1,thickness:parseFloat(curve_thickness)*zoom_level,path:[[0,0]],end:$("#curve_end_type").find(".active").attr("data-end"),style:$("#curve_type").find(".active").attr("data-style"),
end_size:curve_end_size*zoom_level,draw_zoom_level:zoom_level},point_buffer=[a.x,a.y],init_canvases(parseFloat(curve_thickness),new_drawing.color,new_drawing.style),draw_context.moveTo(a.x*DRAW_QUALITY,a.y*DRAW_QUALITY),setup_mouse_events(on_curve_move,on_curve_end),just_activated=!0):"area_context"==active_context?new_drawing||(new_drawing={uid:newUid(),type:"area",x:from_x_local(a.x),y:from_y_local(a.y),scale:[1,1],outline_thickness:parseFloat(area_outline_thickness)*zoom_level,outline_color:area_outline_color,
outline_opacity:t2o(area_outline_transparancy),fill_color:area_fill_color,fill_opacity:t2o(area_fill_transparancy),alpha:1,path:[[0,0]],style:$("#area_type").find(".active").attr("data-style"),draw_zoom_level:zoom_level},point_buffer=[a.x,a.y],init_canvases(parseFloat(area_outline_thickness),new_drawing.outline_color,new_drawing.style,new_drawing.fill_opacity,new_drawing.fill_color,new_drawing.outline_opacity),draw_context.moveTo(a.x*DRAW_QUALITY,a.y*DRAW_QUALITY),k="touchstart"==k.type?MIN_POLYGON_END_DISTANCE_TOUCH:
MIN_POLYGON_END_DISTANCE,graphics=new PIXI.Graphics,graphics.lineStyle(new_drawing.outline_thickness*THICKNESS_SCALE,new_drawing.outline_color,new_drawing.outline_opacity),graphics.moveTo(x_abs(from_x_local(a.x)),y_abs(from_y_local(a.y))),graphics.drawShape(new PIXI.Circle(x_abs(from_x_local(a.x)),y_abs(from_y_local(a.y)),size_y*k*zoom_level)),objectContainer.addChild(graphics),setup_mouse_events(on_curve_move,on_area_end),just_activated=!0,render_scene()):"icon_context"==active_context?setup_mouse_events(void 0,
on_icon_end):"eraser_context"==active_context?setup_mouse_events(on_eraser_move,on_eraser_end):"ping_context"==active_context?(drag_delay_running||deselect_all(),last_ping_time=new Date,setup_mouse_events(on_ping_move,on_ping_end)):"select_context"==active_context?(setup_mouse_events(on_select_move,on_select_end),init_canvases(2,12303291,"dotted",.25,12303291,1),left_click_origin=[from_x_local(a.x),from_y_local(a.y)],deselect_all()):"text_context"==active_context?setup_mouse_events(void 0,on_text_end):
"background_text_context"==active_context?setup_mouse_events(void 0,on_background_text_end):"rectangle_context"==active_context?new_drawing||(setup_mouse_events(on_rectangle_move,on_rectangle_end),left_click_origin=[from_x_local(a.x),from_y_local(a.y)],init_canvases(rectangle_outline_thickness,rectangle_outline_color,$("#rectangle_type").find(".active").attr("data-style"),t2o(rectangle_fill_transparancy),rectangle_fill_color,t2o(rectangle_outline_transparancy)),just_activated=new_drawing=!0):"circle_context"==
active_context?new_drawing||(setup_mouse_events(on_circle_move,on_circle_end),left_click_origin=[from_x_local(a.x),from_y_local(a.y)],init_canvases(circle_outline_thickness,circle_outline_color,$("#circle_type").find(".active").attr("data-style"),t2o(circle_fill_transparancy),circle_fill_color,t2o(circle_outline_transparancy)),circle_draw_style=$("#circle_draw_style").find(".active").attr("data-draw_style"),just_activated=new_drawing=!0):"track_context"==active_context?my_tracker?stop_tracking():
(start_tracking(a),on_track_move(k)):"note_context"==active_context&&setup_mouse_events(void 0,on_note_end)}else setup_mouse_events(on_ruler_move,on_ruler_end),init_canvases(.1,16777215,"full"),left_click_origin=[from_x_local(a.x),from_y_local(a.y)]}var eraser_state={};
function on_eraser_move(k){var a=mouse_loc();limit_rate(5,eraser_state,function(){renderer.plugins.interaction.processInteractive(a,objectContainer,function(a,f){if(f&&a.entity&&"background"!=a.entity.type){var c=a.entity;remove(c.uid);undo_list.push(clone_action(["remove",[c]]));socket.emit("remove",room,c.uid,active_slide)}},!0)})}function on_eraser_end(k){setup_mouse_events(void 0,void 0)}
function stop_tracking(){limit_rate(15,track_state,function(){});setup_mouse_events(void 0,void 0);socket.emit("stop_track",room,my_tracker.uid);objectContainer.removeChild(my_tracker.container);my_tracker=void 0;render_scene()}
function start_tracking(k){setup_mouse_events(on_track_move);var a=$("#track_shape .active").attr("data-cursor"),c;c="dot"==a||"cursor"==a?.025:.05;my_tracker={uid:newUid(),shape:a,size:track_size/10*c,color:track_color,x:from_x_local(k.x),y:from_y_local(k.y),owner:my_user.id};last_track_position=[my_tracker.x,my_tracker.y];socket.emit("track",room,my_tracker);create_tracker(my_tracker)}
function on_note_end(k){setup_mouse_events(void 0,void 0);var a=k.data.getLocalPosition(background_sprite);k=mouse_x_rel(a.x);a=mouse_y_rel(a.y);k={uid:newUid(),type:"note",x:k,y:a,scale:[1,1],color:text_color,alpha:1,text:"",font_size:font_size,font:"Arial",height:zoom_level,draw_zoom_level:zoom_level};undo_list.push(clone_action(["add",[k]]));create_note(k);k.container.is_open=!0;align_note_text(k);snap_and_emit_entity(k)}
function create_note(k){var a;texture_atlas["note.png"]&&!is_safari()?(a=texture_atlas["note.png"],a=new PIXI.Texture(loader.resources[a.sprite].texture,new PIXI.Rectangle(a.x,a.y,a.width,a.height))):a=PIXI.Texture.fromImage(image_host+"note.png");a=new PIXI.Sprite(a);var c=a.width/a.height;a.height=x_abs(NOTE_SCALE)*k.height;a.width=a.height*c;a.x=x_abs(k.x);a.y=y_abs(k.y);k.container=a;k.container.entity=k;k.container.is_open=!1;k.container.menu=$('<div class="popover fade right in" role="tooltip"><h3 style="display: none;" class="popover-title"></h3><div class="popover-content"><textarea style="height:400px; width:300px;" id="note_box"></textarea><br /><span id="notification_area" style="float: left;" hidden>Saved</span><div style="float:right; padding:3px;"></div></div></div>');
$("#note_box",k.container.menu).val(k.text);is_room_locked&&!my_user.role&&($("textarea",k.container.menu).prop("readonly",!0),$("button",k.container.menu).hide());$("body").append(k.container.menu);$("#note_box",k.container.menu).on("blur",function(){can_edit()&&(k.text=$("#note_box",k.container.menu).val(),$("#notification_area",k.container.menu).show(),$("#notification_area",k.container.menu).fadeOut("slow"),snap_and_emit_entity(k))});align_note_text(k);init_dragging(k.container);objectContainer.addChild(k.container);
render_scene();a.texture.on("update",function(){render_scene()});room_data.slides[active_slide].entities[k.uid]=k}
function create_tracker(k){var a;texture_atlas[k.shape+".png"]&&!is_safari()?(a=texture_atlas[k.shape+".png"],a=new PIXI.Texture(loader.resources[a.sprite].texture,new PIXI.Rectangle(a.x,a.y,a.width,a.height))):a=PIXI.Texture.fromImage(image_host+k.shape+".png");k.container=new PIXI.Sprite(a);k.container.tint=k.color;"cursor"!=k.shape&&k.container.anchor.set(.5);k.container.x=x_abs(k.x);k.container.y=y_abs(k.y);a=k.container.width/k.container.height;k.container.height=y_abs(k.size);k.container.width=
k.container.height*a;trackers[k.uid]=k;objectContainer.addChild(trackers[k.uid].container);render_scene()}function remove_tracker(k){objectContainer.removeChild(trackers[k].container);render_scene();delete trackers[k]}var last_track_update=Date.now(),count,track_timeout,track_state={};
function on_track_move(k){limit_rate(15,track_state,function(){clearTimeout(track_timeout);var a=mouse_loc(),c=from_x_local(a.x),a=from_y_local(a.y);my_tracker.x=c;my_tracker.y=a;my_tracker.container.x=x_abs(c);my_tracker.container.y=y_abs(a);c=(last_track_position[0]-my_tracker.x)*(last_track_position[0]-my_tracker.x)+(last_track_position[1]-my_tracker.y)*(last_track_position[1]-my_tracker.y);render_scene();a=Date.now()-last_track_update;c>MIN_TRACK_MOVE_DISTANCE_SQ||50<a?(last_track_update=Date.now(),
0<Math.abs(my_tracker.x-last_track_position[0]+my_tracker.y-last_track_position[1])&&(socket.emit("track_move",room,my_tracker.uid,my_tracker.x-last_track_position[0],my_tracker.y-last_track_position[1]),last_track_position=[my_tracker.x,my_tracker.y])):track_timeout=setTimeout(function(){my_tracker&&(last_track_update=Date.now(),socket.emit("track_move",room,my_tracker.uid,my_tracker.x-last_track_position[0],my_tracker.y-last_track_position[1]),last_track_position=[my_tracker.x,my_tracker.y],render_scene())},
55)})}
function on_area_end(k){var a=mouse_loc(),c=a.x,f=a.y,h=Math.pow(new_drawing.x-from_x_local(c),2)+Math.pow(new_drawing.y-from_y_local(f),2),n="touchend"==k.type||"touchendoutside"==k.type?MIN_POLYGON_END_DISTANCE_TOUCH:MIN_POLYGON_END_DISTANCE;if(just_activated&&(just_activated=!1,h<EPSILON))return;h<n*n*zoom_level?(create_area2(new_drawing,DRAW_QUALITY),emit_entity(new_drawing),undo_list.push(clone_action(["add",[new_drawing]])),objectContainer.removeChild(graphics),render_scene(),stop_drawing(),setup_mouse_events(void 0,
void 0),new_drawing=null):(point_buffer.push(a.x,a.y),new_drawing.path.push([from_x_local(c)-new_drawing.x,from_y_local(f)-new_drawing.y]),on_curve_move(k))}var curve_state={},point_buffer=[];
function on_curve_move(k){limit_rate(20,curve_state,function(){var a=mouse_loc(),c=a.x,f=a.y;temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);point_buffer.push(c,f);var h=smooth_draw(temp_draw_context,point_buffer,!1,DRAW_QUALITY);point_buffer.pop();point_buffer.pop();new_drawing.path.push([from_x_local(a.x)-new_drawing.x,from_y_local(a.y)-new_drawing.y]);draw_end(temp_draw_context,new_drawing,h[0],h[1],1/zoom_level,DRAW_QUALITY);new_drawing.path.pop();
last_point=[c,f]})}
function on_curve_end(k){var a=mouse_loc(),c=a.x,f=a.y,h=Math.pow(from_x_local(c)-new_drawing.x-new_drawing.path[new_drawing.path.length-1][0],2)+Math.pow(from_y_local(f)-new_drawing.y-new_drawing.path[new_drawing.path.length-1][1],2);if(just_activated&&(just_activated=!1,h<EPSILON))return;var n="touchend"==k.type||"touchendoutside"==k.type||"touchstart"==k.type||"touchstartoutside"==k.type?MIN_POLYGON_END_DISTANCE_TOUCH:MIN_POLYGON_END_DISTANCE;h<n*n*zoom_level?(create_curve2(new_drawing,DRAW_QUALITY),
emit_entity(new_drawing),undo_list.push(clone_action(["add",[new_drawing]])),objectContainer.removeChild(graphics),render_scene(),stop_drawing(),setup_mouse_events(void 0,void 0),new_drawing=null):(point_buffer.push(a.x,a.y),new_drawing.path.push([from_x_local(c)-new_drawing.x,from_y_local(f)-new_drawing.y]),objectContainer.removeChild(graphics),graphics=new PIXI.Graphics,graphics.lineStyle(new_drawing.thickness*THICKNESS_SCALE,new_drawing.color,1),graphics.moveTo(x_abs(from_x_local(a.x)),y_abs(from_y_local(a.y))),
graphics.drawShape(new PIXI.Circle(x_abs(from_x_local(a.x)),y_abs(from_y_local(a.y)),size_y*n*zoom_level)),objectContainer.addChild(graphics),render_scene(),on_curve_move(k))}
function on_polygon_end(k){try{var a=k.data.getLocalPosition(background_sprite),c=mouse_x_rel(a.x),f=mouse_y_rel(a.y),c=c-new_drawing.x,f=f-new_drawing.y}catch(m){}a=c*c+f*f;k="touchend"==k.type||"touchendoutside"==k.type?MIN_POLYGON_END_DISTANCE_TOUCH:MIN_POLYGON_END_DISTANCE;var h;h=1==new_drawing.path.length?[to_x_local(new_drawing.x),to_y_local(new_drawing.y)]:[to_x_local(new_drawing.path[new_drawing.path.length-2][0]+new_drawing.x),to_y_local(new_drawing.path[new_drawing.path.length-2][1]+new_drawing.y)];
var n=[to_x_local(c+new_drawing.x),to_y_local(f+new_drawing.y)];if(just_activated&&(h=Math.pow(h[0]-n[0],2)+Math.pow(h[1]-n[1],2),just_activated=!1,.01>h))return;a<k*k*zoom_level?(new_drawing.path.push([0,0]),create_polygon2(new_drawing,DRAW_QUALITY),emit_entity(new_drawing),undo_list.push(clone_action(["add",[new_drawing]])),objectContainer.removeChild(graphics),render_scene(),setup_mouse_events(void 0,void 0),stop_drawing(),new_drawing=null):(0!=new_drawing.path.length&&c==last(new_drawing.path)[0]&&
f==last(new_drawing.path)[1]||new_drawing.path.push([c,f]),draw_context.lineTo(n[0]*DRAW_QUALITY,n[1]*DRAW_QUALITY),draw_context.stroke())}function draw_shape(k,a,c,f,h,n){var m=new PIXI.Graphics;m.lineStyle(k*THICKNESS_SCALE,c,a);m.beginFill(h,f);m.drawShape(n);m.endFill();m.boundsPadding=1;return new PIXI.Sprite(renderer.generateTexture(m))}var ruler_state={};
function on_ruler_move(k){limit_rate(15,ruler_state,function(){var a=k.data.getLocalPosition(background_sprite),c=background.size_x?background.size_x:0,f=background.size_y?background.size_y:0;temp_draw_context.lineWidth=size_x/1E3*2*DRAW_QUALITY;temp_draw_context.strokeStyle="#FFFFFF";temp_draw_context.fillStyle="#FFFFFF";var h=to_x_local(left_click_origin[0]),n=to_y_local(left_click_origin[1]),m=to_x_local(mouse_x_rel(a.x)),g=to_y_local(mouse_y_rel(a.y)),d=Math.sqrt(Math.pow(h-m,2)+Math.pow(n-g,
2));temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);temp_draw_context.beginPath();temp_draw_context.moveTo(m*DRAW_QUALITY,g*DRAW_QUALITY);temp_draw_context.lineTo(h*DRAW_QUALITY,n*DRAW_QUALITY);temp_draw_context.moveTo((h+d)*DRAW_QUALITY,n*DRAW_QUALITY);temp_draw_context.arc(h*DRAW_QUALITY,n*DRAW_QUALITY,d*DRAW_QUALITY,0,2*Math.PI);temp_draw_context.stroke();h=(h+to_x_local(mouse_x_rel(a.x)))/2;n=(n+to_y_local(mouse_y_rel(a.y)))/2;temp_draw_context.font=
"44px Arial";a=Math.sqrt(Math.pow(c*(left_click_origin[0]-mouse_x_rel(a.x)),2)+Math.pow(f*(left_click_origin[1]-mouse_y_rel(a.y)),2));temp_draw_context.lineWidth=to_x_local(.5)/1E3*DRAW_QUALITY;temp_draw_context.strokeStyle="#000000";temp_draw_context.fillStyle="#FFFFFF";c="";c="lol"==game?c+(Math.round(10*a)/10+"u"):"wows"==game?c+(Math.round(.01*a)/10+"km"):c+(Math.round(10*a)/10+"m");temp_draw_context.fillText(c,h*DRAW_QUALITY,n*DRAW_QUALITY)})}
function on_ruler_end(k){setup_mouse_events(void 0,void 0);limit_rate(15,ruler_state,function(){temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY)})}var circle_state={};
function on_circle_move(k){limit_rate(15,circle_state,function(){var a=mouse_loc(),c=from_x_local(a.x),f=from_y_local(a.y),h,k,m;"edge"==circle_draw_style?(h=(left_click_origin[0]+c)/2,k=(left_click_origin[1]+f)/2,m=Math.sqrt(Math.pow(to_x_local(left_click_origin[0])-to_x_local(c),2)+Math.pow(to_y_local(left_click_origin[1])-to_y_local(f),2)),m/=2):"radius"==circle_draw_style&&(h=left_click_origin[0],k=left_click_origin[1],m=Math.sqrt(Math.pow(to_x_local(left_click_origin[0])-to_x_local(c),2)+Math.pow(to_y_local(left_click_origin[1])-
to_y_local(f),2)));temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);temp_draw_context.beginPath();temp_draw_context.arc(to_x_local(h)*DRAW_QUALITY,to_y_local(k)*DRAW_QUALITY,m*DRAW_QUALITY,0,2*Math.PI);temp_draw_context.fill();temp_draw_context.stroke();"radius"==circle_draw_style&&background.size_x&&0<background.size_x&&background.size_y&&0<background.size_y&&(temp_draw_context.save(),temp_draw_context.lineWidth=size_x/1E3*2*DRAW_QUALITY,temp_draw_context.strokeStyle=
"#FFFFFF",temp_draw_context.fillStyle="#FFFFFF",temp_draw_context.shadowBlur=0,temp_draw_context.beginPath(),temp_draw_context.moveTo(to_x_local(h)*DRAW_QUALITY,to_y_local(k)*DRAW_QUALITY),temp_draw_context.lineTo(to_x_local(c)*DRAW_QUALITY,to_y_local(f)*DRAW_QUALITY),temp_draw_context.stroke(),m=to_x_local((h+c)/2),a=to_y_local((k+f)/2),temp_draw_context.font="33px Arial",c=Math.sqrt(Math.pow(background.size_x*(h-c),2)+Math.pow(background.size_y*(k-f),2)),temp_draw_context.lineWidth=to_x_local(.5)/
1E3*DRAW_QUALITY,temp_draw_context.strokeStyle="#000000",temp_draw_context.fillStyle="#FFFFFF",h="",h="lol"==game?h+(Math.round(10*c)/10+"u"):"wows"==game?h+(Math.round(.01*c)/10+"km"):h+(Math.round(10*c)/10+"m"),temp_draw_context.fillText(h,m*DRAW_QUALITY,a*DRAW_QUALITY),temp_draw_context.stroke(),temp_draw_context.restore())})}
function on_circle_end(k){limit_rate(15,circle_state,function(){});var a=mouse_loc();k=from_x_local(a.x);var a=from_y_local(a.y),c,f,h;"edge"==circle_draw_style?(c=(left_click_origin[0]+k)/2,f=(left_click_origin[1]+a)/2,h=Math.sqrt(Math.pow(to_x_local(left_click_origin[0])-to_x_local(k),2)+Math.pow(to_y_local(left_click_origin[1])-to_y_local(a),2)),h/=2):"radius"==circle_draw_style&&(c=left_click_origin[0],f=left_click_origin[1],h=Math.sqrt(Math.pow(to_x_local(left_click_origin[0])-to_x_local(k),
2)+Math.pow(to_y_local(left_click_origin[1])-to_y_local(a),2)));c={uid:newUid(),type:"circle",x:c,y:f,radius:from_y_local_vect(h),outline_thickness:circle_outline_thickness*zoom_level,outline_color:circle_outline_color,outline_opacity:t2o(circle_outline_transparancy),fill_opacity:t2o(circle_fill_transparancy),fill_color:circle_fill_color,alpha:1,style:$("#circle_type").find(".active").attr("data-style"),draw_zoom_level:zoom_level};"radius"==circle_draw_style&&background.size_x&&0<background.size_x&&
background.size_y&&0<background.size_y&&(c.draw_radius=[k-c.x,a-c.y]);new_drawing=void 0;create_circle2(c,DRAW_QUALITY);emit_entity(c);undo_list.push(clone_action(["add",[c]]));stop_drawing();setup_mouse_events(void 0,void 0)}var rectangle_state={};
function on_rectangle_move(k){limit_rate(15,rectangle_state,function(){var a=k.data.getLocalPosition(background_sprite),c=Math.min(left_click_origin[0],mouse_x_rel(a.x)),f=Math.min(left_click_origin[1],mouse_y_rel(a.y)),h=Math.max(left_click_origin[0],mouse_x_rel(a.x)),a=Math.max(left_click_origin[1],mouse_y_rel(a.y));temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);temp_draw_context.fillRect(to_x_local(c)*DRAW_QUALITY,to_y_local(f)*DRAW_QUALITY,
(to_x_local(h)-to_x_local(c))*DRAW_QUALITY,(to_y_local(a)-to_y_local(f))*DRAW_QUALITY);temp_draw_context.strokeRect(to_x_local(c)*DRAW_QUALITY,to_y_local(f)*DRAW_QUALITY,(to_x_local(h)-to_x_local(c))*DRAW_QUALITY,(to_y_local(a)-to_y_local(f))*DRAW_QUALITY)})}
function on_rectangle_end(k){limit_rate(15,rectangle_state,function(){});var a=k.data.getLocalPosition(background_sprite);k=Math.min(left_click_origin[0],mouse_x_rel(a.x));var c=Math.min(left_click_origin[1],mouse_y_rel(a.y)),f=Math.max(left_click_origin[0],mouse_x_rel(a.x)),a=Math.max(left_click_origin[1],mouse_y_rel(a.y));if(just_activated){var h=Math.pow(to_x_local(k-f),2)+Math.pow(to_y_local(c-a),2);just_activated=!1;if(.01>h)return}new_drawing=void 0;k={uid:newUid(),type:"rectangle",x:k,y:c,
width:f-k,height:a-c,outline_thickness:rectangle_outline_thickness*zoom_level,outline_color:rectangle_outline_color,outline_opacity:t2o(rectangle_outline_transparancy),fill_opacity:t2o(rectangle_fill_transparancy),fill_color:rectangle_fill_color,alpha:1,style:$("#rectangle_type").find(".active").attr("data-style"),draw_zoom_level:zoom_level};create_rectangle2(k,DRAW_QUALITY);emit_entity(k);undo_list.push(clone_action(["add",[k]]));stop_drawing();setup_mouse_events(void 0,void 0)}
function on_ping_move(k){limit_rate(60,drag_state,function(){var a=Date.now();if(!(10>a-last_ping_time)){var c=mouse_loc(),f=from_x_local(c.x),c=from_y_local(c.y);last_ping_time=a;ping(f,c,ping_color,ping_size);socket.emit("ping_marker",room,f,c,ping_color,ping_size)}})}
function on_ping_end(k){limit_rate(0,drag_state,function(){});var a=mouse_loc();k=from_x_local(a.x);a=from_y_local(a.y);ping(k,a,ping_color,ping_size);socket.emit("ping_marker",room,k,a,ping_color,ping_size);setup_mouse_events(void 0,void 0)}var select_state={};
function on_select_move(k){limit_rate(15,select_state,function(){var a=k.data.getLocalPosition(background_sprite),c=Math.min(left_click_origin[0],mouse_x_rel(a.x)),f=Math.min(left_click_origin[1],mouse_y_rel(a.y)),h=Math.max(left_click_origin[0],mouse_x_rel(a.x)),a=Math.max(left_click_origin[1],mouse_y_rel(a.y));temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);temp_draw_context.fillRect(to_x_local(c)*DRAW_QUALITY,to_y_local(f)*DRAW_QUALITY,
(to_x_local(h)-to_x_local(c))*DRAW_QUALITY,(to_y_local(a)-to_y_local(f))*DRAW_QUALITY);temp_draw_context.strokeRect(to_x_local(c)*DRAW_QUALITY,to_y_local(f)*DRAW_QUALITY,(to_x_local(h)-to_x_local(c))*DRAW_QUALITY,(to_y_local(a)-to_y_local(f))*DRAW_QUALITY)})}
function on_select_end(k){limit_rate(15,select_state,function(){temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY)});setup_mouse_events(void 0,void 0);var a=k.data.getLocalPosition(background_sprite);k=Math.min(x_abs(mouse_x_rel(a.x)),x_abs(left_click_origin[0]));var c=Math.min(y_abs(mouse_y_rel(a.y)),y_abs(left_click_origin[1])),f=Math.max(x_abs(mouse_x_rel(a.x)),x_abs(left_click_origin[0])),a=Math.max(y_abs(mouse_y_rel(a.y)),y_abs(left_click_origin[1])),
h;for(h in room_data.slides[active_slide].entities)if(room_data.slides[active_slide].entities.hasOwnProperty(h)&&room_data.slides[active_slide].entities[h].container){var n=room_data.slides[active_slide].entities[h].container.getBounds();n.width/=objectContainer.scale.x;n.height/=objectContainer.scale.y;n.x=(-objectContainer.x+n.x)/objectContainer.scale.x;n.y=(-objectContainer.y+n.y)/objectContainer.scale.y;var m=n.y,g=n.x+n.width,d=n.y+n.height;n.x>k&&m>c&&g<f&&d<a&&selected_entities.push(room_data.slides[active_slide].entities[h])}select_entities();
undo_list.push(clone_action(["select",selected_entities,previously_selected_entities]));render_scene()}function measure_text(k){return[x_rel(k.container.width),x_rel(k.container.height)]}
function select_box_mousemove(k,a,c,f,h,n,m){limit_rate(15,select_box_move_state,function(){var g=mouse_loc();g.x=x_abs(from_x_local(g.x));g.y=y_abs(from_y_local(g.y));var d=Math.abs((g.x-a)/f),e=Math.abs((g.y-c)/h),b;for(b in selected_entities){var k=selected_entities[b];n||(k.container.scale.x=d*k.container.start_scale[0],k.container.x=(k.container.x_orig-a)*d+a);m||(k.container.scale.y=e*k.container.start_scale[1],k.container.y=(k.container.y_orig-c)*e+c)}n||(select_box.width=Math.abs(a-g.x),select_box.left_x=
Math.min(a,g.x),select_box.x=select_box.left_x+select_box.width/2);m||(select_box.height=Math.abs(c-g.y),select_box.upper_y=Math.min(c,g.y),select_box.y=select_box.upper_y+select_box.height/2);render_scene()});k.stopPropagation()}
function select_box_mouseup(k,a,c,f,h,n,m){limit_rate(15,select_box_move_state,function(){});setup_mouse_events(void 0,void 0);var g=mouse_loc();g.x=x_abs(from_x_local(g.x));g.y=y_abs(from_y_local(g.y));f=Math.abs((g.x-a)/f);h=Math.abs((g.y-c)/h);var d=["drag",[]],e;for(e in selected_entities){var b=selected_entities[e],p=[1,1];b.scale&&(p=[b.scale[0],b.scale[1]]);d[1].push([[b.x,b.y,[p[0],p[1]]],b.uid]);var r=b.x,q=b.y;n||(r=x_rel((b.container.x_orig-a)*f+a-b.container.x_orig)+b.x,p[0]=f*b.container.start_scale[0]/
b.container.orig_scale[0]);m||(q=y_rel((b.container.y_orig-c)*h+c-b.container.y_orig)+b.y,p[1]=h*b.container.start_scale[1]/b.container.orig_scale[1]);b.container.x=b.container.x_orig;b.container.y=b.container.y_orig;drag_entity(b,r,q,p);socket.emit("drag",room,b.uid,active_slide,r,q,p)}undo_list.push(clone_action(d));select_box.mouseover=on_select_over;select_box.mousemove=on_selectbox_move;n||(select_box.width=Math.abs(a-g.x),select_box.left_x=Math.min(a,g.x),select_box.x=select_box.left_x+select_box.width/
2);m||(select_box.height=Math.abs(c-g.y),select_box.upper_y=Math.min(c,g.y),select_box.y=select_box.upper_y+select_box.height/2);render_scene();k.stopPropagation()}
function prepare_resize(k,a,c,f,h,n,m){for(var g in selected_entities){var d=selected_entities[g];d.container.x_orig=d.container.x;d.container.y_orig=d.container.y;d.container.start_scale=[d.container.scale.x,d.container.scale.y]}objectContainer.removeChild(rotate_arrow0);objectContainer.removeChild(rotate_arrow1);objectContainer.removeChild(rotate_arrow2);objectContainer.removeChild(rotate_arrow3);setup_mouse_events(function(d){select_box_mousemove(d,a,c,f,h,n,m)},function(d){select_box_mouseup(d,
a,c,f,h,n,m)});select_box.mouseover=void 0;select_box.mousemove=void 0;k.stopPropagation()}var select_box_move_state={};
function on_selectbox_move(k){limit_rate(15,select_box_move_state,function(){var a=mouse_loc();a.x=x_abs(from_x_local(a.x));a.y=y_abs(from_y_local(a.y));a.x-=select_box.left_x;a.y-=select_box.upper_y;a.x/=select_box.width;a.y/=select_box.height;var c=y_abs(ROTATE_ARROW_MARGIN)*zoom_level,f=c/select_box.width,c=c/select_box.height,h=select_box.left_x,n=select_box.upper_y,m=h+select_box.width,g=n+select_box.height;a.x<0-f||a.x>1+f||a.y<0-c||a.y>1+c?(on_select_out(k),k&&k.stopPropagation()):(f=Math.min(f,
.25),c=Math.min(c,.25),a.x<f?(a.y<c?($("html,body").css("cursor","nw-resize"),objectContainer.mousedown=function(a){prepare_resize(a,m,g,select_box.width,select_box.height,!1,!1)}):a.y>1-c?($("html,body").css("cursor","sw-resize"),objectContainer.mousedown=function(a){prepare_resize(a,m,n,select_box.width,select_box.height,!1,!1)}):($("html,body").css("cursor","w-resize"),objectContainer.mousedown=function(a){prepare_resize(a,m,0,select_box.width,select_box.height,!1,!0)}),select_box.mousedown=objectContainer.mousedown):
a.x>1-f?(a.y<c?($("html,body").css("cursor","ne-resize"),objectContainer.mousedown=function(a){prepare_resize(a,h,g,select_box.width,select_box.height,!1,!1)}):a.y>1-c?($("html,body").css("cursor","se-resize"),objectContainer.mousedown=function(a){prepare_resize(a,h,n,select_box.width,select_box.height,!1,!1)}):($("html,body").css("cursor","e-resize"),objectContainer.mousedown=function(a){prepare_resize(a,h,0,select_box.width,select_box.height,!1,!0)}),select_box.mousedown=objectContainer.mousedown):
a.y<c?($("html,body").css("cursor","n-resize"),objectContainer.mousedown=function(a){prepare_resize(a,0,g,select_box.width,select_box.height,!0,!1)},select_box.mousedown=objectContainer.mousedown):a.y>1-c?($("html,body").css("cursor","s-resize"),objectContainer.mousedown=function(a){prepare_resize(a,0,n,select_box.width,select_box.height,!0,!1)},select_box.mousedown=objectContainer.mousedown):($("html,body").css("cursor","move"),select_box.mousedown=on_drag_start,objectContainer.mousedown=on_left_click))});
k&&k.stopPropagation()}function on_select_over(k){select_box.mousemove=on_selectbox_move;select_box.mouseout=on_select_out}function on_select_out(k){limit_rate(15,select_box_move_state,function(){});$("html,body").css("cursor","default");select_box.mousemove=void 0;select_box.mousedown=void 0;objectContainer.mousedown=on_left_click;select_box.mouseout=void 0}function make_resizable(k){k.interactive=!0;k.mouseover=on_select_over}
function redraw_select_box(){if(select_box)if(select_box.rotation=0,0<selected_entities.length){var k=99999,a=-99999,c=99999,f=-99999,h;for(h in selected_entities){var n=selected_entities[h].container,m,g,d;g=-n.rotation;m=Math.abs(n.width*Math.cos(g))+Math.abs(n.height*Math.sin(g));g=Math.abs(n.width*Math.sin(g))+Math.abs(n.height*Math.cos(g));d=n.x-n.anchor.x*m;n=n.y-n.anchor.y*g;k=Math.min(d,k);c=Math.min(n,c);a=Math.max(d+m,a);f=Math.max(n+g,f)}select_center=[x_rel(k+(a-k)/2),y_rel(c+(f-c)/2)];
select_box.left_x=k;select_box.upper_y=c;select_box.width=a-k;select_box.height=f-c;select_box.x=k+select_box.width/2;select_box.y=c+select_box.height/2;rotate_arrow0.x=k+select_box.width+rotate_arrow0.width/2+y_abs(ROTATE_ARROW_MARGIN)*zoom_level;rotate_arrow0.y=c+select_box.height/2;rotate_arrow1.x=k+select_box.width/2;rotate_arrow1.y=c-rotate_arrow1.width/2-y_abs(ROTATE_ARROW_MARGIN)*zoom_level;rotate_arrow2.x=k-rotate_arrow2.width/2-y_abs(ROTATE_ARROW_MARGIN)*zoom_level;rotate_arrow2.y=c+select_box.height/
2;rotate_arrow3.x=k+select_box.width/2;rotate_arrow3.y=c+rotate_arrow3.width/2+select_box.height+y_abs(ROTATE_ARROW_MARGIN)*zoom_level;objectContainer.removeChild(rotate_arrow0);objectContainer.removeChild(rotate_arrow1);objectContainer.removeChild(rotate_arrow2);objectContainer.removeChild(rotate_arrow3);objectContainer.addChild(rotate_arrow0);objectContainer.addChild(rotate_arrow1);objectContainer.addChild(rotate_arrow2);objectContainer.addChild(rotate_arrow3);objectContainer.removeChild(select_box);
objectContainer.addChild(select_box)}else remove_select_box();select_box_dirty=!1}
function start_rotate_selection(k,a){limit_rate(15,drag_state,function(){});objectContainer.buttonMode=!0;setup_mouse_events(rotate_selection.bind(void 0,this,k),stop_rotate_selection.bind(void 0,this,k));var c=a.data.getLocalPosition(background_sprite);last_mouse_location=[mouse_x_rel(c.x),mouse_y_rel(c.y)];for(var f in selected_entities)c=room_data.slides[active_slide].entities[selected_entities[f].uid].container,c.x_orig=c.x,c.y_orig=c.y,c.rotation_orig=c.rotation;objectContainer.removeChild(rotate_arrow0);
objectContainer.removeChild(rotate_arrow1);objectContainer.removeChild(rotate_arrow2);objectContainer.removeChild(rotate_arrow3);objectContainer.addChild(this);a.stopPropagation()}
function rotate_selection(k,a,c){limit_rate(15,drag_state,function(){var f=c.data.getLocalPosition(background_sprite),f=[mouse_x_rel(f.x),mouse_y_rel(f.y)],h=f[1]-last_mouse_location[1];k.x+=x_abs(f[0]-last_mouse_location[0]);k.y+=y_abs(h);a=Math.atan2(-(f[1]-select_center[1]),f[0]-select_center[0])-a;var h=Math.sin(-a),n=Math.cos(-a),m;for(m in selected_entities){var g=room_data.slides[active_slide].entities[selected_entities[m].uid].container;g.x=g.x_orig;g.y=g.y_orig;g.x-=x_abs(select_center[0]);
g.y-=y_abs(select_center[1]);var d=g.x;g.x=g.x*n-g.y*h;g.y=d*h+g.y*n;g.x+=x_abs(select_center[0]);g.y+=y_abs(select_center[1]);g.rotation=g.rotation_orig-a}select_box.rotation=-a;last_mouse_location=f;render_scene()})}
function stop_rotate_selection(k,a,c){limit_rate(15,drag_state,function(){});objectContainer.buttonMode=!1;setup_mouse_events(void 0,void 0);c=c.data.getLocalPosition(background_sprite);c=[mouse_x_rel(c.x),mouse_y_rel(c.y)];var f=c[1]-last_mouse_location[1];k.x+=x_abs(c[0]-last_mouse_location[0]);k.y+=y_abs(f);a=Math.atan2(-(c[1]-select_center[1]),c[0]-select_center[0])-a;k=Math.sin(-a);c=Math.cos(-a);var f=["drag",[]],h;for(h in selected_entities){var n=room_data.slides[active_slide].entities[selected_entities[h].uid],
m=n.container,m=room_data.slides[active_slide].entities[selected_entities[h].uid].container;m.x=m.x_orig;m.y=m.y_orig;m.x-=x_abs(select_center[0]);m.y-=y_abs(select_center[1]);var g=m.x;m.x=m.x*c-m.y*k;m.y=g*k+m.y*c;m.x+=x_abs(select_center[0]);m.y+=y_abs(select_center[1]);g=[1,1];n.scale&&(g=[n.scale[0],n.scale[1]]);var d=0;n.rotation&&(d=n.rotation);f[1].push([[n.x,n.y,[g[0],g[1]],d],n.uid]);g=m.x-m.x_orig;d=m.y-m.y_orig;m.x=m.x_orig;m.y=m.y_orig;n.rotation||(n.rotation=0);m=(n.rotation+a)%(2*Math.PI);
socket.emit("drag",room,n.uid,active_slide,x_rel(x_abs(n.x)+g),y_rel(y_abs(n.y)+d),n.scale,m);drag_entity(n,x_rel(x_abs(n.x)+g),y_rel(y_abs(n.y)+d),n.scale,m)}undo_list.push(clone_action(f));select_box_dirty=!0;render_scene()}
function select_entities(){remove_select_box();var k=99999,a=-99999,c=99999,f=-99999,h;for(h in selected_entities){var n=room_data.slides[active_slide].entities[selected_entities[h].uid].container,m,g,d;g=-n.rotation;m=Math.abs(n.width*Math.cos(g))+Math.abs(n.height*Math.sin(g));g=Math.abs(n.width*Math.sin(g))+Math.abs(n.height*Math.cos(g));d=n.x-n.anchor.x*m;n=n.y-n.anchor.y*g;k=Math.min(x_rel(d),k);c=Math.min(y_rel(n),c);a=Math.max(x_rel(d)+x_rel(m),a);f=Math.max(y_rel(n)+y_rel(g),f);room_data.slides[active_slide].entities[selected_entities[h].uid].container.alpha=
select_alpha}if(0<selected_entities.length){select_center=[k+(a-k)/2,c+(f-c)/2];h=new PIXI.Rectangle(0,0,x_abs(a-k),y_abs(f-c),5);select_box=draw_select_box(h);select_box.anchor.x=.5;select_box.anchor.y=.5;h=x_abs(k);m=y_abs(c);select_box.left_x=h;select_box.upper_y=m;select_box.x=h+x_abs(a-k)/2;select_box.y=m+y_abs(f-c)/2;make_resizable(select_box);var e=new PIXI.Texture.fromImage(image_host+"rotate.png"),k=e.width/e.height,b=y_abs(ROTATE_ARROW_SCALE)*zoom_level,p=b*k,k=function(a,c,d){var f=new PIXI.Sprite(e);
f.anchor.x=.5;f.anchor.y=.5;f.width=p;f.height=b;f.interactive=!0;f.buttonMode=!0;f.draggable=!0;f.mousedown=start_rotate_selection.bind(f,d);f.rotation=-d;f.x=a;f.y=c;objectContainer.addChild(f);return f};rotate_arrow0=k(h+select_box.width+p/2+y_abs(ROTATE_ARROW_MARGIN)*zoom_level,m+select_box.height/2,0);rotate_arrow1=k(h+select_box.width/2,m-p/2-y_abs(ROTATE_ARROW_MARGIN)*zoom_level,Math.PI/2);rotate_arrow2=k(h-p/2-y_abs(ROTATE_ARROW_MARGIN)*zoom_level,m+select_box.height/2,Math.PI);rotate_arrow3=
k(h+select_box.width/2,m+p/2+select_box.height+y_abs(ROTATE_ARROW_MARGIN)*zoom_level,-Math.PI/2);objectContainer.addChild(select_box)}render_scene()}function draw_select_box(k){var a=new PIXI.Graphics;a.lineStyle(1*zoom_level,16777215,.2);a.beginFill(16777215,.2);a.drawShape(k);a.endFill();return new PIXI.Sprite(renderer.generateTexture(a))}
function select_all(){previously_selected_entities=selected_entities;selected_entities=[];for(var k in room_data.slides[active_slide].entities)room_data.slides[active_slide].entities.hasOwnProperty(k)&&room_data.slides[active_slide].entities[k].container&&selected_entities.push(room_data.slides[active_slide].entities[k]);select_entities();undo_list.push(clone_action(["select",selected_entities,previously_selected_entities]))}
function remove_select_box(){limit_rate(15,select_box_move_state,function(){});select_box&&(select_box.mousedown=void 0,select_box.mousemove=void 0,select_box.mouseup=void 0,select_box.mouseout=void 0,select_box.mouseover=void 0,select_box.mouseupoutside=void 0,objectContainer.mousedown=on_left_click,objectContainer.removeChild(select_box),objectContainer.removeChild(rotate_arrow0),objectContainer.removeChild(rotate_arrow1),objectContainer.removeChild(rotate_arrow2),objectContainer.removeChild(rotate_arrow3),
select_box=void 0,render_scene());$("html,body").css("cursor","default")}function deselect_all(){remove_select_box();previously_selected_entities=selected_entities;for(var k in selected_entities)selected_entities[k].container.filters=void 0,selected_entities[k].container.alpha=selected_entities[k].alpha;selected_entities=[]}var INTERPOLATION_RESOLUTION=25,INTERPOLATION_TENSION=.5,INTERPOLATION_LOOKBACK=10;
function smooth_draw(k,a,c,f){a=getCurvePoints(a,INTERPOLATION_TENSION,INTERPOLATION_RESOLUTION,c);k.beginPath();k.moveTo(a[0]*f,a[1]*f);for(c=2;c<a.length;c+=2)k.lineTo(a[c]*f,a[c+1]*f);k.stroke();k=a[a.length-2]-a[a.length-20];f=a[a.length-1]-a[a.length-19];c=Math.sqrt(Math.pow(k,2)+Math.pow(f,2));return[[a[a.length-2]-k/c,a[a.length-1]-f/c],[a[a.length-2],a[a.length-1]]]}var draw_state={},point_buffer=[];
function on_draw_move(k){limit_rate(15,draw_state,function(){var a=mouse_loc(),c=last_point[0]*MOUSE_DRAW_SMOOTHING+(1-MOUSE_DRAW_SMOOTHING)*a.x,f=last_point[1]*MOUSE_DRAW_SMOOTHING+(1-MOUSE_DRAW_SMOOTHING)*a.y;new_drawing.path.push([from_x_local(c)-new_drawing.x,from_y_local(f)-new_drawing.y]);temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);point_buffer.push(c,f,a.x,a.y);smooth_draw(temp_draw_context,point_buffer,!1,DRAW_QUALITY);point_buffer.pop();
point_buffer.pop();new_drawing.path.push([from_x_local(a.x)-new_drawing.x,from_y_local(a.y)-new_drawing.y]);draw_end_path(temp_draw_context,new_drawing);new_drawing.path.pop();last_point=[c,f]})}
function on_draw_end(k){limit_rate(15,draw_state,function(){});k=mouse_loc();new_drawing.path.push([from_x_local(k.x)-new_drawing.x,from_y_local(k.y)-new_drawing.y]);create_drawing2(new_drawing,DRAW_QUALITY);emit_entity(new_drawing);undo_list.push(clone_action(["add",[new_drawing]]));temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);temp_draw_context.beginPath();setup_mouse_events(void 0,void 0);new_drawing=null}
function drawRotatedImage(k,a,c){k.save();k.translate(a.width/2,a.height/2);k.rotate(c);k.translate(-(a.width/2),-(a.height/2));k.drawImage(a,0,0);k.restore()}function draw_end_path(k,a){if(a.path.length>=ARROW_LOOKBACK){var c=Math.max(0,a.path.length-ARROW_LOOKBACK),c=[to_x_local(a.x+a.path[c][0]),to_y_local(a.y+a.path[c][1])],f=[to_x_local(a.x+a.path[a.path.length-1][0]),to_y_local(a.y+a.path[a.path.length-1][1])];draw_end(k,a,c,f,1/zoom_level,DRAW_QUALITY)}}
function draw_end(k,a,c,f,h,n){var m=size_y/1E3*10*h;a.end_size&&(m=size_y/1E3*a.end_size*h);k.stroke();k.beginPath();"arrow"==a.end?draw_arrow(k,c,f,m,n):"T"==a.end&&draw_T(k,c,f,m,n)}function draw_arrow(k,a,c,f,h){var n=c[0]-a[0];a=c[1]-a[1];l=Math.sqrt(Math.pow(n,2)+Math.pow(a,2));n/=l;a/=l;drawArrow(k,c[0],c[1],c[0]+n,c[1]+a,3,1,Math.PI/8,f*ARROW_SCALE2,h)}
function draw_T(k,a,c,f,h){f*=TEND_SCALE2;var n=c[0]-a[0];a=c[1]-a[1];l=Math.sqrt(Math.pow(n,2)+Math.pow(a,2));n/=l;a/=l;a=-a;k.stroke();var m=k.getLineDash();k.setLineDash([]);k.beginPath();k.moveTo((c[0]-f*a)*h,(c[1]-f*n)*h);k.lineTo((c[0]+f*a)*h,(c[1]+f*n)*h);k.stroke();k.setLineDash(m)}function init_shape_canvas(k,a,c,f){void 0===c&&(c=1);init_canvas(k,a.outline_thickness*c,a.outline_color,a.style,a.fill_opacity,a.fill_color,a.outline_opacity,[10*f,10*f])}
function canvas2container2(k,a,c,f,h){k=PIXI.Texture.fromCanvas(a);k=new PIXI.Sprite(k);h.container=k;k.texture.baseTexture.source.src=h.uid;k.hitArea=new PIXI.TransparencyHitArea.create(k,!1);init_dragging(k);k.entity=h;room_data.slides[active_slide].entities[h.uid]=h;return!0}
function draw_entity(k,a,c,f,h){("00000"+(k.color|0).toString(16)).substr(-6);var n=background_sprite.height;k.draw_zoom_level&&(a/=k.draw_zoom_level);c*=background_sprite.height/renderer.view.height*a;f=20+f*c;var m=[];if(0<k.path.length){for(var g=9999,d=9999,e=-9999,b=-9999,p=0;p<k.path.length;p++){var r=k.path[p][0],q=k.path[p][1],g=Math.min(g,r),d=Math.min(d,q),e=Math.max(e,r),b=Math.max(b,q);m.push(n*r*a,n*q*a)}if("curve"==k.type||"area"==k.type)f+=Math.max(e-g,b-d)*n*a*.3;e=Math.ceil(n*(e-
g)*a+f);b=Math.ceil(n*(b-d)*a+f);r=document.createElement("canvas");r.width=e;r.height=b;for(var q=r.getContext("2d"),y=-g*n*a+f/2,n=-d*n*a+f/2,p=0;p<m.length;p+=2)m[p]+=y,m[p+1]+=n;h(q,m,a,c);canvas2container2(q,r,e,b,k);k.container.height/=a;k.container.width/=a;k.container.x=x_abs(k.x)+x_abs(g)-f/2/a;k.container.y=y_abs(k.y)+y_abs(d)-f/2/a;k.container.orig_scale=[k.container.scale.x,k.container.scale.y];objectContainer.addChild(k.container);render_scene()}}
function create_drawing2(k,a,c){a||(a=1);c||(c=1);var f=k.thickness;k.end_size&&(f=2*k.end_size);draw_entity(k,a,c,f,function(a,c,f,g){init_canvas_simple(a,k.thickness*g,k.color,k.style,[10*f,10*f]);f=smooth_draw(a,c,!1,1);if(k.end){if(k.path.length>=ARROW_LOOKBACK){var d=Math.max(0,k.path.length-ARROW_LOOKBACK);f[0]=[c[2*d],c[2*d+1]]}draw_end(a,k,f[0],f[1],g,1)}})}
function create_curve2(k,a,c){a||(a=1);c||(c=1);var f=k.thickness;k.end_size&&(f=2*k.end_size);draw_entity(k,a,c,f,function(a,c,f,g){init_canvas_simple(a,k.thickness*g,k.color,k.style,[10*f,10*f]);c=smooth_draw(a,c,!1,1);k.end&&draw_end(a,k,c[0],c[1],g,1)})}
function create_line2(k,a,c){a||(a=1);c||(c=1);var f=k.thickness;k.end_size&&(f=2*k.end_size);draw_entity(k,a,c,f,function(a,c,f,g){init_canvas_simple(a,k.thickness*g,k.color,k.style,[10*f,10*f]);a.moveTo(c[0],c[1]);for(f=2;f<c.length;f+=2)a.lineTo(c[f],c[f+1]);a.stroke();draw_end(a,k,[c[c.length-4],c[c.length-3]],[c[c.length-2],c[c.length-1]],g,1)})}
function create_area2(k,a,c){a||(a=1);c||(c=1);var f=k.outline_thickness;k.path[k.path.length-1]==[0,0]&&k.path.pop();draw_entity(k,a,c,f,function(a,c,f,g){init_shape_canvas(a,k,g,f);smooth_draw(a,c,!0,1);a.fill()})}function create_polygon2(k,a,c){a||(a=1);c||(c=1);draw_entity(k,a,c,k.outline_thickness,function(a,c,n,m){init_shape_canvas(a,k,m,n);a.moveTo(c[0],c[1]);for(n=2;n<c.length;n+=2)a.lineTo(c[n],c[n+1]);a.lineTo(c[0],c[1]);a.stroke();a.fill()})}
function create_rectangle2(k,a,c){a||(a=1);c||(c=1);var f=k.outline_thickness,h=background_sprite.height;k.draw_zoom_level&&(a/=k.draw_zoom_level);c*=background_sprite.height/renderer.view.height*a;var f=20+f*c,n=Math.ceil(h*k.width*a+f),m=Math.ceil(h*k.height*a+f),g=document.createElement("canvas");g.width=n;g.height=m;var d=g.getContext("2d");init_shape_canvas(d,k,c,a);d.fillRect(f/2,f/2,h*k.width*a,h*k.height*a);d.strokeRect(f/2,f/2,h*k.width*a,h*k.height*a);canvas2container2(d,g,n,m,k);k.container.x=
x_abs(k.x)-f/2/a;k.container.y=y_abs(k.y)-f/2/a;k.container.width/=a;k.container.height/=a;k.container.orig_scale=[k.container.scale.x,k.container.scale.y];objectContainer.addChild(k.container);render_scene()}
function create_circle2(k,a,c){a||(a=1);c||(c=1);var f=k.outline_thickness,h=background_sprite.height;k.draw_zoom_level&&(a/=k.draw_zoom_level);var n=background_sprite.height/renderer.view.height*a*c,f=20+f*n;c=Math.ceil(2*h*k.radius*a+f);var m=Math.ceil(2*h*k.radius*a+f),g=document.createElement("canvas");g.width=c;g.height=m;var d=g.getContext("2d");init_shape_canvas(d,k,n,a);to_x_local_vect(k.radius);var e=h*k.radius*a+f/2;d.beginPath();d.arc(e,e,h*k.radius*a,0,2*Math.PI);d.fill();d.stroke();if(k.draw_radius){d.save();
d.lineWidth=size_y/1E3*2;d.strokeStyle="#FFFFFF";d.fillStyle="#FFFFFF";d.beginPath();d.moveTo(e,e);d.lineTo(e+h*a*k.draw_radius[0],e+h*a*k.draw_radius[1]);d.stroke();n=e+h*a*k.draw_radius[0]/2;e+=h*a*k.draw_radius[1]/2;d.font="33px Arial";var b=Math.sqrt(Math.pow(background.size_x*k.draw_radius[0],2)+Math.pow(background.size_y*k.draw_radius[1],2));d.lineWidth=to_y_local(.5)/1E3;d.strokeStyle="#000000";d.fillStyle="#FFFFFF";var p="",p="lol"==game?p+(Math.round(10*b)/10+"u"):"wows"==game?p+(Math.round(.01*
b)/10+"km"):p+(Math.round(10*b)/10+"m");d.fillText(p,n,e);d.restore()}canvas2container2(d,g,c,m,k);k.container.x=x_abs(k.x)-h*k.radius-f/2/a;k.container.y=y_abs(k.y)-h*k.radius-f/2/a;k.container.width/=a;k.container.height/=a;k.container.orig_scale=[k.container.scale.x,k.container.scale.y];objectContainer.addChild(k.container);render_scene()}
function start_drawing(){draw_context.clearRect(0,0,draw_canvas.width*DRAW_QUALITY,draw_canvas.height*DRAW_QUALITY);temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);"setLineDash"in temp_draw_context&&temp_draw_context.setLineDash([]);"setLineDash"in draw_context&&draw_context.setLineDash([]);$(temp_draw_canvas).show();$(draw_canvas).show()}function stop_drawing(){$(temp_draw_canvas).hide();$(draw_canvas).hide()}
function snap_and_emit_entity(k){move_entity(k,0,0);emit_entity(k);render_scene()}function update_timeline(k){if(k.start_time){for(var a=k.start_time;timeline_entities[a];)a+=EPSILON;timeline.add(a);timeline_entities[a]=k;for(a=k.end_time;timeline_entities[a];)a+=EPSILON;timeline.add(a);timeline_entities[a]=k}}
function rebuild_timeline(k){timeline=new FastPriorityQueue;timeline_entities={};for(var a in room_data.slides[active_slide].entities)room_data.slides[active_slide].entities.hasOwnProperty(a)&&room_data.slides[active_slide].entities[a].container&&(update_timeline(room_data.slides[active_slide].entities[a]),remove(a,!0))}
function progress_timeline(){if(!timeline.isEmpty())for(var k=video_progress(),a=timeline.peek();k>=a;){a=timeline_entities[a];video_progress()>=a.end_time?a.container&&remove(a.uid,!0):a.start_time<=k&&(a.container||create_entity(a));timeline.poll();if(timeline.isEmpty())break;a=timeline.peek()}}
function emit_entity(k){var a=k.container;background.is_video&&(k.start_time=video_progress(),k.end_time=video_progress()+delay,update_timeline(k));k.container=void 0;socket.emit("create_entity",room,k,active_slide);room_data.slides[active_slide].z_top++;k.z_index=room_data.slides[active_slide].z_top;k.container=a;set_anchor(k.container,.5,.5);render_scene()}
function on_icon_end(k){setup_mouse_events(void 0,void 0);var a=k.data.getLocalPosition(background_sprite);k=icon_color;selected_icon_no_color&&(k=16777215);var c=icon_size*icon_extra_scale*ICON_SCALE,c=c*zoom_level,f=mouse_x_rel(a.x)-c/2,a=mouse_y_rel(a.y)-c/2;k={uid:newUid(),type:"icon",tank:selected_icon,x:f,y:a,size:c,color:k,alpha:1,label:$("#icon_label").val(),label_font_size:label_font_size*zoom_level,label_color:"#ffffff",label_font:"Arial",label_pos:label_position,label_background:$("#label_background").get(0).checked,
draw_zoom_level:zoom_level};k.label_background&&(k.label_color="#000000");undo_list.push(clone_action(["add",[k]]));create_icon(k,snap_and_emit_entity)}
function on_text_end(k){var a=$("#text_tool_text").val();setup_mouse_events(void 0,void 0);if(""!=a){var c=k.data.getLocalPosition(background_sprite);k=mouse_x_rel(c.x);c=mouse_y_rel(c.y);a={uid:newUid(),type:"text",x:k,y:c,scale:[1,1],color:text_color,alpha:1,text:a,font_size:font_size*zoom_level,font:"Arial",draw_zoom_level:zoom_level};undo_list.push(clone_action(["add",[a]]));current_text_element=a;create_text2(a);snap_and_emit_entity(a)}}
function on_background_text_end(k){setup_mouse_events(void 0,void 0);var a=k.data.getLocalPosition(background_sprite);k=mouse_x_rel(a.x);a=mouse_y_rel(a.y);k={uid:newUid(),type:"background_text",x:k,y:a,scale:[1,1],color:background_text_color,alpha:1,text:$("#text_tool_background_text").val(),font_size:background_font_size*zoom_level,font:"Arial",draw_zoom_level:zoom_level};undo_list.push(clone_action(["add",[k]]));create_background_text2(k);snap_and_emit_entity(k)}var line_state={};
function on_line_move(k){limit_rate(15,line_state,function(){var a=k.data.getLocalPosition(background_sprite),c;c=0==new_drawing.path.length?[to_x_local(new_drawing.x),to_y_local(new_drawing.y)]:[to_x_local(new_drawing.path[new_drawing.path.length-1][0]+new_drawing.x),to_y_local(new_drawing.path[new_drawing.path.length-1][1]+new_drawing.y)];a=[to_x_local(mouse_x_rel(a.x)),to_y_local(mouse_y_rel(a.y))];temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);
temp_draw_context.beginPath();temp_draw_context.moveTo(c[0]*DRAW_QUALITY,c[1]*DRAW_QUALITY);temp_draw_context.lineTo(a[0]*DRAW_QUALITY,a[1]*DRAW_QUALITY);temp_draw_context.stroke();draw_end(temp_draw_context,new_drawing,c,a,1/zoom_level,DRAW_QUALITY)})}
function on_line_end(k){limit_rate(15,line_state,function(){});try{var a=mouse_loc(),c=from_x_local(a.x)-new_drawing.x,f=from_y_local(a.y)-new_drawing.y;0!=new_drawing.path.length&&c==last(new_drawing.path)[0]&&f==last(new_drawing.path)[1]||new_drawing.path.push([c,f]);shifted?(temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY),draw_context.clearRect(0,0,draw_canvas.width*DRAW_QUALITY,draw_canvas.height*DRAW_QUALITY),draw_context.lineTo(a.x*DRAW_QUALITY,
a.y*DRAW_QUALITY),draw_context.stroke()):(create_line2(new_drawing,DRAW_QUALITY),emit_entity(new_drawing),undo_list.push(clone_action(["add",[new_drawing]])),setup_mouse_events(void 0,void 0),stop_drawing(),new_drawing=null)}catch(h){}render_scene()}
function create_text_sprite(k,a,c,f,h,n,m){void 0===m&&(m="");var g=document.createElement("canvas"),d=objectContainer.scale.y,e=g.getContext("2d"),b=TEXT_QUALITY;e.font=m+" "+Math.round(2*c*d*b)+"px "+f;e.textBaseline="top";for(var p=e.measureText(k);p.width>MAX_CANVAS_SIZE;)b/=2,e.font=m+" "+Math.round(2*c*d*b)+"px "+f,p=e.measureText(k);p=e.measureText(k);g.height=c*d*b*2.7;h?(g.width=p.width+.2*g.height,e.fillStyle="#ffffff",e.lineWidth=.1*g.height,e.fillRect(0,0,p.width+.2*g.height,g.height),
e.strokeRect(0,0,p.width+.2*g.height,g.height)):g.width=p.width;e.fillStyle=a;e.font=m+" "+Math.round(2*c*d*b)+"px "+f;e.textBaseline="top";n&&(e.shadowColor="black",e.shadowOffsetX=b,e.shadowOffsetY=b,e.shadowBlur=5);h?e.fillText(k,.1*g.height,.1*g.height):e.fillText(k,0,0);k=PIXI.Texture.fromCanvas(g);k=new PIXI.Sprite(k);a=k.width/k.height;k.height=Math.round(2*c*d)/objectContainer.scale.x;k.width=k.height*a;k.x=0;k.y=0;return k}
function create_text2(k){var a="#"+("00000"+(k.color|0).toString(16)).substr(-6),a=create_text_sprite(k.text,a,TEXT_SCALE*k.font_size,k.font,!1,!0),c=a.width/a.height;a.height=x_abs(k.font_size/390);a.width=a.height*c;a&&(k.container=a,a.x=x_abs(k.x),a.y=y_abs(k.y),objectContainer.addChild(a),a.texture.baseTexture.source.src=k.uid,init_dragging(a),a.entity=k,room_data.slides[active_slide].entities[k.uid]=k,render_scene())}
function create_background_text2(k){var a="#"+("00000"+(k.color|0).toString(16)).substr(-6),a=create_text_sprite(k.text,a,BACKGROUND_TEXT_SCALE*k.font_size,k.font,!0,!1),c=a.width/a.height;a.height=x_abs(k.font_size/420);a.width=a.height*c;a&&(k.container=a,a.x=x_abs(k.x),a.y=y_abs(k.y),objectContainer.addChild(a),a.texture.baseTexture.source.src=k.uid,init_dragging(a),a.entity=k,room_data.slides[active_slide].entities[k.uid]=k,render_scene())}
function nearestPow2(k){return Math.pow(2,Math.round(Math.log(k)/Math.log(2)))}
function create_icon_cont(k,a){var c=new PIXI.Sprite(a);c.tint=k.color;var f=c.width/c.height;k.container=c;k.container.x=x_abs(k.x);k.container.y=y_abs(k.y);c.height=x_abs(k.size);c.width=c.height*f;set_anchor(c,.5,.5);if(k.label&&""!=k.label){var h=create_text_sprite(k.label,k.label_color,ICON_LABEL_SCALE*k.label_font_size,k.label_font,k.label_background,!k.label_background,k.label_font_modifier),n=k.label_pos;n||(n="pos_bottom");k.container.addChild(h);var m;m=k.label_background?450:470;f=h.width/
h.height;h.height=x_abs(k.label_font_size/m)/k.container.scale.y;h.width=h.height*f;f=c.width/c.scale.x;c=c.height/c.scale.y;"pos_bottom"==n?(h.x-=h.width/2,h.y+=c/2):"pos_top"==n?(h.x-=h.width/2,h.y-=h.height+c/2):"pos_left"==n?(h.x-=h.width+f/2,h.y-=h.height/2):"pos_right"==n?(h.x+=f/2,h.y-=h.height/2):"pos_top_left"==n?(h.x-=h.width+f/2,h.y-=c/2+h.height/2):"pos_top_right"==n?(h.x+=f/2,h.y-=c/2+h.height/2):"pos_bottom_left"==n?h.x-=h.width+f/2:"pos_bottom_right"==n&&(h.x+=f/2)}k.container.entity=
k;k.container.alpha=k.alpha;init_dragging(k.container);objectContainer.addChild(k.container);render_scene();room_data.slides[active_slide].entities[k.uid]=k}
function create_icon(k,a){try{var c=$('button[id*="'+k.tank+'"]').find("span");c[0].innerHTML=parseInt(c[0].innerHTML)+1;c=$("#icon_counter");c.text((parseInt(c.text())+1).toString())}catch(m){}var c=k.tank,f=k.tank.slice(-3);"png"!=f&&"jpg"!=f&&(c+=".png");var h;texture_atlas[c]&&!is_safari()?(c=texture_atlas[c],h=new PIXI.Texture(loader.resources[c.sprite].texture,new PIXI.Rectangle(c.x,c.y,c.width,c.height))):h=PIXI.Texture.fromImage(image_host+c);resources_loading++;var n=function(){create_icon_cont(k,
h);a&&a(k);resources_loading--};if(h.baseTexture.hasLoaded)n();else h.baseTexture.on("loaded",function(){n()})}function init_dragging(k){dragging_enabled?make_draggable(k):make_undraggable(k);k.orig_scale=[k.scale.x,k.scale.y]}function make_draggable(k){k.interactive=!0;k.buttonMode=!0;k.draggable=!0;k.mousedown=on_drag_start;k.touchstart=on_drag_start}function make_undraggable(k){k.interactive=!1;k.buttonMode=!1;k.draggable=!1;delete k.mousedown;delete k.touchstart}
function set_anchor(k,a,c){var f=a-k.anchor.x,h=c-k.anchor.y;k.anchor.x=a;k.anchor.y=c;k.x+=f*k.width;k.y+=h*k.height}
function create_entity(k){room_data.slides[active_slide].entities[k.uid]&&remove(k.uid);"background"==k.type?set_background(k):"icon"==k.type?create_icon(k):"drawing"==k.type?create_drawing2(k,DRAW_QUALITY):"curve"==k.type?create_curve2(k,DRAW_QUALITY):"line"==k.type?create_line2(k,DRAW_QUALITY):"text"==k.type?create_text2(k):"background_text"==k.type?create_background_text2(k):"note"==k.type?create_note(k):"rectangle"==k.type?create_rectangle2(k,DRAW_QUALITY):"circle"==k.type?create_circle2(k,DRAW_QUALITY):
"polygon"==k.type?create_polygon2(k,DRAW_QUALITY):"area"==k.type&&create_area2(k,DRAW_QUALITY);k.container&&(k.scale&&(k.container.scale.x=k.container.orig_scale[0]*k.scale[0],k.container.scale.y=k.container.orig_scale[1]*k.scale[1]),k.container.anchor&&set_anchor(k.container,.5,.5),k.rotation&&(k.container.rotation=-k.rotation),adjust_zoom(k),background.is_video&&update_timeline(k))}
function update_username(k){""!=k&&k!=my_user.name&&(my_user.name=k,socket.emit("update_user",room,my_user));k=$("#"+my_user.id).find("input");k.attr("placeholder",my_user.name);k.val("")}
function add_user(k){my_user_id==k.id&&(my_user=k);if(k.id in userlist){var a=$("#"+k.id);k.id==my_user_id?a.find("input").attr("placeholder",k.name):a.text(k.name)}else k.id==my_user_id?(a="<div class='btn' style='text-align:left;' id='"+k.id+"'><input maxlength='30' type='text' placeholder='"+escapeHtml(k.name)+"'></div>",$("#userlist").prepend(a),a=$("#userlist").find("input"),a.on("blur",function(){update_username(this.value)}),a.onkeypress=function(a){a||(a=window.event);keyCode=a.keyCode||a.which;
"13"==keyCode&&update_username(this.value)}):(a="<button class='btn' style='text-align:left;' data-toggle='tooltip' title='Click to toggle this user&#39;s permission.' id='"+k.id+"'>"+escapeHtml(k.name)+"</button>",$("#userlist").append(a));userlist[k.id]=k;k.role?"owner"==k.role?$("#"+k.id).css("background-color","lime"):"driver"==k.role&&$("#"+k.id).css("background-color","yellow"):$("#"+k.id).css("background-color","#EEEEEE");k.id==my_user_id&&update_my_user();$("#user_count").text(Object.keys(userlist).length.toString())}
function update_my_user(){my_user.logged_in?($("#store_tactic_popover").show(),tactic_name&&""!=tactic_name&&$("#save").show(),$("#sign_in_text").text(my_user.name.substring(0,9)),$("#login_dropdown").removeClass("btn-warning"),$("#login_dropdown").addClass("btn-success")):($("#store_tactic_popover").hide(),$("#save").hide());update_lock()}
function update_lock(){var k=$("#lock div");is_room_locked?k.removeClass("icon-unlock").addClass("icon-lock"):k.removeClass("icon-lock").addClass("icon-unlock");if(is_room_locked&&!my_user.role){$(".mejs-controls").hide();$(".left_column").hide();$("#slide_interactive").hide();$("#slide_static").show();$("#slide_table1").hide();$("#can_not_edit").show();$("#map_select_box").hide();for(var a in room_data.slides[active_slide].entities)room_data.slides[active_slide].entities[a]&&"note"==room_data.slides[active_slide].entities[a].type&&
room_data.slides[active_slide].entities[a].container&&($("textarea",room_data.slides[active_slide].entities[a].container.menu).prop("readonly",!0),$("button",room_data.slides[active_slide].entities[a].container.menu).hide());my_tracker&&stop_tracking();"ping_context"==active_context&&(objectContainer.mousemove=void 0)}else for(a in $(".mejs-controls").show(),$(".left_column").show(),$("#slide_interactive").show(),$("#slide_static").hide(),$("#slide_table1").show(),$("#can_not_edit").hide(),$("#map_select_box").show(),
room_data.slides[active_slide].entities)room_data.slides[active_slide].entities[a]&&"note"==room_data.slides[active_slide].entities[a].type&&room_data.slides[active_slide].entities[a].container&&($("textarea",room_data.slides[active_slide].entities[a].container.menu).prop("readonly",!1),$("button",room_data.slides[active_slide].entities[a].container.menu).show());"owner"!=my_user.role&&is_room_locked?($("#store_tactic_popover").hide(),$("#save").hide(),$("#export_tab_button").hide()):(my_user.logged_in?
($("#store_tactic_popover").show(),tactic_name&&""!=tactic_name&&$("#save").show()):($("#store_tactic_popover").hide(),$("#save").hide()),$("#export_tab_button").show());"owner"==my_user.role?($("#lock").show(),$("#nuke_room").show(),$("#lock_camera").show()):($("#lock").hide(),$("#nuke_room").hide(),$("#lock_camera").hide())}function remove_user(k){$("#"+k).remove();delete userlist[k];$("#user_count").text(Object.keys(userlist).length.toString())}
function escapeHtml(k){return k&&"string"==typeof k?k.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):""}function chat(k,a){k=escapeHtml(k);k=k.split(":");$("#chat_box").append('<div class="chatmsg"><b style="color:'+a+';">'+k[0]+"</b>: "+k.slice(1).join(":")+"<br/></div>");$("#chat_box").scrollTop($("#chat_box")[0].scrollHeight)}
function supports_color_input(){var k=document.createElement("input"),a,c=document.documentElement;k.setAttribute("type","color");if(a="text"!==k.type)k.value=":)",k.style.cssText="position:absolute;visibility:hidden;",c.appendChild(k),c.offsetWidth,a=":)"!=k.value,c.removeChild(k);return a}
function initialize_color_picker(k,a){var c=$('select[id="'+k+'"]').val();window[a]=parseInt("0x"+c.substring(1));$("#"+k+" ~ input").attr("value",c);$("#"+k+" ~ input").val(c);$("#"+k+" ~ input").on("change",function(){var c=$(this).val();window[a]=parseInt("0x"+c.substring(1));$("#"+k+'~ span span[data-selected=""]').removeAttr("data-selected")});$('select[id="'+k+'"]').simplecolorpicker().on("change",function(){var c=$('select[id="'+k+'"]').val();window[a]=parseInt("0x"+c.substring(1));$("#"+k+
" ~ input").first().val(c);"track_color"==a&&(my_tracker&&stop_tracking(),start_tracking({x:2E3,y:2E3}))})}
function initialize_slider(k,a,c){var f=$("#"+k);$("#"+a).val(f.attr("value"));window[c]=parseFloat(f.attr("value"));f.on("change",function(f){$("#"+a).val(this.value);window[c]=parseFloat(this.value)});f.on("input",function(f){$("#"+a).val(this.value);window[c]=parseFloat(this.value)});$("#"+a).change(function(){var a=parseFloat(this.value);isNaN(a)?this.value=window[c]:(window[c]=a,f.slider("setValue",window[c]))})}
function clear(k){var a=[],c;for(c in room_data.slides[active_slide].entities)if(room_data.slides[active_slide].entities.hasOwnProperty(c)&&(room_data.slides[active_slide].entities[c].type==k||!k)&&"background"!=room_data.slides[active_slide].entities[c].type){var f=room_data.slides[active_slide].entities[c];remove(c);a.push(f);socket.emit("remove",room,c,active_slide)}undo_list.push(clone_action(["remove",a]))}
function clone_action(k){if(k[1].length){temp_containers=[];for(var a=0;a<k[1].length;a++)temp_containers.push(k[1][a].container),k[1][a].container=null}var c=JSON.stringify(k);if(k[1].length)for(a=0;a<k[1].length;a++)k[1][a].container=temp_containers[a];return JSON.parse(c)}
function undo(){var k=undo_list.pop();if(k)if("add"==k[0]){for(var a in k[1])k[1][a].uid&&(remove(k[1][a].uid),delete k[1][a].container,socket.emit("remove",room,k[1][a].uid,active_slide));redo_list.push(clone_action(k))}else if("drag"==k[0]){for(a in k[1]){var c=k[1][a][0][0],f=k[1][a][0][1],h=k[1][a][0][2],n=k[1][a][0][3],m=k[1][a][1];room_data.slides[active_slide].entities[m]&&(k[1][a][0][0]=room_data.slides[active_slide].entities[m].x,k[1][a][0][1]=room_data.slides[active_slide].entities[m].y,
k[1][a][0][2]=room_data.slides[active_slide].entities[m].scale?[room_data.slides[active_slide].entities[m].scale[0],room_data.slides[active_slide].entities[m].scale[1]]:[1,1],"undefined"!==typeof room_data.slides[active_slide].entities[m].rotation&&(k[1][a][0][3]=room_data.slides[active_slide].entities[m].rotation),drag_entity(room_data.slides[active_slide].entities[m],c,f,h,n),socket.emit("drag",room,m,active_slide,c,f,h,n))}redo_list.push(clone_action(k))}else if("remove"==k[0]){for(a in k[1])c=
k[1][a],delete c.container,socket.emit("create_entity",room,c,active_slide),create_entity(c);redo_list.push(clone_action(k))}else if("select"==k[0]){f=[];for(a in k[2])c=k[2][a],room_data.slides[active_slide].entities.hasOwnProperty(c.uid)&&f.push(c);deselect_all();selected_entities=f;select_entities();redo_list.push(clone_action(k))}render_scene()}
function redo(){var k=redo_list.pop();if(k){if("add"==k[0]){for(var a in k[1])k[1][a].uid&&(socket.emit("create_entity",room,k[1][a],active_slide),create_entity(k[1][a]));undo_list.push(clone_action(k))}else if("drag"==k[0]){for(a in k[1]){var c=k[1][a][0][0],f=k[1][a][0][1],h=k[1][a][0][2],n=k[1][a][0][3],m=k[1][a][1];room_data.slides[active_slide].entities[m]&&(k[1][a][0][0]=room_data.slides[active_slide].entities[m].x,k[1][a][0][1]=room_data.slides[active_slide].entities[m].y,k[1][a][0][2]=room_data.slides[active_slide].entities[m].scale?
[room_data.slides[active_slide].entities[m].scale[0],room_data.slides[active_slide].entities[m].scale[1]]:[1,1],"undefined"!==typeof room_data.slides[active_slide].entities[m].rotation&&(k[1][a][0][3]=room_data.slides[active_slide].entities[m].rotation),drag_entity(room_data.slides[active_slide].entities[m],c,f,h,n),socket.emit("drag",room,m,active_slide,c,f,h,n))}undo_list.push(clone_action(k))}else if("remove"==k[0]){for(a in k[1])c=k[1][a],room_data.slides[active_slide].entities.hasOwnProperty(c.uid)&&
(remove(c.uid),delete c.container,socket.emit("remove",room,c.uid,active_slide));undo_list.push(clone_action(k))}else if("select"==k[0]){f=[];for(a in k[1])c=k[1][a],room_data.slides[active_slide].entities.hasOwnProperty(c.uid)&&f.push(c);deselect_all();selected_entities=f;select_entities();undo_list.push(clone_action(k))}render_scene()}}
function clear_selected(){remove_select_box();var k=selected_entities.slice(0),a=[],c;for(c in k){var f=k[c];remove(k[c].uid);a.push(f);socket.emit("remove",room,f.uid,active_slide)}deselect_all();selected_entities=[];undo_list.push(clone_action(["remove",a]));"drag_context"==active_context&&cancel_drag(!0)}
function drag_entity(k,a,c,f,h){if(k.container){k.container.x+=x_abs(a-k.x);k.container.y+=y_abs(c-k.y);k.x=a;k.y=c;k.scale=f;"undefined"!==typeof h&&null!=h&&(k.rotation=h,k.container.rotation=-h);"note"==k.type&&align_note_text(k);k.container&&(objectContainer.removeChild(k.container),objectContainer.addChild(k.container),f&&(k.container.scale.x=k.container.orig_scale[0]*f[0],k.container.scale.y=k.container.orig_scale[1]*f[1]));select_box_dirty=!1;for(var n in selected_entities)selected_entities[n].uid==
k.uid&&(select_box_dirty=!0);render_scene()}}function find_first_slide(){var k=Math.pow(2,52),a=0,c;for(c in room_data.slides){var f=room_data.slides[c].order;f<k&&(k=f,a=c)}return a}function find_previous_slide(k){var a=-9007199254740990,c=0,f;for(f in room_data.slides){var h=room_data.slides[f].order;h<k&&h>a&&(a=h,c=f)}return c}function find_next_slide(k){var a=9007199254740991,c=0,f;for(f in room_data.slides){var h=room_data.slides[f].order;h>k&&h<a&&(a=h,c=f)}return c}
function hash(k){for(var a=0,c=0;c<k.length;c++)a+=k.charCodeAt(c);return a}function resolve_order_conflicts(k){for(var a in room_data.slides)if(room_data.slides[a].order==k.order){if(hash(k.uid)<hash(a)){a=find_previous_slide(k.order);var c=0;0!=a&&(c=room_data.slides[a].order);k.order=Math.floor((k.order-c)/2)}else a=find_next_slide(k.order),c=k.order+4294967296,0!=a&&(c=room_data.slides[a].order),k.order=Math.floor((c-k.order)/2);resolve_order_conflicts(k);break}}
function update_slide_buttons(){var k=find_previous_slide(room_data.slides[active_slide].order),a=find_next_slide(room_data.slides[active_slide].order);0==k?document.getElementById("prev_slide").disabled=!0:document.getElementById("prev_slide").disabled=!1;0==a?document.getElementById("next_slide").disabled=!0:document.getElementById("next_slide").disabled=!1;1==Object.keys(room_data.slides).length?document.getElementById("remove_slide").disabled=!0:document.getElementById("remove_slide").disabled=
!1;grid_layer.visible=room_data.slides[active_slide].show_grid?!0:!1;k=escapeHtml(room_data.slides[active_slide].name);$("#slide_name_field").val(k);$("#slide_name_field2").val(k);var a=find_first_slide(),c=$("#slide_table");c.empty();do k=escapeHtml(room_data.slides[a].name),a==active_slide?c.append("<tr id='"+a+"' style='background-color:#ADD8E6'><td><a id='"+a+"'>"+k+"</a></td></tr>"):c.append("<tr id='"+a+"'><td><a id='"+a+"'>"+k+"</a></td></tr>"),a=find_next_slide(room_data.slides[a].order);
while(0!=a);var f=$("#slide_container").scrollTop();setTimeout(function(){$("#slide_container").scrollTop(f)},0)}
function transition(k){var a=[],c=[],f=[],h;for(h in room_data.slides[active_slide].entities)room_data.slides[k].entities[h]?f.push(h):a.push(h);for(h in room_data.slides[k].entities)room_data.slides[active_slide].entities.hasOwnProperty(h)||c.push(h);for(var n in a)h=a[n],remove(h,!0);var m;for(n in f)h=f[n],"background"==room_data.slides[k].entities[h].type?m=h:(remove(h,!0),c.push(h));active_slide=k;update_slide_buttons();var g=function(){try{c.sort(function(a,b){return room_data.slides[k].entities[a].z_index-
room_data.slides[k].entities[b].z_index})}catch(e){}for(var a in c)create_entity(room_data.slides[k].entities[c[a]])};m?set_background(room_data.slides[k].entities[m],function(){g();render_scene()}):(g(),render_scene())}
function cancel_drag(k){clearTimeout(drag_timeout);objectContainer.buttonMode=!1;context_before_drag&&(active_context=context_before_drag);context_before_drag=null;if(dragged_entity){dragged_entity.mouseup=void 0;dragged_entity.touchend=void 0;dragged_entity.mouseupoutside=void 0;dragged_entity.touchendoutside=void 0;dragged_entity.mousemove=void 0;dragged_entity.touchmove=void 0;if(k)if(move_selected&&0<selected_entities.length)for(var a in selected_entities)drag_entity(selected_entities[a],selected_entities[a].origin_x,
selected_entities[a].origin_y);else drag_entity(dragged_entity.entity,dragged_entity.entity.origin_x,dragged_entity.entity.origin_y);dragged_entity==select_box&&(make_resizable(select_box),on_select_over.bind(select_box)(),on_selectbox_move.bind(select_box)())}dragged_entity=null;move_selected=!1}
function change_slide(k){if(active_slide!=k){"drag_context"==active_context&&cancel_drag(!0);undo_list=[];redo_list=[];deselect_all();transition(k);k=$("#contexts").find(".active");var a=k.attr("id")+"_context";$(this).attr("data-context")&&(a=k.attr("data-context")+"_context");active_context=a}}
function create_new_slide(k){var a={};a.show_grid=room_data.slides[k].show_grid;a.z_top=room_data.slides[k].z_top;a.uid=newUid();var c=room_data.slides[k].name,f=c.split(" ");isNaN(parseFloat(f[f.length-1]))?c+=" 1":(f[f.length-1]=""+(parseFloat(f[f.length-1])+1),c=f.join(" "));a.name=c;a.entities={};for(var h in room_data.slides[k].entities)f=room_data.slides[k].entities[h].container,delete room_data.slides[k].entities[h].container,a.entities[h]=JSON.parse(JSON.stringify(room_data.slides[k].entities[h])),
room_data.slides[k].entities[h].container=f;f=find_next_slide(room_data.slides[k].order);0==f?h=room_data.slides[k].order+4294967296:(h=room_data.slides[k].order+Math.floor((room_data.slides[f].order-room_data.slides[k].order)/2),c==room_data.slides[f].name&&(a.name=room_data.slides[k].name+" - 1"));a.order=h;return a}
function remove_slide(k){if(1<Object.keys(room_data.slides).length){if(k==active_slide){var a=room_data.slides[k].order,c=find_previous_slide(a);0==c&&(c=find_next_slide(a));change_slide(c);active_slide=c}delete room_data.slides[k]}update_slide_buttons()}function rename_slide(k,a){room_data.slides[k].name=a;update_slide_buttons()}function add_slide(k){resolve_order_conflicts(k);room_data.slides[k.uid]=k;update_slide_buttons()}
function initialize_map_select(k){var a=k.find("option").sort(function(a,f){return a.innerHTML<f.innerHTML?-1:a.innerHTML>f.innerHTML?1:0});k.empty().append(a);k.val("");k.selectpicker&&k.selectpicker("refresh");k.change(function(){var a=k.val().trim();background&&background.path==a||try_select_map(k,a)})}function activity_animation(k){var a=$("#userlist #"+k);a.hasClass("sheen")||(a.addClass("sheen"),setTimeout(function(){a.removeClass("sheen")},1E3))}
function try_select_map(k,a,c){k=background?background.uid:newUid();var f=0,h=0,n=$('option[value="'+a+'"]').attr("data-size");n&&(h=n.split("x"),f=parseFloat(h[0]),h=parseFloat(h[1]));c=c?!0:!1;a.split(".").pop().startsWith();var m={uid:k,type:"background",path:a,size_x:f,size_y:h,custom:c};is_video(a)&&(m.is_video=!0);set_background(m,function(a){a&&(socket.emit("create_entity",room,m,active_slide),background.is_video&&(handle_pause(0),socket.emit("pause_video",room,0)))})}
function add_custom_map(k){var a=$("#map_select"),c=$('#map_select option[value="'+k+'"]');0==c.length&&(c=last(k.split("/")),c=$('<option value="'+k+'">'+c+"</option>"),a.append(c));a.val(k)}function cleanup(){deselect_all();undo_list=[];redo_list=[];if(active_slide)for(var k in room_data.slides[active_slide].entities)room_data.slides[active_slide].entities.hasOwnProperty(k)&&remove(k);room_data={}}
function stop_syncing(){im_syncing=!1;clearInterval(sync_event);sync_event=setInterval(function(){im_syncing=!1;video_paused?clearInterval(sync_event):2E4<Date.now()-get_local_time(last_video_sync[1])&&start_syncing()},1E4+5E3*Math.random())}function handle_play(k,a){video_paused=!1;last_video_sync=[k,a];var c=Date.now()-get_local_time(a);video_media.setCurrentTime(k);0>=c?video_player.play():setTimeout(function(){video_player.play()},c);video_player.play();stop_syncing();play_video_controls()}
function handle_pause(k,a){video_paused=!0;clearInterval(sync_event);im_syncing=!1;video_media.setCurrentTime(k);video_player.pause();pause_video_controls()}function sync_video(k,a){var c=Date.now()-get_local_time(a),c=k+c*base_playback_rate/1E3,c=video_progress()-c;console.log("lag: ",c);.1<Math.abs(c)/base_playback_rate?hard_sync_video(k,a):"youtube"!=video_media.pluginType&&set_playback_rate(base_playback_rate,base_playback_rate+c/VIDEO_SYNC_DELAY)}
function video_progress(){return video_paused?video_media.currentTime:progress+(Date.now()-progress_update)*playback_rate/1E3}
function enable_dragging(){if(!dragging_enabled){var k=$("#disable_dragging > div");k.removeClass("icon-enable_dragging");k.addClass("icon-disable_dragging");$("#disable_dragging").attr("title",$("#disable_dragging").attr("data-disable"));dragging_enabled=!0;for(var a in room_data.slides[active_slide].entities)k=room_data.slides[active_slide].entities[a],k.container&&"background"!=k.type&&(k.container.interactive=!0,k.container.buttonMode=!0,k.container.draggable=!0,k.container.mousedown=on_drag_start,
k.container.touchstart=on_drag_start)}}
function disable_dragging(){if(dragging_enabled){var k=$("#disable_dragging > div");k.removeClass("icon-disable_dragging");k.addClass("icon-enable_dragging");$("#disable_dragging").attr("title",$("#disable_dragging").attr("data-enable"));dragging_enabled=!1;for(var a in room_data.slides[active_slide].entities)k=room_data.slides[active_slide].entities[a],k.container&&"background"!=k.type&&(k.container.interactive=!1,k.container.buttonMode=!1,k.container.draggable=!1,delete k.container.mousedown,delete k.container.touchstart)}}
var sync_in_progress=!1,press_play_delay=0;
function hard_sync_video(k,a){if(!sync_in_progress){sync_in_progress=!0;var c=Date.now()-get_local_time(a),c=k+c*base_playback_rate/1E3,f=video_progress()-c;0>f||3<f?(video_media.setCurrentTime(c+1),sync_in_progress=!1):(video_progress(),video_player.pause(),setTimeout(function(){sync_in_progress=!1;if(!video_paused){video_player.play();var a=Date.now(),c=function(f){press_play_delay=Date.now()-a;video_media.removeEventListener("play",c)};video_media.addEventListener("play",c)}},Math.max(0,1E3*f/
base_playback_rate-press_play_delay)))}}function handle_sync(k,a,c){video_paused?im_syncing=!1:(c!=my_user.id&&stop_syncing(),last_video_sync=[k,a],sync_video(k,a))}
function set_playback_rate(k,a){base_playback_rate=k;playback_rate=a;var c=k.toFixed(2);$(".mejs-speed-button").find("button").html(c+"x");$(".mejs-speed-button").find(".mejs-speed-selected").removeClass("mejs-speed-selected");$(".mejs-speed-button").find('input[value="'+c+'"]').next().addClass("mejs-speed-selected");"youtube"==video_media.pluginType?video_media.pluginApi.setPlaybackRate(a):video_media.playbackRate=a}
function create_hp_bar(k){void 0===k&&(k=1);var a=to_x_local_vect(.125*k);k=to_y_local_vect(.015*k);var c=document.createElement("canvas"),f=c.getContext("2d");c.width=a;c.height=k;f.fillStyle="#FFFFFF";f.fillRect(0,0,c.width,c.height);c=PIXI.Texture.fromCanvas(c);c=new PIXI.Sprite(c);c.tint=65280;var f=document.createElement("canvas"),h=f.getContext("2d");f.width=a;f.height=k;h.strokeStyle="#000000";h.lineWidth=1;h.strokeRect(0,0,f.width,f.height);var f=PIXI.Texture.fromCanvas(f),f=new PIXI.Sprite(f),
h=document.createElement("canvas"),n=h.getContext("2d");h.width=a;h.height=k;n.fillStyle="#FF0000";n.fillRect(0,0,h.width,h.height);a=PIXI.Texture.fromCanvas(h);a=new PIXI.Sprite(a);k=new PIXI.Container;k.addChild(a);k.addChild(c);k.addChild(f);return k}function prev_slide(){if(can_edit()){var k=find_previous_slide(room_data.slides[active_slide].order);0!=k&&(socket.emit("change_slide",room,k),change_slide(k))}}
function next_slide(){if(can_edit()){var k=find_next_slide(room_data.slides[active_slide].order);0!=k&&(socket.emit("change_slide",room,k),change_slide(k))}}var icons={};
function wot_connect(){function k(){for(var a in icons)icons[a]&&icons[a].container&&objectContainer.removeChild(icons[a].container);icons={};render_scene()}function a(a){create_icon(a);a.container.x-=x_abs(.012);a.container.y-=y_abs(.012);var b=create_hp_bar();b.scale.x*=zoom_level;b.scale.y*=zoom_level;b.x-=b.width/2;b.y-=a.container.height+b.height;a.container.addChild(b);var c=create_text_sprite(a.player.substring(0,9),a.label_color,8,"Arial",!1,!0,"bold"),d=c.width/c.height;c.height=x_abs(8/
530);c.width=c.height*d;c.x-=c.width/2;c.y-=a.container.height+b.height+c.height;a.container.addChild(c);a.container.scale.x*=zoom_level;a.container.scale.y*=zoom_level}function c(b){b.onclose=function(a){setTimeout(function(){b=new WebSocket("ws://localhost:6412/");c(b)},1E4)};b.onerror=function(a){b.close()};b.onopen=function(a){k()};b.onmessage=function(b){function c(a){return[(parseFloat(a[0])-h)/g,1-(parseFloat(a[2])-f)/d]}var p=new window.FileReader;p.readAsText(b.data);p.onloadend=function(){if("BATTLE_ENDED"==
p.result)k();else{var b=JSON.parse(p.result);if("tank"in b){var r,q;b.team==e?(r=65280,q="#AAFFAA"):(r=16711680,q="#FFAAAA");r={uid:b.id.toString(),type:"icon",tank:b.type,x:-1,y:-1,size:.02,color:r,alpha:1,label:b.tank.substring(0,10),label_font_size:8,label_color:q,label_font:"Arial",label_font_modifier:"bold",label_pos:"pos_bottom",label_background:!1,label_shadow:!1,maxHealth:b.maxHealth,player:b.name};if(b.position){var u=c(b.position);r.x=u[0];r.y=u[1];a(r)}icons[r.uid]=r}else if("map_dimesions"in
b)h=parseFloat(b.map_dimesions[0][0]),m=parseFloat(b.map_dimesions[1][0]),f=parseFloat(b.map_dimesions[0][1]),n=parseFloat(b.map_dimesions[1][1]),g=m-h,d=n-f;else if("player_team"in b)e=b.player_team;else if("map_id"in b)console.log("map id: ",b.map_id),b=b.map_id,(b=$("#map_select").find("[data-mapid='"+b+"']"))&&try_select_map($("#map_select"),b.val(),!1,function(){render_scene()});else if("remove"in b)r=b.remove.toString(),objectContainer.removeChild(icons[r].container),icons[r]=void 0;else{var t=
new Set;for(q in b)r=q.toString(),icons[r]&&(t.add(r),1<=b[q].length?(u=c(b[q][0]),icons[r].container?(drag_entity(icons[r],u[0],u[1]),icons[r].container.alpha=1):(icons[r].x=u[0],icons[r].y=u[1],a(icons[r])),2==b[q].length&&(u=b[q][1],icons[r].hp!=u&&(icons[r].hp=u,u=icons[r].container.children[1],u.children[1].width=b[q][1]/icons[r].maxHealth*u.children[0].width))):icons[r]&&icons[r].container&&(icons[r].container.alpha=.5),2==b[q].length?icons[r].container&&16776960==icons[r].container.children[1].children[1].tint&&
(icons[r].container.children[1].children[1].tint=65280):icons[r].container&&65280==icons[r].container.children[1].children[1].tint&&(icons[r].container.children[1].children[1].tint=16776960));difference=Object.keys(icons).filter(function(a){return!t.has(a)});for(q in difference)icons[q]&&icons[q].container&&(icons[q].container.alpha=.5);render_scene()}}}}}var f,h,n,m,g,d,e=1;websocket=new WebSocket("ws://localhost:6412/");c(websocket)}
$(document).ready(function(){function k(){video_ready&&progress_timeline();update_pings();scene_dirty&&(select_box_dirty&&redraw_select_box(),renderer.render(objectContainer),scene_dirty=!1);requestAnimationFrame(k)}function a(){setup_assets();var a=document.querySelectorAll("input[type=range][list]");Array.prototype.slice.call(a).forEach(function(a){if("list"in a&&"min"in a&&"max"in a&&"step"in a){var b=document.createElement("datalist"),c=parseFloat(a.getAttribute("min")),d=parseFloat(a.getAttribute("step")),
e=parseFloat(a.getAttribute("max"));b.id=a.getAttribute("list");if(20>Math.abs(e-c)/d){for(;c<e+d;c+=d)b.innerHTML+="<option value="+c.toFixed(2)+"></option>";a.parentNode.insertBefore(b,a.nextSibling)}}});texture_atlas["circle.png"]&&!is_safari()?(a=texture_atlas["circle.png"],ping_texture=new PIXI.Texture(loader.resources[a.sprite].texture,new PIXI.Rectangle(a.x,a.y,a.width,a.height))):ping_texture=PIXI.Texture.fromImage(image_host+"circle.png");$("#slide_table1 tbody").sortable({helper:function(a,
b){b.children().each(function(){$(this).width($(this).width())});return b},update:function(a,b){var c;b.item[0].previousElementSibling?(c=room_data.slides[b.item[0].previousElementSibling.id].order,b.item[0].nextElementSibling?(c+=room_data.slides[b.item[0].nextElementSibling.id].order,c/=2):c+=4294967296):c=room_data.slides[find_first_slide()].order-4294967296;room_data.slides[b.item[0].id].order=c;socket.emit("change_slide_order",room,b.item[0].id,c);update_slide_buttons()}}).disableSelection();
$("#modal_cancel").click(function(a){$("#myModal").modal("hide")});$("#link_send").click(function(a){a=$("#send_link").val();var b=a.indexOf("room=");-1==b?alert("No room id found in link."):(tactic_uid=a.slice(b+5).split("&")[0],a=servers[hashstring(tactic_uid)%servers.length],b=active_slide,$("#this_slide_only").get(0).checked||(b=void 0),$.post("http://"+a+"/add_to_room",{target:tactic_uid,source:room,session_id:$("#sid").attr("data-sid"),host:parse_domain(location.hostname),stored:"false",slide:b}).done(function(a){"Success"!=
a&&alert(a)}));$("#myModal").modal("hide")});$('input[name="map_type_select"]').on("change",function(){"select_hd"==this.id?($("#map_select_container").show(),$("#wotbase_select_container").hide(),$("#new_minimap_select_container").hide(),$("#map_select").val("").selectpicker("render")):"select_wotbase"==this.id?($("#map_select_container").hide(),$("#wotbase_select_container").show(),$("#new_minimap_select_container").hide(),$("#wotbase_select").val("").selectpicker("render")):"select_new_minimap"==
this.id&&($("#map_select_container").hide(),$("#wotbase_select_container").hide(),$("#new_minimap_select_container").show(),$("#new_minimap_select").val("").selectpicker("render"))});$("#send_to_link").click(function(a){socket.emit("save_room",room);$("#myModal").modal("show");$("#myModal").on("shown.bs.modal",function(){$("#send_link").focus()})});$("#custom_map").click(function(a){socket.emit("save_room",room);$("#map_modal").modal("show");$("#map_modal").on("shown.bs.modal",function(){$("#send_link").focus()})});
$("#map_modal_cancel").click(function(a){$("#map_modal").modal("hide")});$("#set_map").click(function(a){(a=$("#map_url").val().trim())&&""!=a&&try_select_map($("#map_select"),a,!0);$("#map_modal").modal("hide")});$("#contexts ~ div").each(function(){$(this).hide()});$("#ping_context").show();$("#store_tactic_popover").hide();$("#save").hide();$("#ping").addClass("active");$("#"+label_position).addClass("active");a=$("#icon_context").find("button:first");a.addClass("selected");selected_icon_no_color=
"true"==a.attr("data-no_color")?!0:!1;selected_icon=a.attr("id");icon_extra_scale=a.attr("data-scale")?parseFloat(a.attr("data-scale")):1;slide_name=$("#slide_interactive").attr("slide_name");$(".nav-pills > li > a").click(function(){$(".nav-pills > li.active").removeClass("active");$(this).parent().addClass("active")});initialize_color_picker("curve_colorpicker","curve_color");initialize_color_picker("icon_colorpicker","icon_color");initialize_color_picker("draw_colorpicker","draw_color");initialize_color_picker("ping_colorpicker",
"ping_color");initialize_color_picker("track_colorpicker","track_color");initialize_color_picker("line_colorpicker","line_color");initialize_color_picker("text_colorpicker","text_color");initialize_color_picker("background_text_colorpicker","background_text_color");initialize_color_picker("rectangle_outline_colorpicker","rectangle_outline_color");initialize_color_picker("rectangle_fill_colorpicker","rectangle_fill_color");initialize_color_picker("circle_outline_colorpicker","circle_outline_color");
initialize_color_picker("circle_fill_colorpicker","circle_fill_color");initialize_color_picker("polygon_outline_colorpicker","polygon_outline_color");initialize_color_picker("polygon_fill_colorpicker","polygon_fill_color");initialize_color_picker("area_outline_colorpicker","area_outline_color");initialize_color_picker("area_fill_colorpicker","area_fill_color");initialize_slider("rectangle_outline_thickness","rectangle_outline_thickness_text","rectangle_outline_thickness");rectangle_outline_thickness=
parseFloat($("#rectangle_outline_thickness").val());initialize_slider("rectangle_outline_transparancy","rectangle_outline_transparancy_text","rectangle_outline_transparancy");initialize_slider("rectangle_fill_transparancy","rectangle_fill_transparancy_text","rectangle_fill_transparancy");initialize_slider("circle_outline_thickness","circle_outline_thickness_text","circle_outline_thickness");initialize_slider("circle_outline_transparancy","circle_outline_transparancy_text","circle_outline_transparancy");
initialize_slider("circle_fill_transparancy","circle_fill_transparancy_text","circle_fill_transparancy");initialize_slider("polygon_outline_thickness","polygon_outline_thickness_text","polygon_outline_thickness");initialize_slider("polygon_outline_transparancy","polygon_outline_transparancy_text","polygon_outline_transparancy");initialize_slider("polygon_fill_transparancy","polygon_fill_transparancy_text","polygon_fill_transparancy");initialize_slider("area_outline_thickness","area_outline_thickness_text",
"area_outline_thickness");initialize_slider("area_outline_transparancy","area_outline_transparancy_text","area_outline_transparancy");initialize_slider("area_fill_transparancy","area_fill_transparancy_text","area_fill_transparancy");initialize_slider("line_thickness","line_thickness_text","line_thickness");initialize_slider("draw_thickness","draw_thickness_text","draw_thickness");initialize_slider("curve_thickness","curve_thickness_text","curve_thickness");initialize_slider("font_size","font_size_text",
"font_size");initialize_slider("background_font_size","background_font_size_text","background_font_size");initialize_slider("label_font_size","label_font_size_text","label_font_size");initialize_slider("icon_size","icon_size_text","icon_size");initialize_slider("ping_size","ping_size_text","ping_size");initialize_slider("track_size","track_size_text","track_size");initialize_slider("draw_end_size","draw_end_size_text","draw_end_size");initialize_slider("line_end_size","line_end_size_text","line_end_size");
initialize_slider("curve_end_size","curve_end_size_text","curve_end_size");$("#delay")&&initialize_slider("delay","delay_text","delay");$("html").click(function(a){"tactic_name"!=a.target.id&&$('[data-toggle="popover"]').popover("hide")});$('[data-toggle="popover"]').popover({container:"body",trigger:"manual",html:"true",template:'<div class="popover popover-medium" style="width: 300px;"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"></div></div></div>',
content:function(){return $("#popover-content")}}).click(function(a){$(this).popover("toggle");document.getElementById("tactic_name").setAttribute("value",tactic_name);$(this);$(document).on("click","#store_tactic",function(a){var b=$(document).find("#tactic_name")[0].value,b=escapeHtml(b);""==b?alert("Empty name, tactic not stored"):(tactic_name=b,document.title="Tactic - "+tactic_name,socket.emit("store",room,tactic_name),$("#save").show(),alert('Tactic stored as: "'+tactic_name+'"'),a.stopPropagation())});
a.stopPropagation()});$("#slide_table").on("click","tr",function(){var a=$(this).attr("id");active_slide!=a&&(socket.emit("change_slide",room,a),change_slide(a))});$("#prev_slide").click(function(){prev_slide()});$("#next_slide").click(function(){next_slide()});$("#new_slide").click(function(){var a=create_new_slide(active_slide);socket.emit("new_slide",room,a);add_slide(a);change_slide(a.uid)});$("#remove_slide").click(function(){1<Object.keys(room_data.slides).length&&(socket.emit("remove_slide",
room,active_slide),remove_slide(active_slide))});$("#save").click(function(){tactic_name&&""!=tactic_name&&(socket.emit("store",room,tactic_name),alert('Tactic stored as: "'+tactic_name+'"'))});$("#slide_name_field").focusout(function(){rename_slide(active_slide,$(this).val());socket.emit("rename_slide",room,active_slide,$(this).val())});$("#slide_name_field").keyup(function(a){13==a.keyCode&&(rename_slide(active_slide,$(this).val()),socket.emit("rename_slide",room,active_slide,$(this).val()))});
$("#link").click(function(){document.queryCommandSupported("copy");var a=document.createElement("textarea"),b="http://"+location.host+location.pathname+"?room="+room;a.value=b;document.body.appendChild(a);window.prompt("Copy to clipboard and share with friends:",b);document.body.removeChild(a)});$("#chat_input").keyup(function(a){13==a.keyCode&&(a=my_user.name+": "+$("#chat_input").val()+"\n",socket.emit("chat",room,a,chat_color),chat(a,chat_color),$("#chat_input").val(""))});$("#export").click(function(){var a=
new PIXI.CanvasRenderer(size_x,size_y,{backgroundColor:12303291});a.render(objectContainer);$.getScript("http://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2014-11-29/FileSaver.min.js",function(){$.getScript("http://cdnjs.cloudflare.com/ajax/libs/javascript-canvas-to-blob/3.3.0/js/canvas-to-blob.min.js",function(){a.view.toBlob(function(a){tactic_name&&""!=tactic_name?saveAs(a,tactic_name+".jpg"):saveAs(a,"map.jpg")})})})});$("#backup").click(function(){$.getScript("https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js",
function(){var a=active_slide,b=new JSZip,c=new PIXI.CanvasRenderer(size_x,size_y,{backgroundColor:12303291}),d=find_first_slide(),e=1,f=function(d){change_slide(d);var h=setInterval(function(){if(0==resources_loading){c.render(objectContainer);var g=c.view.toDataURL("image/jpeg",.9),g=g.replace("data:image/jpeg;base64,","");b.file(e.toString()+"-"+room_data.slides[d].name+".jpg",g,{base64:!0});e++;next_slide_uid=find_next_slide(room_data.slides[d].order);if(0!=next_slide_uid)clearInterval(h),f(next_slide_uid);
else{clearInterval(h);c.destroy();var g={},k;for(k in room_data.slides[active_slide].entities)room_data.slides[active_slide].entities.hasOwnProperty(k)&&room_data.slides[active_slide].entities[k].container&&(g[k]=room_data.slides[active_slide].entities[k].container,delete room_data.slides[active_slide].entities[k].container);b.file("tactic.json",JSON.stringify(room_data,null,2));for(k in room_data.slides[active_slide].entities)room_data.slides[active_slide].entities.hasOwnProperty(k)&&g[k]&&(room_data.slides[active_slide].entities[k].container=
g[k]);$.getScript("http://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2014-11-29/FileSaver.min.js",function(){var a=b.generate({type:"blob"});tactic_name&&""!=tactic_name?saveAs(a,tactic_name+".zip"):saveAs(a,"backup.zip")});change_slide(a);render_scene()}}},50)};f(d)})});$(".icon_group").each(function(){var a=this.id;$("#"+a).click(function(){var b=$("#"+a+"_list").text().split("\n"),b=b.map(function(a){return encodeURIComponent(a.trim())}),b=b.filter(function(a){return""==a?!1:!0}),c=$("#"+a+"_list").attr("data-path"),
d=parseFloat($("#"+a+"_list").attr("data-scale")),e=parseFloat($("#"+a+"_list").attr("data-height")),f=$("#"+a+"_list").attr("data-no_color"),h=$("#"+a+"_list").attr("data-style");if(!$.trim($("#"+a+"_menu").html()))if(h)for(var g in b)$("#"+a+"_menu").append('<button data-toggle="tooltip" title="'+b[g]+'" class="tank_select" data-scale="'+d+'" data-no_color="'+f+'" id="'+c+"/"+b[g]+'"><div class="'+c+" "+c+"-"+b[g].slice(0,-4)+' inline"></div></button>');else for(g in b)$("#"+a+"_menu").append("<img height="+
e+' class="tank_select" data-scale="'+d+'" data-no_color="'+f+'" id="'+c+"/"+b[g]+'" data-toggle="tooltip" title="'+b[g]+'" src='+image_host+c+"/"+b[g]+"></img>")})});$("[id^=icon][id$=context]").each(function(){$(this).find("a:first").trigger("click")});$("#lock").click(function(){is_room_locked=$(this).find("div").hasClass("icon-lock")?!1:!0;update_lock();socket.emit("lock_room",room,is_room_locked)});$("#lock_camera").click(function(){var a=$(this).find("div");a.hasClass("icon-lock_camera")?(a.removeClass("icon-lock_camera").addClass("icon-unlock_camera"),
emit_pan_zoom(),control_camera=!0):(a.removeClass("icon-unlock_camera").addClass("icon-lock_camera"),control_camera=!1)});$("#disable_dragging").click(function(){$("#disable_dragging > div").hasClass("icon-disable_dragging")?(dragging_mode[active_context]="disabled",disable_dragging()):(dragging_mode[active_context]="enabled",enable_dragging())});$("#grid").click(function(){grid_layer.visible=!grid_layer.visible;room_data.slides[active_slide].show_grid=grid_layer.visible;can_edit()&&socket.emit("show_grid",
room,active_slide,grid_layer.visible);render_scene()});$("#zoom_in").click(function(){zoom(.1,!0,[.5,.5]);$("#zoom_level").text((1/zoom_level).toFixed(2));control_camera&&emit_pan_zoom()});$("#zoom_out").click(function(){zoom(1-1/1.1,!1,[.5,.5]);$("#zoom_level").text((1/zoom_level).toFixed(2));control_camera&&emit_pan_zoom()});$("#contexts").on("click","button",function(a){stop_drawing();setup_mouse_events(void 0,void 0);new_drawing=null;graphics&&objectContainer.removeChild(graphics);new_drawing&&
(new_drawing=void 0);current_text_element=void 0;if("undo"==$(this).attr("id"))undo();else if("redo"==$(this).attr("id"))redo();else if("cut"==$(this).attr("id"))cut();else if("copy"==$(this).attr("id"))copy();else if("paste"==$(this).attr("id"))paste();else if("clear_all_main"==$(this).attr("id"))clear();else{shifted&&objectContainer.mouseup&&(shifted=!1,objectContainer.mouseup(renderer.plugins.interaction.eventData),shifted=!0);$("#contexts").find("button").removeClass("active");$(this).addClass("active");
a=$(this).attr("id")+"_context";var b=$(this).attr("id")+"_context";"sc2"!=game&&"R6"!=game||"icon"!=b.substring(0,4)||$("#icon_options").detach().appendTo($("#"+b));$(this).attr("data-context")&&(a=$(this).attr("data-context")+"_context");my_tracker&&stop_tracking();"track_context"==a&&start_tracking({x:2E3,y:2E3});if(active_menu!=b)if("remove_context"!=a&&(deselect_all(),render_scene()),$("#"+active_menu).hide(),$("#"+b).show(),active_menu=b,active_context=a,dragging_mode[active_context])"enabled"==
dragging_mode[active_context]?enable_dragging():disable_dragging();else switch(active_context){case "ping_context":case "track_context":case "icon_context":case "note_context":case "text_context":case "remove_context":case "eraser_context":case "background_text_context":case "select_context":enable_dragging();break;case "draw_context":case "ruler_context":case "rectangle_context":case "circle_context":case "line_context":case "curve_context":case "polygon_context":disable_dragging()}}});$("#label_pos").on("click",
"button",function(a){$("#label_pos").find("button").removeClass("active");$(this).addClass("active");label_position=this.id});$('#rectangle_type button[data-style="full"]').addClass("active");$("#rectangle_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#circle_type button[data-style="full"]').addClass("active");$("#circle_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#circle_draw_style button[data-draw_style="edge"]').addClass("active");
$("#circle_draw_style").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#polygon_type button[data-style="full"]').addClass("active");$("#polygon_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#area_type button[data-style="full"]').addClass("active");$("#area_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#line_type button[data-style="full"]').addClass("active");
$("#line_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#line_end_type button[data-end="arrow"]').addClass("active");$("#line_end_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#curve_type button[data-style="full"]').addClass("active");$("#curve_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#curve_end_type button[data-end="arrow"]').addClass("active");
$("#curve_end_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#track_shape button[data-cursor="cursor"]').addClass("active");$("#track_shape").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active");my_tracker&&stop_tracking();start_tracking({x:2E3,y:2E3})});$('#draw_type button[data-style="full"]').addClass("active");$("#draw_type").on("click","button",function(a){$(this).addClass("active");
$(this).siblings().removeClass("active")});$('#draw_end_type button[data-end="arrow"]').addClass("active");$("#draw_end_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$("#userlist").on("click","button",function(){var a=$(this).attr("id");if(a!=my_user.id&&"owner"==my_user.role)return userlist[a].role?"driver"==userlist[a].role?(userlist[a].role="owner",$(this).css("background-color","lime")):"owner"==userlist[a].role&&(delete userlist[a].role,
$(this).css("background-color","")):(userlist[a].role="driver",$(this).css("background-color","yellow")),socket.emit("update_user",room,userlist[a]),!1});$("#clear_all").click(function(){clear()});$("#clear_draw").click(function(){clear("drawing")});$("#clear_icons").click(function(){clear("icon")});$("#clear_lines").click(function(){clear("line")});$("#clear_text").click(function(){clear("text")});$("#clear_curve").click(function(){clear("curve")});$("#clear_rectangle").click(function(){clear("rectangle")});
$("#clear_circle").click(function(){clear("circle")});$("#clear_polygon").click(function(){clear("polygon")});$("#clear_area").click(function(){clear("area")});$("#clear_selected").click(function(){clear_selected()});$("#clear_note").click(function(){clear("note")});$("#nuke_room").click(function(){1==confirm("Warning: all unsaved data will be lost")&&socket.emit("nuke_room",room,game)});$("body").on("click",".tank_select",function(){$(".tank_select.selected").removeClass("selected");$(this).addClass("selected");
selected_icon=$(this).attr("id");selected_icon_no_color="true"==$(this).attr("data-no_color")?!0:!1;icon_extra_scale=$(this).attr("data-scale")?parseFloat($(this).attr("data-scale")):1});assets_loaded=!0;socket.on("connect",function(){console.log("Connecting/Reconnecting");socket.emit("join_room",room,game)});socket.connected&&socket.emit("join_room",room,game)}supports_color_input()||($("head").append('<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.0/spectrum.min.css">'),
$("head").append('<script defer src="http://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.0/spectrum.min.js">\x3c/script>'));dpi=document.getElementById("dpitest").offsetHeight;initialize_map_select($("#map_select"));initialize_map_select($("#wotbase_select"));initialize_map_select($("#new_minimap_select"));size_y=size_x=size=Math.min(window.innerHeight,window.innerWidth)-30;renderer=PIXI.autoDetectRenderer(size,size,{transparent:!0});renderer.autoResize=!0;useWebGL=renderer instanceof PIXI.WebGLRenderer;
$(renderer.view).attr("style","position:absolute; z-index: 2; padding:0; margin:0; border:0;");$(".edit_window").append(renderer.view);renderer.view.addEventListener("wheel",function(a){var b=mouse_loc(),c=0>a.deltaY;zoom(c?.1:1-1/1.1,c,[from_x_local(b.x),from_y_local(b.y)],a);$("#zoom_level").text((1/zoom_level).toFixed(2));control_camera&&emit_pan_zoom();a.preventDefault()});background_sprite=new PIXI.Sprite;objectContainer=new PIXI.Container;grid_layer="aw"==game?new PIXI.Sprite.fromImage(image_host+
"aw_grid.png"):"squad"==game?new PIXI.Sprite.fromImage(image_host+"squad_grid.png"):new PIXI.Sprite.fromImage(image_host+"grid.png");grid_layer.height=renderer.height;grid_layer.width=renderer.width;objectContainer.addChild(background_sprite);objectContainer.addChild(grid_layer);objectContainer.interactive=!0;objectContainer.mousedown=on_left_click;objectContainer.touchstart=on_left_click;$(renderer.view).mousedown(function(a){if(3===a.which||2===a.which)last_pan_loc=[mouse_loc().x,mouse_loc().y],
setup_mouse_events(on_pan),a.preventDefault()});renderer.view.addEventListener("contextmenu",function(a){setup_mouse_events(void 0);$("#zoom_level").text((1/zoom_level).toFixed(2));control_camera&&emit_pan_zoom();a.preventDefault()});$(renderer.view).mouseup(function(a){if(3===a.which||2===a.which)$("#zoom_level").text((1/zoom_level).toFixed(2)),setup_mouse_events(void 0),control_camera&&emit_pan_zoom(),a.preventDefault()});var c=[],f=0,h=!1,n,m=!1,g,d=function(a){$("#zoom_level").text((1/zoom_level).toFixed(2));
h&&control_camera&&(emit_pan_zoom(),h=!1);for(var b=a.changedTouches,d=0;d<b.length;d++){var e=b[d],e=c.map(function(a){return a.id}).indexOf(e.identifier);c.splice(e,1)}2==c.length?(a.preventDefault(),objectContainer.interactive=!1,f=Math.sqrt(Math.pow(c[0].pos[0]-c[1].pos[0],2)+Math.pow(c[0].pos[1]-c[1].pos[1],2)),n=[c[0].pos[0]+(c[1].pos[0]-c[0].pos[0])/2,c[0].pos[1]+(c[1].pos[1]-c[0].pos[1])/2],m=!1,g=null):objectContainer.interactive=!0},e={};renderer.view.addEventListener("touchstart",function(a){for(var b=
a.changedTouches,d=0;d<b.length;d++){var e=b[d],h=[from_x_local(e.pageX),from_y_local(e.pageY)];c.push({id:e.identifier,pos:h})}2==c.length?(a.preventDefault(),objectContainer.interactive=!1,f=Math.sqrt(Math.pow(c[0].pos[0]-c[1].pos[0],2)+Math.pow(c[0].pos[1]-c[1].pos[1],2)),n=[c[0].pos[0]+(c[1].pos[0]-c[0].pos[0])/2,c[0].pos[1]+(c[1].pos[1]-c[0].pos[1])/2],m=!1,g=null):objectContainer.interactive=!0});renderer.view.addEventListener("touchend",d);renderer.view.addEventListener("touchendoutside",d);
renderer.view.addEventListener("touchcancel",d);renderer.view.addEventListener("touchmove",function(a){limit_rate(15,e,function(){for(var b=a.changedTouches,d=0;d<b.length;d++){var e=b[d],k=[from_x_local(e.pageX),from_y_local(e.pageY)],x;for(x in c)c[x].id==e.identifier&&(c[x].pos=k)}2==c.length?(a.preventDefault(),objectContainer.interactive=!1,b=Math.sqrt(Math.pow(c[1].pos[0]-c[0].pos[0],2)+Math.pow(c[1].pos[1]-c[0].pos[1],2)),d=to_y_local_vect(b)/dpi,e=[c[0].pos[0]+(c[1].pos[0]-c[0].pos[0])/2,
c[0].pos[1]+(c[1].pos[1]-c[0].pos[1])/2],m||1.5<d?(d=.9*(b/f-1),g=d=g?.8*g+.2*d:d,zoom(Math.abs(d),0<d,n),m=h=!0):(h=!0,d=[to_x_local(e[0])-to_x_local(n[0]),to_y_local(e[1])-to_y_local(n[1])],objectContainer.x+=d[0],objectContainer.y+=d[1],correct()),f=b):objectContainer.interactive=!0})});draw_canvas=document.createElement("canvas");$(draw_canvas).attr("style","padding:0px; margin:0px; border:0; position:absolute; z-index:3; pointer-events:none;");draw_canvas.width=renderer.view.width;draw_canvas.height=
renderer.view.height;draw_context=draw_canvas.getContext("2d");$(draw_canvas).css("width",""+renderer.view.width+"px");$(draw_canvas).css("height",""+renderer.view.width+"px");temp_draw_canvas=document.createElement("canvas");$(temp_draw_canvas).attr("style","padding:0px; margin:0px; border:0; position:absolute; z-index:4; pointer-events:none");temp_draw_canvas.width=renderer.view.width;temp_draw_canvas.height=renderer.view.height;temp_draw_context=temp_draw_canvas.getContext("2d");$(temp_draw_canvas).css("width",
""+renderer.view.width+"px");$(temp_draw_canvas).css("height",""+renderer.view.width+"px");$(renderer.view).parent().append(temp_draw_canvas);$(renderer.view).parent().append(draw_canvas);$(temp_draw_canvas).hide();$(draw_canvas).hide();k();if(textures_loaded)a();else loader.on("complete",a);socket.on("room_data",function(a,c,d,e){cleanup();room_data=a;video_paused=a.video_paused;active_slide=room_data.active_slide;is_room_locked=room_data.locked;my_user_id=c;(tactic_name=d)&&""!=tactic_name&&(document.title=
"Tactic - "+tactic_name);for(var b in room_data.userlist)add_user(room_data.userlist[b]);var f=[],h,g;for(g in room_data.slides[active_slide].entities)"background"==room_data.slides[active_slide].entities[g].type?h=room_data.slides[active_slide].entities[g]:f.push(room_data.slides[active_slide].entities[g]);try{f.sort(function(a,b){return a.z_index-b.z_index})}catch(z){}var k=function(){room_data.pan_zoom?pan_zoom(room_data.pan_zoom[0],room_data.pan_zoom[1],room_data.pan_zoom[2]):pan_zoom(1,0,0);
wot_live&&wot_connect()};h?set_background(h,function(){if(background.is_video)rebuild_timeline(),room_data.playback_rate&&set_playback_rate(room_data.playback_rate,room_data.playback_rate);else for(var a in f)create_entity(f[a]);k()}):k();for(g in room_data.trackers)create_tracker(room_data.trackers[g]);delete room_data.trackers;update_slide_buttons();update_my_user();my_tracker&&(stop_tracking(),start_tracking({x:2E3,y:2E3}));is_video_replay&&(sync_start_time=Date.now(),socket.emit("sync_clock"),
clearInterval(clock_sync_event),clock_sync_event=setInterval(function(){sync_start_time=Date.now();socket.emit("sync_clock")},2E4));render_scene()});socket.on("create_entity",function(a,c,d){c!=active_slide?room_data.slides[c].entities[a.uid]=a:create_entity(a);activity_animation(d)});socket.on("drag",function(a,c,d,e,f,g,h){c!=active_slide?room_data.slides[c].entities[a]&&(room_data.slides[c].entities[a].x=d,room_data.slides[c].entities[a].y=e,f&&(room_data.slides[c].entities[a].scale=f),g&&(room_data.slides[c].entities[a].rotation=
g)):room_data.slides[c].entities[a]&&drag_entity(room_data.slides[active_slide].entities[a],d,e,f,g);activity_animation(h)});socket.on("ping_marker",function(a,c,d,e,f){ping(a,c,d,e);activity_animation(f)});socket.on("chat",function(a,c){chat(a,c)});socket.on("identify",function(a){my_user?(my_user.logged_in=a.logged_in,my_user.name=a.name):my_user=a;update_my_user()});socket.on("remove",function(a,c,d){c!=active_slide?delete room_data.slides[c].entities[a]:remove(a);activity_animation(d)});socket.on("add_user",
function(a){add_user(a)});socket.on("remove_user",function(a){remove_user(a)});socket.on("lock_room",function(a,c){is_room_locked=a;update_lock();activity_animation(c)});socket.on("change_slide",function(a){a!=active_slide&&change_slide(a)});socket.on("new_slide",function(a,c){add_slide(a);activity_animation(c)});socket.on("remove_slide",function(a,c){1>=Object.keys(room_data.slides)?socket.emit("join_room",room,game):(remove_slide(a),activity_animation(c))});socket.on("rename_slide",function(a,c,
d){rename_slide(a,c);activity_animation(d)});socket.on("change_slide_order",function(a,c,d){room_data.slides[a].order=c;update_slide_buttons();activity_animation(d)});socket.on("track",function(a,c){trackers[a.uid]&&remove_tracker(uid);create_tracker(a);activity_animation(c)});socket.on("track_move",function(a,c,d){move_tracker(a,c,d)});socket.on("stop_track",function(a){remove_tracker(a)});socket.on("show_grid",function(a,c,d){room_data.slides[a].show_grid=c;a==active_slide&&(grid_layer.visible=
c,render_scene());activity_animation(d)});socket.on("pan_zoom",function(a,c,d,e){activity_animation(a,c,d);pan_zoom(a,c,d)});socket.on("force_reconnect",function(){location.reload()});socket.on("play_video",function(a,c,d,e){activity_animation(e);set_playback_rate(d,d);handle_play(a,c)});socket.on("pause_video",function(a,c){handle_pause(a);activity_animation(c)});socket.on("sync_video",function(a,c,d){handle_sync(a,c,d)});socket.on("request_sync",function(){if(im_syncing)for(var a=0;5>=a;a++)setTimeout(function(){var a=
video_progress();socket.emit("sync_video",room,a,get_server_time())},2E3*a)});socket.on("sync_clock",function(a){var b=Date.now();offset=a+(b-sync_start_time)/2-b});socket.on("seek_video",function(a,c,d){video_media.setCurrentTime(a);video_paused?video_player.pause():(handle_sync(a,c,d),wait_for_seek(function(){rebuild_timeline()}))});socket.on("change_rate",function(a){set_playback_rate(a,a)})});

//# sourceMappingURL=combined.js.map